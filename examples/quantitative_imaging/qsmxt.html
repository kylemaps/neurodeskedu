
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>QSMxT &#8212; Neurodesk</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=9c3e77be" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/review-badge.css?v=66080ea3" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=1ae7504c"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples/quantitative_imaging/qsmxt';</script>
    <script src="../../_static/review-badge.js?v=6df941bc"></script>
    <link rel="canonical" href="https://kylemaps.github.io/neurodeskedu/examples/quantitative_imaging/qsmxt.html" />
    <link rel="icon" href="../../_static/neurodesk_logo.svg"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Spectroscopy" href="../spectroscopy/intro.html" />
    <link rel="prev" title="ASLprep" href="aslprep.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/neurodesk_logo.svg" class="logo__image only-light" alt="Neurodesk - Home"/>
    <script>document.write(`<img src="../../_static/neurodesk_logo.svg" class="logo__image only-dark" alt="Neurodesk - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://neurodesk.org" title="Return to neurodesk.org" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-solid fa-house fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Return to neurodesk.org</span></a>
        </li>
</ul></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../intro.html">Examples</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../template.html">Example Notebook Template</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../diffusion_imaging/intro.html">Diffusion Imaging</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../diffusion_imaging/DIPY_1.html">Basic Tracking with DIPY</a></li>
<li class="toctree-l3"><a class="reference internal" href="../diffusion_imaging/DIPY_2.html">Advanced Tracking with DIPY</a></li>
<li class="toctree-l3"><a class="reference internal" href="../diffusion_imaging/Diffusion_TBSS_Demo.html">TBSS Tutorial</a></li>
<li class="toctree-l3"><a class="reference internal" href="../diffusion_imaging/MRtrix_1.html">MRtrix: Part 1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../diffusion_imaging/MRtrix_2.html">MRtrix: Part 2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../diffusion_imaging/MRtrix_3.html">MRtrix: Part 3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../diffusion_imaging/mrtrix3tissue.html">MRtrix3Tissue</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../electrophysiology/intro.html">Electrophysiology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../electrophysiology/eeg_with_mne.html">EEG Analysis with MNE</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../functional_imaging/intro.html">Functional Imaging</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../functional_imaging/AFNI_preprocessing_only.html">AFNI Preprocessing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../functional_imaging/AFNI_preprocessing_plus_glm.html">AFNI Preprocessing and GLM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../functional_imaging/AFNI_preprocessing_plus_glm_group.html">AFNI Preprocessing &amp; Group Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../functional_imaging/AFNI_processing_task_based.html">Processing task-based FMRI with AFNI and afni_proc.py</a></li>



<li class="toctree-l3"><a class="reference internal" href="../functional_imaging/FSL_preproc_glm.html">FSL Preprocessing and GLM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../functional_imaging/FSLnets_course_practical.html">Resting state with FSLnets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../functional_imaging/NiWrap.html">NiWrap and Connectome Workbench</a></li>
<li class="toctree-l3"><a class="reference internal" href="../functional_imaging/deepretinotopy.html">DeepRetinotopy Toolbox</a></li>
<li class="toctree-l3"><a class="reference internal" href="../functional_imaging/fMRI_tutorial_in_R_magic.html">Resting-State fMRI Analysis in R</a></li>
<li class="toctree-l3"><a class="reference internal" href="../functional_imaging/first_and_second_level_spm.html">Nipype-SPM fMRI Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../functional_imaging/fmriprep.html">fMRIprep</a></li>
<li class="toctree-l3"><a class="reference internal" href="../functional_imaging/fsl_all_levels_flanker_nipype.html">Nipype-FSL fMRI Analysis</a></li>



<li class="toctree-l3"><a class="reference internal" href="../functional_imaging/intro_to_preprocessing.html">Introduction to Preprocessing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../functional_imaging/mri_vol2surf.html">FreeSurfer: mri_vol2surf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../functional_imaging/process_five_echo_dataset.html">tedana: TE Dependent ANAlysis</a></li>
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="intro.html">Quantitative Imaging</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="aslprep.html">ASLprep</a></li>
<li class="toctree-l3 current active"><a class="current reference internal" href="#">QSMxT</a></li>







</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../spectroscopy/intro.html">Spectroscopy</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../spectroscopy/lcmodel.html">MR Spectroscopy with LCModel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spectroscopy/osprey.html">MR Spectroscopy with Osprey</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../structural_imaging/intro.html">Structural Imaging</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../structural_imaging/FSL_course_bet.html">FSL course - BET</a></li>
<li class="toctree-l3"><a class="reference internal" href="../structural_imaging/SYNcro.html">SYNcro</a></li>
<li class="toctree-l3"><a class="reference internal" href="../structural_imaging/brain_extraction_different_tools.html">Brain Extraction Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../structural_imaging/freesurfer-recon-all-clinical.html">FreeSurfer: recon-all-clinical</a></li>

<li class="toctree-l3"><a class="reference internal" href="../structural_imaging/freesurfer.html">FreeSurfer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../structural_imaging/sct_toolbox.html">SCT Toolbox</a></li>

</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../workflows/intro.html">Workflows</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../workflows/AA_Neurodesk_demo_tour.html">Neurodesk Tools Demo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../workflows/MRIQC.html">MRIQC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../workflows/Magic_commands.html">Magic Commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="../workflows/PyBIDS.html">PyBIDS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../workflows/RISE_slideshow.html">RISE Slideshow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../workflows/bids_conversion.html">BIDS conversion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../workflows/ipyniivue_ipywidgets.html">Ipyniivue and Ipywidgets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../workflows/nextflow_neurodesk.html">Nextflow in Neurodesk: Minimal BIDS T1w QC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../workflows/nipype_full.html">Nipype on Neurodesk</a></li>
<li class="toctree-l3"><a class="reference internal" href="../workflows/nipype_short.html">Basic Nipype</a></li>

<li class="toctree-l3"><a class="reference internal" href="../workflows/papermill-slurm-submission-example.html">Papermill Slurm Job Submission</a></li>
<li class="toctree-l3"><a class="reference internal" href="../workflows/pydra_preproc_ants.html">Pydra</a></li>
<li class="toctree-l3"><a class="reference internal" href="../workflows/review_system_test.html">Review System Test Notebook</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../tutorials/intro.html">Tutorials</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../tutorials/electrophysiology/intro.html">Electrophysiology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/electrophysiology/EEG_mne-python.html">Analysing EEG Data with MNE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/electrophysiology/fieldtrip.html">Analysing M/EEG Data with FieldTrip</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../tutorials/functional_imaging/intro.html">Functional Imaging</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/functional_imaging/connectomeWorkbench.html">Connectome Workbench</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/functional_imaging/fmriprep.html">Using fmriprep with neurodesk on an HPC</a></li>


<li class="toctree-l3"><a class="reference internal" href="../../tutorials/functional_imaging/mriqc.html">Using mriqc with neurodesk on HPC</a></li>


<li class="toctree-l3"><a class="reference internal" href="../../tutorials/functional_imaging/physio.html">PhysIO</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/functional_imaging/physio_batch_workflow.html">A batch scripting example for PhysIO toolbox</a></li>




<li class="toctree-l3"><a class="reference internal" href="../../tutorials/functional_imaging/spm.html">Statistical Parametric Mapping (SPM)</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../tutorials/multimodal_imaging/intro.html">Multimodal Imaging</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/multimodal_imaging/MFCSC.html">Using MFCSC</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../tutorials/open_data/intro.html">Open Data</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/open_data/datalad.html">datalad</a></li>


<li class="toctree-l3"><a class="reference internal" href="../../tutorials/open_data/osfclient.html">osfclient</a></li>



</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../tutorials/phase_processing/intro.html">Phase Processing</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/phase_processing/qsm.html">Quantitative Susceptibility Mapping</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/phase_processing/swi.html">SWI</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/phase_processing/unwrapping.html">Unwrapping</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../tutorials/programming/intro.html">Programming</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/programming/conda.html">Conda environments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/programming/matlab.html">Matlab</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../tutorials/reproducibility/intro.html">Reproducibility</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/reproducibility/datalad-run.html">Reproducible script execution with DataLad</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../tutorials/spectroscopy/intro.html">Spectroscopy</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/spectroscopy/lcmodel.html">Spectroscopy with lcmodel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/spectroscopy/mrsiproc.html">Spectroscopy pipeline</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../tutorials/structural_imaging/intro.html">Structural Imaging</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/structural_imaging/freesurfer.html">FreeSurfer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/structural_imaging/structuralconnectivity.html">Structural connectivity dMRI</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../contribute/intro.html">Contribute</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../contribute/examples.html">Contribute Example Notebooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contribute/tutorials.html">Contribute Tutorials</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://play.neurodesk.cloud.edu.au/hub/user-redirect/git-pull?repo=https%3A//github.com/kylemaps/neurodeskedu&urlpath=lab/tree/neurodeskedu/books/examples/quantitative_imaging/qsmxt.ipynb&branch=main" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Run in Australia"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Run in Australia logo" src="../../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">Run in Australia</span>
</a>
</li>
      
      
      
      
      <li><a href="https://play-europe.neurodesk.org/hub/user-redirect/git-pull?repo=https%3A//github.com/kylemaps/neurodeskedu&urlpath=lab/tree/neurodeskedu/books/examples/quantitative_imaging/qsmxt.ipynb&branch=main" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Run in Europe"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Run in Europe logo" src="../../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">Run in Europe</span>
</a>
</li>
      
      
      
      
      <li><a href="https://play-america.neurodesk.org/hub/user-redirect/git-pull?repo=https%3A//github.com/kylemaps/neurodeskedu&urlpath=lab/tree/neurodeskedu/books/examples/quantitative_imaging/qsmxt.ipynb&branch=main" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Run in America"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Run in America logo" src="../../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">Run in America</span>
</a>
</li>
      
      
      
      
      <li><a href="https://play-europe.neurodesk.org/hub/user-redirect/git-pull?repo=https%3A//github.com/kylemaps/neurodeskedu&urlpath=lab/tree/neurodeskedu/books/examples/quantitative_imaging/qsmxt.ipynb&branch=main" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Run in Global Server 1"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Run in Global Server 1 logo" src="../../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">Run in Global Server 1</span>
</a>
</li>
      
      
      
      
      <li><a href="https://edu.neurodesk.org/hub/user-redirect/git-pull?repo=https%3A//github.com/kylemaps/neurodeskedu&urlpath=lab/tree/neurodeskedu/books/examples/quantitative_imaging/qsmxt.ipynb&branch=main" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Run in Global Server 2"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Run in Global Server 2 logo" src="../../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">Run in Global Server 2</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/examples/quantitative_imaging/qsmxt.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>QSMxT</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">QSMxT</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1"></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#citation-and-resources">Citation and Resources:</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tools-included-in-this-workflow">Tools included in this workflow</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset">Dataset</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#qsmxt-interactive-notebook">QSMxT Interactive Notebook</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-qsm">What is QSM?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-qsmxt">What is QSMxT?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-do-i-access-qsmxt">How do I access QSMxT?</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#download-example-dicoms">Download example DICOMs</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#load-qsmxt">Load QSMxT</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-standardisation">Data standardisation</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#convert-dicom-to-bids">Convert DICOM to BIDS</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-input-data">Inspect input data</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interactive-display-using-niivue">Interactive Display using Niivue</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#run-qsmxt">Run QSMxT</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#view-results">View results</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#qsm-results">QSM results</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#segmentations">Segmentations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-csvs">Analysis CSVs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dependencies-in-jupyter-python">Dependencies in Jupyter/Python</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="qsmxt">
<h1>QSMxT<a class="headerlink" href="#qsmxt" title="Link to this heading">#</a></h1>
<section id="id1">
<h2><a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<p><strong>Author:</strong> Ashley Stewart</p>
<p><strong>Date:</strong> 25 Aug 2025</p>
</section>
<section id="citation-and-resources">
<h2>Citation and Resources:<a class="headerlink" href="#citation-and-resources" title="Link to this heading">#</a></h2>
<section id="tools-included-in-this-workflow">
<h3>Tools included in this workflow<a class="headerlink" href="#tools-included-in-this-workflow" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>QSMxT: Stewart AW, Robinson SD, O’Brien K, et al. QSMxT: Robust masking and artifact reduction for quantitative susceptibility mapping. Magnetic Resonance in Medicine. 2022;87(3):1289-1300. <a class="reference external" href="https://doi.org/10.1002/mrm.29048">doi:10.1002/mrm.29048</a></p></li>
<li><p>QSMxT: Stewart AW, Bollman S, et al. QSMxT/QSMxT. GitHub; 2022<a class="reference external" href="https://github.com/QSMxT/QSMxT">. https://github.com/QSMxT/QSM</a></p></li>
</ul>
</section>
<section id="dataset">
<h3>Dataset<a class="headerlink" href="#dataset" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Bollmann, S., &amp; Stewart, A. (2023, August 7). QSM DICOM testdata for QSMxT pipeline. Retrieved from <a class="reference external" href="https://osf.io/ru43c">osf.io/ru43c</a></p></li>
</ul>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="qsmxt-interactive-notebook">
<h1>QSMxT Interactive Notebook<a class="headerlink" href="#qsmxt-interactive-notebook" title="Link to this heading">#</a></h1>
<p>This interactive notebook estimates Quantitative Susceptibility Maps (QSMs) for two gradient-echo (GRE) MRI acquisitions using <a class="reference external" href="https://github.com/QSMxT/QSMxT">QSMxT</a> provided by the <a class="reference external" href="https://neurodesk.org">Neurodesk</a> project.</p>
<section id="what-is-qsm">
<h2>What is QSM?<a class="headerlink" href="#what-is-qsm" title="Link to this heading">#</a></h2>
<p>QSM is a form of quantitative MRI (qMRI) that estimates the magnetic susceptibility distribution across an imaged object. Magnetic susceptibility is the degree to which a material becomes magnetised by an external magnetic field. Major contributors to susceptibility include iron, calcium, and myelin, with the susceptibility of water typically approximating a zero-reference, though it is slightly diamagnetic. Read more about QSM <a class="reference external" href="https://doi.org/10.1002/mrm.25358">here</a>.</p>
</section>
<section id="what-is-qsmxt">
<h2>What is QSMxT?<a class="headerlink" href="#what-is-qsmxt" title="Link to this heading">#</a></h2>
<p><a class="reference external" href="https://qsmxt.github.io">QSMxT</a> is a suite of tools for building and running automated pipelines for QSM that:</p>
<ul class="simple">
<li><p>is available open-source without any licensing required;</p></li>
<li><p>is distributed as a software container making it straightforward to access and install (Neurodesk!)</p></li>
<li><p>scales its processing to execute across many acquisitions through jobs parallelisation (using multiple processors or HPCs) provided by <a class="reference external" href="https://nipype.readthedocs.io">Nipype</a>;</p></li>
<li><p>automates steps that usually require manual intervention and scripting, including:</p>
<ul>
<li><p>DICOM to <a class="reference external" href="https://bids-specification.readthedocs.io/en/stable/index.html">BIDS</a> conversion;</p></li>
<li><p>QSM reconstruction using a range of algorithms;</p></li>
<li><p>segmentation using <a class="reference external" href="https://github.com/Deep-MI/FastSurfer">FastSurfer</a>;</p></li>
<li><p>group space generation using <a class="reference external" href="https://github.com/ANTsX/ANTs">ANTs</a>;</p></li>
<li><p>export of susceptibility statistics by subject and region of interest (ROI) to CSV.</p></li>
</ul>
</li>
</ul>
<p><img alt="image.png" src="../../_images/image.png" /></p>
</section>
<section id="how-do-i-access-qsmxt">
<h2>How do I access QSMxT?<a class="headerlink" href="#how-do-i-access-qsmxt" title="Link to this heading">#</a></h2>
<p>There are a few ways you can access QSMxT:</p>
<ul class="simple">
<li><p><strong>This notebook</strong>: You can access QSMxT in this notebook right now!</p>
<ul>
<li><p>If you are running this on a Neurodesk Play instance, you can upload your own data into the sidebar via drag-and-drop.</p></li>
</ul>
</li>
<li><p><strong>Neurodesktop</strong>: QSMxT is in the applications menu of Neurodesktop.</p>
<ul>
<li><p>On Neurodesk Play, upload your own data into the desktop via drag-and-drop.</p></li>
<li><p>On a local install of Neurodesk, bring any necessary files into the shared <code class="docutils literal notranslate"><span class="pre">~/neurodesktop-storage</span></code> directory</p></li>
</ul>
</li>
<li><p><strong>Local install</strong>: QSMxT can also be installed via the <a class="reference external" href="https://qsmxt.github.io/QSMxT/installation">Docker container</a></p></li>
<li><p><strong>HPC install</strong>: QSMxT can also be installed via the <a class="reference external" href="https://qsmxt.github.io/QSMxT/installation">Singularity container</a> for use on HPCs</p></li>
</ul>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="download-example-dicoms">
<h1>Download example DICOMs<a class="headerlink" href="#download-example-dicoms" title="Link to this heading">#</a></h1>
<p>Here, we download some example DICOMs from our OSF repository for QSMxT.</p>
<p>These data include GRE and T1-weighted acquisitions for one subject (duplicated to act as two subjects).</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>osf<span class="w"> </span>-p<span class="w"> </span>ru43c<span class="w"> </span>clone<span class="w"> </span>.<span class="w"> </span>&gt;<span class="w"> </span>/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
<span class="o">!</span>tar<span class="w"> </span>xf<span class="w"> </span>osfstorage/dicoms-unsorted.tar
<span class="o">!</span>rm<span class="w"> </span>-rf<span class="w"> </span>osfstorage/
<span class="o">!</span>tree<span class="w"> </span>dicoms-unsorted<span class="w"> </span><span class="p">|</span><span class="w"> </span>head
<span class="o">!</span><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;...\nThere are `ls dicoms-unsorted | wc -l` unsorted DICOMs in ./dicoms-unsorted/&quot;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold -Color-Bold-Blue">dicoms-unsorted</span>
├── MR.1.1.dcm
├── MR.1.10.dcm
├── MR.1.100.dcm
├── MR.1.101.dcm
├── MR.1.102.dcm
├── MR.1.103.dcm
├── MR.1.104.dcm
├── MR.1.105.dcm
├── MR.1.106.dcm
...
There are 1216 unsorted DICOMs in ./dicoms-unsorted/
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="load-qsmxt">
<h1>Load QSMxT<a class="headerlink" href="#load-qsmxt" title="Link to this heading">#</a></h1>
<p>To load QSMxT inside a notebook, we can use the available module system:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">module</span>
<span class="k">await</span> <span class="n">module</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;qsmxt/8.1.1&#39;</span><span class="p">)</span>
<span class="o">!</span>qsmxt<span class="w"> </span>--version
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[INFO]: QSMxT v8.1.1
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="data-standardisation">
<h1>Data standardisation<a class="headerlink" href="#data-standardisation" title="Link to this heading">#</a></h1>
<p>QSMxT requires input data to conform to the <a class="reference external" href="https://bids.neuroimaging.io/">Brain Imaging Data Structure (BIDS)</a>.</p>
<p>Luckily, QSMxT also provides scripts that can convert unorganised NIfTI or DICOM images to BIDS. If you are using NIfTI images and do not have DICOMs, see <a class="reference external" href="https://qsmxt.github.io/QSMxT/using-qsmxt/data-preparation#nifti-to-bids">nifti-convert</a>.</p>
<section id="convert-dicom-to-bids">
<h2>Convert DICOM to BIDS<a class="headerlink" href="#convert-dicom-to-bids" title="Link to this heading">#</a></h2>
<p>The DICOM to BIDS conversion must identify which series should be used for QSM reconstruction (e.g. MEGRE), and which series should be used for segmentation (T1-weighted). Because this information is not stored in the DICOM header in a standardised way, it can only be estimated based on other fields, or the user must identify series themselves.</p>
<p>If QSMxT is run interactively, the user will be prompted to identify the relevant series. However, because we are running QSMxT in a notebook, we disable the interactivity using <code class="docutils literal notranslate"><span class="pre">--auto_yes</span></code> and allow QSMxT to guess the intended purpose of each acquisition. In this case, it makes the right guess:</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>dicom-convert<span class="w"> </span>dicoms-unsorted<span class="w"> </span>bids<span class="w"> </span>--auto_yes
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Matplotlib is building the font cache; this may take a moment.
/opt/miniconda-4.12.0/lib/python3.8/site-packages/dicompare/io.py:30: UserWarning: The DICOM readers are highly experimental, unstable, and only work for Siemens time-series at the moment
Please use with caution.  We would be grateful for your help in improving them
  from nibabel.nicom.csareader import get_csa_header
[INFO]: Running QSMxT 8.1.1
[INFO]: Command: /opt/miniconda-4.12.0/bin/dicom-convert dicoms-unsorted bids --auto_yes
[INFO]: Python interpreter: /opt/miniconda-4.12.0/bin/python3.8
Loading DICOM files:   0%|                             | 0/1216 [00:00&lt;?, ?it/s]
Loading DICOM files:   1%|▏                    | 8/1216 [00:00&lt;00:15, 78.51it/s]
Loading DICOM files:   2%|▎                  | 20/1216 [00:00&lt;00:11, 102.24it/s]
Loading DICOM files:   3%|▌                  | 32/1216 [00:00&lt;00:10, 109.44it/s]
Loading DICOM files:   4%|▋                  | 47/1216 [00:00&lt;00:09, 123.32it/s]
Loading DICOM files:   5%|▉                  | 60/1216 [00:00&lt;00:09, 121.38it/s]
Loading DICOM files:   6%|█▏                 | 73/1216 [00:00&lt;00:09, 121.24it/s]
Loading DICOM files:   7%|█▎                 | 86/1216 [00:00&lt;00:09, 118.41it/s]
Loading DICOM files:   8%|█▌                 | 98/1216 [00:00&lt;00:09, 118.58it/s]
Loading DICOM files:   9%|█▋                | 110/1216 [00:00&lt;00:09, 118.83it/s]
Loading DICOM files:  10%|█▊                | 122/1216 [00:01&lt;00:09, 117.42it/s]
Loading DICOM files:  11%|█▉                | 135/1216 [00:01&lt;00:09, 120.04it/s]
Loading DICOM files:  12%|██▏               | 148/1216 [00:01&lt;00:08, 122.20it/s]
Loading DICOM files:  13%|██▍               | 161/1216 [00:01&lt;00:08, 120.73it/s]
Loading DICOM files:  14%|██▌               | 174/1216 [00:01&lt;00:08, 119.49it/s]
Loading DICOM files:  15%|██▊               | 186/1216 [00:01&lt;00:08, 119.60it/s]
Loading DICOM files:  16%|██▉               | 200/1216 [00:01&lt;00:08, 124.85it/s]
Loading DICOM files:  18%|███▏              | 213/1216 [00:01&lt;00:07, 126.33it/s]
Loading DICOM files:  19%|███▎              | 226/1216 [00:01&lt;00:08, 118.88it/s]
Loading DICOM files:  20%|███▌              | 238/1216 [00:02&lt;00:08, 118.78it/s]
Loading DICOM files:  21%|███▋              | 250/1216 [00:02&lt;00:08, 115.63it/s]
Loading DICOM files:  22%|███▉              | 263/1216 [00:02&lt;00:08, 118.78it/s]
Loading DICOM files:  23%|████              | 276/1216 [00:02&lt;00:07, 120.74it/s]
Loading DICOM files:  24%|████▎             | 289/1216 [00:02&lt;00:07, 122.47it/s]
Loading DICOM files:  25%|████▍             | 302/1216 [00:02&lt;00:07, 120.99it/s]
Loading DICOM files:  26%|████▋             | 316/1216 [00:02&lt;00:07, 123.25it/s]
Loading DICOM files:  27%|████▊             | 329/1216 [00:02&lt;00:07, 121.37it/s]
Loading DICOM files:  28%|█████             | 342/1216 [00:02&lt;00:07, 122.80it/s]
Loading DICOM files:  29%|█████▎            | 355/1216 [00:02&lt;00:06, 124.09it/s]
Loading DICOM files:  30%|█████▍            | 368/1216 [00:03&lt;00:07, 121.03it/s]
Loading DICOM files:  31%|█████▋            | 381/1216 [00:03&lt;00:07, 118.89it/s]
Loading DICOM files:  32%|█████▊            | 395/1216 [00:03&lt;00:06, 122.75it/s]
Loading DICOM files:  34%|██████            | 408/1216 [00:03&lt;00:06, 118.43it/s]
Loading DICOM files:  35%|██████▏           | 421/1216 [00:03&lt;00:06, 121.02it/s]
Loading DICOM files:  36%|██████▍           | 434/1216 [00:03&lt;00:06, 117.89it/s]
Loading DICOM files:  37%|██████▌           | 446/1216 [00:03&lt;00:06, 116.04it/s]
Loading DICOM files:  38%|██████▊           | 458/1216 [00:03&lt;00:06, 116.86it/s]
Loading DICOM files:  39%|██████▉           | 471/1216 [00:03&lt;00:06, 118.65it/s]
Loading DICOM files:  40%|███████▏          | 485/1216 [00:04&lt;00:05, 124.72it/s]
Loading DICOM files:  41%|███████▍          | 499/1216 [00:04&lt;00:05, 126.15it/s]
Loading DICOM files:  42%|███████▌          | 512/1216 [00:04&lt;00:05, 125.12it/s]
Loading DICOM files:  43%|███████▊          | 526/1216 [00:04&lt;00:05, 125.82it/s]
Loading DICOM files:  44%|███████▉          | 539/1216 [00:04&lt;00:05, 124.96it/s]
Loading DICOM files:  45%|████████▏         | 553/1216 [00:04&lt;00:05, 126.44it/s]
Loading DICOM files:  47%|████████▍         | 566/1216 [00:04&lt;00:05, 126.84it/s]
Loading DICOM files:  48%|████████▌         | 579/1216 [00:04&lt;00:05, 125.49it/s]
Loading DICOM files:  49%|████████▊         | 592/1216 [00:04&lt;00:05, 124.35it/s]
Loading DICOM files:  50%|████████▉         | 606/1216 [00:04&lt;00:04, 127.45it/s]
Loading DICOM files:  51%|█████████▏        | 619/1216 [00:05&lt;00:04, 121.10it/s]
Loading DICOM files:  52%|█████████▎        | 632/1216 [00:05&lt;00:04, 122.20it/s]
Loading DICOM files:  53%|█████████▌        | 645/1216 [00:05&lt;00:04, 123.17it/s]
Loading DICOM files:  54%|█████████▊        | 660/1216 [00:05&lt;00:04, 128.35it/s]
Loading DICOM files:  55%|█████████▉        | 674/1216 [00:05&lt;00:04, 130.06it/s]
Loading DICOM files:  57%|██████████▏       | 688/1216 [00:05&lt;00:04, 130.03it/s]
Loading DICOM files:  58%|██████████▍       | 703/1216 [00:05&lt;00:03, 134.44it/s]
Loading DICOM files:  59%|██████████▌       | 717/1216 [00:05&lt;00:03, 131.56it/s]
Loading DICOM files:  60%|██████████▊       | 731/1216 [00:05&lt;00:03, 131.06it/s]
Loading DICOM files:  61%|███████████       | 745/1216 [00:06&lt;00:03, 128.35it/s]
Loading DICOM files:  62%|███████████▏      | 759/1216 [00:06&lt;00:03, 129.58it/s]
Loading DICOM files:  63%|███████████▍      | 772/1216 [00:06&lt;00:03, 124.38it/s]
Loading DICOM files:  65%|███████████▌      | 785/1216 [00:06&lt;00:03, 111.61it/s]
Loading DICOM files:  66%|███████████▊      | 798/1216 [00:06&lt;00:03, 115.64it/s]
Loading DICOM files:  67%|████████████      | 811/1216 [00:06&lt;00:03, 119.15it/s]
Loading DICOM files:  68%|████████████▏     | 824/1216 [00:06&lt;00:03, 116.88it/s]
Loading DICOM files:  69%|████████████▍     | 837/1216 [00:06&lt;00:03, 118.56it/s]
Loading DICOM files:  70%|████████████▌     | 849/1216 [00:06&lt;00:03, 118.79it/s]
Loading DICOM files:  71%|████████████▊     | 862/1216 [00:07&lt;00:02, 119.78it/s]
Loading DICOM files:  72%|████████████▉     | 876/1216 [00:07&lt;00:02, 122.12it/s]
Loading DICOM files:  73%|█████████████▏    | 889/1216 [00:07&lt;00:02, 120.57it/s]
Loading DICOM files:  74%|█████████████▎    | 902/1216 [00:07&lt;00:02, 119.49it/s]
Loading DICOM files:  75%|█████████████▌    | 914/1216 [00:07&lt;00:02, 117.02it/s]
Loading DICOM files:  76%|█████████████▋    | 927/1216 [00:07&lt;00:02, 119.73it/s]
Loading DICOM files:  77%|█████████████▉    | 939/1216 [00:07&lt;00:02, 119.79it/s]
Loading DICOM files:  78%|██████████████    | 952/1216 [00:07&lt;00:02, 121.68it/s]
Loading DICOM files:  79%|██████████████▎   | 965/1216 [00:07&lt;00:02, 122.98it/s]
Loading DICOM files:  80%|██████████████▍   | 978/1216 [00:08&lt;00:02, 118.90it/s]
Loading DICOM files:  81%|██████████████▋   | 991/1216 [00:08&lt;00:01, 120.85it/s]
Loading DICOM files:  83%|██████████████   | 1004/1216 [00:08&lt;00:01, 119.63it/s]
Loading DICOM files:  84%|██████████████▏  | 1016/1216 [00:08&lt;00:01, 117.02it/s]
Loading DICOM files:  85%|██████████████▎  | 1028/1216 [00:08&lt;00:01, 115.32it/s]
Loading DICOM files:  86%|██████████████▌  | 1040/1216 [00:08&lt;00:01, 114.26it/s]
Loading DICOM files:  87%|██████████████▋  | 1054/1216 [00:08&lt;00:01, 120.11it/s]
Loading DICOM files:  88%|██████████████▉  | 1068/1216 [00:08&lt;00:01, 122.73it/s]
Loading DICOM files:  89%|███████████████  | 1081/1216 [00:08&lt;00:01, 123.94it/s]
Loading DICOM files:  90%|███████████████▎ | 1095/1216 [00:09&lt;00:00, 128.43it/s]
Loading DICOM files:  91%|███████████████▍ | 1108/1216 [00:09&lt;00:00, 125.48it/s]
Loading DICOM files:  92%|███████████████▋ | 1121/1216 [00:09&lt;00:00, 121.71it/s]
Loading DICOM files:  93%|███████████████▊ | 1134/1216 [00:09&lt;00:00, 118.98it/s]
Loading DICOM files:  94%|████████████████ | 1148/1216 [00:09&lt;00:00, 122.24it/s]
Loading DICOM files:  95%|████████████████▏| 1161/1216 [00:09&lt;00:00, 120.93it/s]
Loading DICOM files:  97%|████████████████▍| 1175/1216 [00:09&lt;00:00, 123.52it/s]
Loading DICOM files:  98%|████████████████▌| 1188/1216 [00:09&lt;00:00, 123.14it/s]
Loading DICOM files:  99%|████████████████▊| 1201/1216 [00:09&lt;00:00, 121.88it/s]
Loading DICOM files: 100%|█████████████████| 1216/1216 [00:09&lt;00:00, 121.62it/s]
[INFO]: Loaded DICOM session in 10.14 seconds
/opt/miniconda-4.12.0/lib/python3.8/site-packages/dicompare/acquisition.py:144: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  session_df[&quot;BaseAcquisition&quot;] = &quot;acq-&quot; + session_df[acquisition_fields].apply(
/opt/miniconda-4.12.0/lib/python3.8/site-packages/dicompare/acquisition.py:195: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  session_df.loc[param_group.index, &quot;AcquisitionSignature&quot;] = signature
/opt/miniconda-4.12.0/lib/python3.8/site-packages/dicompare/acquisition.py:218: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  session_df[&quot;RunNumber&quot;] = 1
/opt/miniconda-4.12.0/lib/python3.8/site-packages/dicompare/acquisition.py:301: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  session_df[&quot;Acquisition&quot;] = session_df[&quot;AcquisitionSignature&quot;].fillna(&quot;Unknown&quot;).astype(str)
[INFO]: Auto-assigning initial labels
[INFO]: Auto-assigned selections:
                    Acquisition  ... Description
0  acq-mp2ragehighres0p5isoslab  ...            
1           acq-qsmp21mmisote20  ...            
2           acq-qsmp21mmisote20  ...            

[3 rows x 7 columns]
[INFO]: Merging selections into dataframe...
[INFO]: Processing base group: (&#39;dev_siemens^SB&#39;, 1, 20170705, &#39;acq-mp2ragehighres0p5isoslab&#39;, &#39;mp2rage_highRes_0p5iso_slab_UNI-DEN&#39;, 1, &#39;1.2.276.0.7230010.3.1.3.0.4480.1677042698.772469&#39;, &#39;NA&#39;)
[INFO]: Found 1 unique Types in this group
[INFO]: Processing Type group: T1w with 288 rows
[INFO]: Found multiple DICOM paths for Type &#39;T1w&#39;, grouping by EchoNumber
[INFO]: Processing Echo group: 1.0 with 288 rows
[INFO]: Converting group with 288 rows
[INFO]: Running command: &#39;&quot;dcm2niix&quot; -o &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/temp_convert&quot; -f &quot;temp_output&quot; -z n -m o &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/temp_convert&quot;&#39;
Chris Rorden&#39;s dcm2niiX version v1.0.20240202  (JP2:OpenJPEG) (JP-LS:CharLS) GCC11.4.0 x86-64 (64-bit Linux)
Found 288 DICOM file(s)
Convert 288 DICOM as /home/jovyan/workspace/books/examples/quantitative_imaging/bids/temp_convert/temp_output (378x420x288x1)
Conversion required 0.346467 seconds (0.346436 for core code).
[INFO]: Processing base group: (&#39;dev_siemens^SB&#39;, 1, 20170705, &#39;acq-qsmp21mmisote20&#39;, &#39;QSM_p2_1mmIso_TE20&#39;, 1, &#39;1.3.12.2.1107.5.2.43.167001.2017070513471948579426649.0.0.0&#39;, &#39;HC1-7&#39;)
[INFO]: Found 1 unique Types in this group
[INFO]: Processing Type group: Mag with 160 rows
[INFO]: Found multiple DICOM paths for Type &#39;Mag&#39;, grouping by EchoNumber
[INFO]: Processing Echo group: 1.0 with 160 rows
[INFO]: Converting group with 160 rows
[INFO]: Running command: &#39;&quot;dcm2niix&quot; -o &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/temp_convert&quot; -f &quot;temp_output&quot; -z n -m o &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/temp_convert&quot;&#39;
Chris Rorden&#39;s dcm2niiX version v1.0.20240202  (JP2:OpenJPEG) (JP-LS:CharLS) GCC11.4.0 x86-64 (64-bit Linux)
Found 160 DICOM file(s)
Convert 160 DICOM as /home/jovyan/workspace/books/examples/quantitative_imaging/bids/temp_convert/temp_output (224x224x160x1)
Conversion required 0.090809 seconds (0.090783 for core code).
[INFO]: Processing base group: (&#39;dev_siemens^SB&#39;, 1, 20170705, &#39;acq-qsmp21mmisote20&#39;, &#39;QSM_p2_1mmIso_TE20&#39;, 1, &#39;1.3.12.2.1107.5.2.43.167001.2017070513471948580526650.0.0.0&#39;, &#39;HC1-7&#39;)
[INFO]: Found 1 unique Types in this group
[INFO]: Processing Type group: Phase with 160 rows
[INFO]: Found multiple DICOM paths for Type &#39;Phase&#39;, grouping by EchoNumber
[INFO]: Processing Echo group: 1.0 with 160 rows
[INFO]: Converting group with 160 rows
[INFO]: Running command: &#39;&quot;dcm2niix&quot; -o &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/temp_convert&quot; -f &quot;temp_output&quot; -z n -m o &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/temp_convert&quot;&#39;
Chris Rorden&#39;s dcm2niiX version v1.0.20240202  (JP2:OpenJPEG) (JP-LS:CharLS) GCC11.4.0 x86-64 (64-bit Linux)
Found 160 DICOM file(s)
Convert 160 DICOM as /home/jovyan/workspace/books/examples/quantitative_imaging/bids/temp_convert/temp_output_ph (224x224x160x1)
Conversion required 0.089886 seconds (0.089876 for core code).
[INFO]: Processing base group: (&#39;dev_siemens^SB&#39;, 2, 20170705, &#39;acq-mp2ragehighres0p5isoslab&#39;, &#39;mp2rage_highRes_0p5iso_slab_UNI-DEN&#39;, 1, 2, &#39;NA&#39;)
[INFO]: Found 1 unique Types in this group
[INFO]: Processing Type group: T1w with 288 rows
[INFO]: Found multiple DICOM paths for Type &#39;T1w&#39;, grouping by EchoNumber
[INFO]: Processing Echo group: 1.0 with 288 rows
[INFO]: Converting group with 288 rows
[INFO]: Running command: &#39;&quot;dcm2niix&quot; -o &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/temp_convert&quot; -f &quot;temp_output&quot; -z n -m o &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/temp_convert&quot;&#39;
Chris Rorden&#39;s dcm2niiX version v1.0.20240202  (JP2:OpenJPEG) (JP-LS:CharLS) GCC11.4.0 x86-64 (64-bit Linux)
Found 288 DICOM file(s)
Convert 288 DICOM as /home/jovyan/workspace/books/examples/quantitative_imaging/bids/temp_convert/temp_output (378x420x288x1)
Conversion required 0.351788 seconds (0.351789 for core code).
[INFO]: Processing base group: (&#39;dev_siemens^SB&#39;, 2, 20170705, &#39;acq-qsmp21mmisote20&#39;, &#39;QSM_p2_1mmIso_TE20&#39;, 1, 1, &#39;HC1-7&#39;)
[INFO]: Found 1 unique Types in this group
[INFO]: Processing Type group: Mag with 160 rows
[INFO]: Found multiple DICOM paths for Type &#39;Mag&#39;, grouping by EchoNumber
[INFO]: Processing Echo group: 1.0 with 160 rows
[INFO]: Converting group with 160 rows
[INFO]: Running command: &#39;&quot;dcm2niix&quot; -o &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/temp_convert&quot; -f &quot;temp_output&quot; -z n -m o &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/temp_convert&quot;&#39;
Chris Rorden&#39;s dcm2niiX version v1.0.20240202  (JP2:OpenJPEG) (JP-LS:CharLS) GCC11.4.0 x86-64 (64-bit Linux)
Found 160 DICOM file(s)
Convert 160 DICOM as /home/jovyan/workspace/books/examples/quantitative_imaging/bids/temp_convert/temp_output (224x224x160x1)
Conversion required 0.090215 seconds (0.090209 for core code).
[INFO]: Processing base group: (&#39;dev_siemens^SB&#39;, 2, 20170705, &#39;acq-qsmp21mmisote20&#39;, &#39;QSM_p2_1mmIso_TE20&#39;, 1, 3, &#39;HC1-7&#39;)
[INFO]: Found 1 unique Types in this group
[INFO]: Processing Type group: Phase with 160 rows
[INFO]: Found multiple DICOM paths for Type &#39;Phase&#39;, grouping by EchoNumber
[INFO]: Processing Echo group: 1.0 with 160 rows
[INFO]: Converting group with 160 rows
[INFO]: Running command: &#39;&quot;dcm2niix&quot; -o &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/temp_convert&quot; -f &quot;temp_output&quot; -z n -m o &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/temp_convert&quot;&#39;
Chris Rorden&#39;s dcm2niiX version v1.0.20240202  (JP2:OpenJPEG) (JP-LS:CharLS) GCC11.4.0 x86-64 (64-bit Linux)
Found 160 DICOM file(s)
Convert 160 DICOM as /home/jovyan/workspace/books/examples/quantitative_imaging/bids/temp_convert/temp_output_ph (224x224x160x1)
Conversion required 0.092992 seconds (0.092966 for core code).
[INFO]: Scanning for multi-coil data to merge...
[INFO]: Scanning for multi-coil runs to combine...
[INFO]: Checking for complex or polar data requiring fixing...
Loading NIfTIs: 100%|███████████████████████████| 6/6 [00:00&lt;00:00, 1717.33it/s]
[INFO]: Finished
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>tree<span class="w"> </span>bids
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold -Color-Bold-Blue">bids</span>
├── log_2026-02-22_02-52-02152570.txt
├── references.txt
├── <span class=" -Color -Color-Bold -Color-Bold-Blue">sub-1</span>
│   └── <span class=" -Color -Color-Bold -Color-Bold-Blue">ses-20170705</span>
│       └── <span class=" -Color -Color-Bold -Color-Bold-Blue">anat</span>
│           ├── sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.json
│           ├── sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii
│           ├── sub-1_ses-20170705_acq-acqqsmp21mmisote20_part-mag_T2starw.json
│           ├── sub-1_ses-20170705_acq-acqqsmp21mmisote20_part-mag_T2starw.nii
│           ├── sub-1_ses-20170705_acq-acqqsmp21mmisote20_part-phase_T2starw.json
│           └── sub-1_ses-20170705_acq-acqqsmp21mmisote20_part-phase_T2starw.nii
└── <span class=" -Color -Color-Bold -Color-Bold-Blue">sub-2</span>
    └── <span class=" -Color -Color-Bold -Color-Bold-Blue">ses-20170705</span>
        └── <span class=" -Color -Color-Bold -Color-Bold-Blue">anat</span>
            ├── sub-2_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.json
            ├── sub-2_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii
            ├── sub-2_ses-20170705_acq-acqqsmp21mmisote20_part-mag_T2starw.json
            ├── sub-2_ses-20170705_acq-acqqsmp21mmisote20_part-mag_T2starw.nii
            ├── sub-2_ses-20170705_acq-acqqsmp21mmisote20_part-phase_T2starw.json
            └── sub-2_ses-20170705_acq-acqqsmp21mmisote20_part-phase_T2starw.nii

7 directories, 14 files
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="inspect-input-data">
<h1>Inspect input data<a class="headerlink" href="#inspect-input-data" title="Link to this heading">#</a></h1>
<p>Here we define a function we will use to visualise NIfTI images so we can view some of the input data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span>
<span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">seaborn</span> <span class="n">numpy</span> <span class="n">nibabel</span> <span class="n">pandas</span> <span class="n">nilearn</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">glob</span><span class="w"> </span><span class="kn">import</span> <span class="n">glob</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">nibabel</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nib</span>

<span class="k">def</span><span class="w"> </span><span class="nf">show_nii</span><span class="p">(</span><span class="n">nii_path</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">imshow_args</span><span class="p">):</span>
    <span class="c1"># load data\n&quot;,</span>
    <span class="n">data_1</span> <span class="o">=</span> <span class="n">nib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">nii_path</span><span class="p">)</span><span class="o">.</span><span class="n">get_fdata</span><span class="p">()</span>

    <span class="c1"># get middle slices\n&quot;,</span>
    <span class="n">slc_data1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rot90</span><span class="p">(</span><span class="n">data_1</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">data_1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">//</span><span class="mi">2</span><span class="p">,:,:])</span>
    <span class="n">slc_data2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rot90</span><span class="p">(</span><span class="n">data_1</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">data_1</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">//</span><span class="mi">2</span><span class="p">,:])</span>
    <span class="n">slc_data3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rot90</span><span class="p">(</span><span class="n">data_1</span><span class="p">[:,:,</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">data_1</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span><span class="o">//</span><span class="mi">2</span><span class="p">])</span>

    <span class="c1"># show slices\n&quot;,</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">title</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">slc_data1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="o">**</span><span class="n">imshow_args</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">slc_data2</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="o">**</span><span class="n">imshow_args</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">slc_data3</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="o">**</span><span class="n">imshow_args</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">1.55</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show_nii</span><span class="p">(</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;bids/sub-*/ses-*/anat/*mag*T2starw*nii*&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Magnitude&quot;</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">show_nii</span><span class="p">(</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;bids/sub-*/ses-*/anat/*phase*T2starw*nii*&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Phase&quot;</span><span class="p">)</span>
<span class="n">show_nii</span><span class="p">(</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;bids/sub-*/ses-*/anat/*T1w*nii*&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;T1-weighted&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/57b7327b541252549a8734670b3341fc0c4dd6f3ecd76bf7559e45e69f855592.png" src="../../_images/57b7327b541252549a8734670b3341fc0c4dd6f3ecd76bf7559e45e69f855592.png" />
<img alt="../../_images/4684c91595863e79b272c2bdd3528a4aa6e41562bccb649b7dd0fd11692d3464.png" src="../../_images/4684c91595863e79b272c2bdd3528a4aa6e41562bccb649b7dd0fd11692d3464.png" />
<img alt="../../_images/69a2442219def719607cf94c33034d028a93f47718eab3ca9bd4a316e0ff3b12.png" src="../../_images/69a2442219def719607cf94c33034d028a93f47718eab3ca9bd4a316e0ff3b12.png" />
</div>
</div>
<section id="interactive-display-using-niivue">
<h2>Interactive Display using Niivue<a class="headerlink" href="#interactive-display-using-niivue" title="Link to this heading">#</a></h2>
<p>Uncomment the next cell if you want to inspect the T1-weighted image interactively.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#from ipyniivue import NiiVue</span>

<span class="c1">#nv_T1 = NiiVue()</span>
<span class="c1">#nv_T1.load_volumes([{&quot;path&quot;: glob(&quot;bids/sub-*/ses-*/anat/*T1w*nii*&quot;)[0]}])</span>
<span class="c1">#nv_T1</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="run-qsmxt">
<h1>Run QSMxT<a class="headerlink" href="#run-qsmxt" title="Link to this heading">#</a></h1>
<p>We are now ready to run QSMxT! We will generate susceptibility maps and segmentations, and export analysis CSVs to file.</p>
<p>The usual way of running QSMxT is to use <code class="docutils literal notranslate"><span class="pre">qsmxt</span> <span class="pre">bids_dir</span></code>. This will launch an interactive command-line interface (CLI) to setup your desired pipelines. However, since we are running this in a notebook, we need to use command-line arguments to by-pass the interface and execute a pipeline.</p>
<p>But first, let’s consider our pipeline settings. For QSM reconstruction, QSMxT provides a range of sensible defaults fit for different purposes. We can list the premade QSM pipelines using <code class="docutils literal notranslate"><span class="pre">--list_premades</span></code>. For the full pipeline details used for each premade pipeline, see <a class="reference external" href="https://github.com/QSMxT/QSMxT/blob/main/qsmxt/qsm_pipelines.json">qsm_pipelines.json</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>qsmxt<span class="w"> </span>--list_premades
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== Premade pipelines ===
default: Default QSMxT settings (GRE; assumes human brain)
gre: Applies suggested settings for 3D-GRE images
epi: Applies suggested settings for 3D-EPI images (assumes human brain)
bet: Applies a traditional BET-masking approach (artefact reduction unavailable; assumes human brain)
fast: Applies a set of fast algorithms
body: Applies suggested settings for non-brain applications
nextqsm: Applies suggested settings for running the NeXtQSM algorithm (assumes human brain)
[INFO]: Finished
</pre></div>
</div>
</div>
</div>
<p>For this demonstration, we will go with the <code class="docutils literal notranslate"><span class="pre">fast</span></code> pipeline. To export segmentations and analysis results, we will use <code class="docutils literal notranslate"><span class="pre">--do_segmentation</span></code> and <code class="docutils literal notranslate"><span class="pre">--do_analysis</span></code>. The <code class="docutils literal notranslate"><span class="pre">--auto_yes</span></code> option avoid the interactive CLI interface that cannot be used in a notebook:</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>qsmxt<span class="w"> </span>bids<span class="w"> </span><span class="err">\</span>
    <span class="o">--</span><span class="n">premade</span> <span class="n">fast</span> \
    <span class="o">--</span><span class="n">do_qsm</span> \
    <span class="o">--</span><span class="n">do_segmentation</span> \
    <span class="o">--</span><span class="n">do_analysis</span> \
    <span class="o">--</span><span class="n">auto_yes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[INFO]: QSMxT v8.1.1
[INFO]: Python interpreter: /opt/miniconda-4.12.0/bin/python3.8
[INFO]: Command: qsmxt /home/jovyan/workspace/books/examples/quantitative_imaging/bids --premade &#39;fast&#39; --do_qsm --do_segmentation --do_analysis --auto_yes
[WARNING]: Pipeline is NOT guidelines compliant (see https://doi.org/10.1002/mrm.30006):; Phase-quality-based masking recommended
[INFO]: Available memory: 12.087 GB
[INFO]: Creating QSMxT workflow for sub-1.ses-20170705.acq-acqmp2ragehighres0p5isoslab.T1w...
[INFO]: Creating QSMxT workflow for sub-1.ses-20170705.acq-acqqsmp21mmisote20.T2starw...
[INFO]: Creating QSMxT workflow for sub-2.ses-20170705.acq-acqmp2ragehighres0p5isoslab.T1w...
[INFO]: Creating QSMxT workflow for sub-2.ses-20170705.acq-acqqsmp21mmisote20.T2starw...
[INFO]: Running using MultiProc plugin with n_procs=4
260222-02:53:04,186 nipype.workflow INFO:
	 Workflow qsmxt-workflow settings: [&#39;check&#39;, &#39;execution&#39;, &#39;logging&#39;, &#39;monitoring&#39;]
260222-02:53:04,377 nipype.workflow INFO:
	 Running in parallel.
260222-02:53:04,380 nipype.workflow INFO:
	 [MultiProc] Running 0 tasks, and 24 jobs ready. Free memory (GB): 14.06/14.06, Free processors: 4/4.
260222-02:53:04,536 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.func_read-json-se&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-1/ses-20170705/qsm_acq-acqmp2ragehighres0p5isoslab_T1w/func_read-json-se&quot;.
260222-02:53:04,536 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.nibabel_read-nii&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-1/ses-20170705/qsm_acq-acqmp2ragehighres0p5isoslab_T1w/nibabel_read-nii&quot;.
260222-02:53:04,539 nipype.workflow INFO:
	 [Node] Executing &quot;nibabel_read-nii&quot; &lt;nipype.interfaces.utility.wrappers.Function&gt;
260222-02:53:04,542 nipype.workflow INFO:
	 [Node] Finished &quot;nibabel_read-nii&quot;, elapsed time 0.002043s.
260222-02:53:04,536 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.func_read-json-me&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-1/ses-20170705/qsm_acq-acqmp2ragehighres0p5isoslab_T1w/func_read-json-me&quot;.
260222-02:53:04,537 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.nibabel_as-canonical&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-1/ses-20170705/qsm_acq-acqmp2ragehighres0p5isoslab_T1w/nibabel_as-canonical&quot;.
260222-02:53:04,589 nipype.workflow INFO:
	 [Node] Executing &quot;func_read-json-me&quot; &lt;nipype.interfaces.utility.wrappers.Function&gt;
260222-02:53:04,589 nipype.workflow INFO:
	 [Node] Executing &quot;nibabel_as-canonical&quot; &lt;nipype.interfaces.utility.wrappers.Function&gt;
260222-02:53:04,591 nipype.workflow INFO:
	 [Node] Finished &quot;func_read-json-me&quot;, elapsed time 0.000587s.
260222-02:53:04,539 nipype.workflow INFO:
	 [Node] Executing &quot;func_read-json-se&quot; &lt;nipype.interfaces.utility.wrappers.Function&gt;
260222-02:53:04,641 nipype.workflow INFO:
	 [Node] Finished &quot;func_read-json-se&quot;, elapsed time 0.000618s.
260222-02:53:04,835 nipype.workflow INFO:
	 [Node] Finished &quot;nibabel_as-canonical&quot;, elapsed time 0.244819s.
260222-02:53:06,382 nipype.workflow INFO:
	 [Job 0] Completed (qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.func_read-json-me).
260222-02:53:06,383 nipype.workflow INFO:
	 [Job 1] Completed (qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.func_read-json-se).
260222-02:53:06,384 nipype.workflow INFO:
	 [Job 2] Completed (qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.nibabel_read-nii).
260222-02:53:06,385 nipype.workflow INFO:
	 [Job 3] Completed (qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.nibabel_as-canonical).
260222-02:53:06,386 nipype.workflow INFO:
	 [MultiProc] Running 0 tasks, and 21 jobs ready. Free memory (GB): 14.06/14.06, Free processors: 4/4.
260222-02:53:06,445 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.fastsurfer_segment-t1&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-1/ses-20170705/qsm_acq-acqmp2ragehighres0p5isoslab_T1w/fastsurfer_segment-t1&quot;.
260222-02:53:06,447 nipype.workflow INFO:
	 [Node] Executing &quot;fastsurfer_segment-t1&quot; &lt;qsmxt.interfaces.nipype_interface_fastsurfer.FastSurferInterface&gt;
260222-02:53:08,383 nipype.workflow INFO:
	 [MultiProc] Running 1 tasks, and 20 jobs ready. Free memory (GB): 2.06/14.06, Free processors: 0/4.
                     Currently running:
                       * qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.fastsurfer_segment-t1
260222-03:01:27,735 nipype.workflow INFO:
	 [Node] Finished &quot;fastsurfer_segment-t1&quot;, elapsed time 501.287522s.
260222-03:01:28,855 nipype.workflow INFO:
	 [Job 4] Completed (qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.fastsurfer_segment-t1).
260222-03:01:28,857 nipype.workflow INFO:
	 [MultiProc] Running 0 tasks, and 21 jobs ready. Free memory (GB): 14.06/14.06, Free processors: 4/4.
260222-03:01:28,899 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.ants_register-t1-to-qsm&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-1/ses-20170705/qsm_acq-acqmp2ragehighres0p5isoslab_T1w/ants_register-t1-to-qsm&quot;.
260222-03:01:28,901 nipype.workflow INFO:
	 [Node] Executing &quot;ants_register-t1-to-qsm&quot; &lt;nipype.interfaces.ants.registration.RegistrationSynQuick&gt;
260222-03:01:30,858 nipype.workflow INFO:
	 [MultiProc] Running 1 tasks, and 20 jobs ready. Free memory (GB): 6.06/14.06, Free processors: 0/4.
                     Currently running:
                       * qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.ants_register-t1-to-qsm
260222-03:03:32,963 nipype.workflow INFO:
	 [Node] Finished &quot;ants_register-t1-to-qsm&quot;, elapsed time 123.665998s.
260222-03:03:32,965 nipype.workflow WARNING:
	 Storing result file without outputs
260222-03:03:32,969 nipype.workflow WARNING:
	 [Node] Error on &quot;qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.ants_register-t1-to-qsm&quot; (/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-1/ses-20170705/qsm_acq-acqmp2ragehighres0p5isoslab_T1w/ants_register-t1-to-qsm)
260222-03:03:35,67 nipype.workflow ERROR:
	 Node ants_register-t1-to-qsm failed to run on host f150b6b6a634.
260222-03:03:35,68 nipype.workflow ERROR:
	 Saving crash info to /home/jovyan/workspace/books/examples/quantitative_imaging/crash-20260222-030335-jovyan-ants_register-t1-to-qsm-4727b226-f59d-4e47-b51a-90e5df393386.pklz
Traceback (most recent call last):
  File &quot;/opt/miniconda-4.12.0/lib/python3.8/site-packages/nipype/pipeline/plugins/multiproc.py&quot;, line 67, in run_node
    result[&quot;result&quot;] = node.run(updatehash=updatehash)
  File &quot;/opt/miniconda-4.12.0/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 527, in run
    result = self._run_interface(execute=True)
  File &quot;/opt/miniconda-4.12.0/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 645, in _run_interface
    return self._run_command(execute)
  File &quot;/opt/miniconda-4.12.0/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 771, in _run_command
    raise NodeExecutionError(msg)
nipype.pipeline.engine.nodes.NodeExecutionError: Exception raised while executing Node ants_register-t1-to-qsm.

Cmdline:
	antsRegistrationSyNQuick.sh -d 3 -f /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii -r 32 -m /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii -n 4 -o sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_T1w_ -p d -s 26 -t s
Stdout:

	--------------------------------------------------------------------------------------
	 Mapping parameters
	--------------------------------------------------------------------------------------
	 ANTSPATH is /opt/ants-2.4.3/bin

	 Dimensionality:           3
	 Output name prefix:       sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_T1w_
	 Fixed images:             /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii
	 Moving images:            /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii
	 Mask images:              
	 Initial transforms:       
	 Number of threads:        4
	 Spline distance:          26
	 SyN gradient step:        0.1
	 Transform type:           s
	 MI histogram bins:        32
	 Precision:                d
	 Use histogram matching:   0
	 Repro                     0
	======================================================================================
	 antsRegistration call:
	--------------------------------------------------------------------------------------
	/opt/ants-2.4.3/bin/antsRegistration --verbose 1 --dimensionality 3 --float 0 --collapse-output-transforms 1 --output [ sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_T1w_,sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_T1w_Warped.nii.gz,sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_T1w_InverseWarped.nii.gz ] --interpolation Linear --use-histogram-matching 0 --winsorize-image-intensities [ 0.005,0.995 ] --initial-moving-transform [ /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,/home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,1 ] --transform Rigid[ 0.1 ] --metric MI[ /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,/home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,1,32,Regular,0.25 ] --convergence [ 1000x500x250x0,1e-6,10 ] --shrink-factors 12x8x4x2 --smoothing-sigmas 4x3x2x1vox --transform Affine[ 0.1 ] --metric MI[ /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,/home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,1,32,Regular,0.25 ] --convergence [ 1000x500x250x0,1e-6,10 ] --shrink-factors 12x8x4x2 --smoothing-sigmas 4x3x2x1vox --transform SyN[ 0.1,3,0 ] --metric MI[ /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,/home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,1,32] --convergence [ 100x100x70x50x0,1e-6,10 ] --shrink-factors 10x6x4x2x1 --smoothing-sigmas 5x3x2x1x0vox
	--------------------------------------------------------------------------------------
	All_Command_lines_OK
	Using double precision for computations.
	=============================================================================
	The composite transform comprises the following transforms (in order): 
	  1. Center of mass alignment using fixed image: /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii and moving image: /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii (type = Euler3DTransform)
	=============================================================================
	  number of levels = 4
	  number of levels = 4
	  number of levels = 5
	  fixed image: /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii
	  moving image: /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii
	  fixed image: /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii
	  moving image: /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii
	  fixed image: /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii
	  moving image: /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii
	Dimension = 3
	Number of stages = 3
	Use histogram matching = false
	Winsorize image intensities = true
	  Lower quantile = 0.005
	  Upper quantile = 0.995


	Stage 1 State
	   Image metric = Mattes
	     Fixed image = Image (0x55c13411d8f0)
	  RTTI typeinfo:   itk::Image&lt;double, 3u&gt;
	  Reference Count: 2
	  Modified Time: 1725
	  Debug: Off
	  Object Name: 
	  Observers: 
	    none
	  Source: (none)
	  Source output name: (none)
	  Release Data: Off
	  Data Released: False
	  Global Release Data: Off
	  PipelineMTime: 0
	  UpdateMTime: 1508
	  RealTimeStamp: 0 seconds 
	  LargestPossibleRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  BufferedRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  RequestedRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  Spacing: [0.5, 0.533333, 0.533333]
	  Origin: [75.0348, 90.125, -137.286]
	  Direction: 
	-0.999859 -0.01105 -0.0126378
	0.0126514 -0.990819 -0.134605
	-0.0110344 -0.134746 0.990819

	  IndexToPointMatrix: 
	-0.49993 -0.00589333 -0.00674016
	0.00632572 -0.528437 -0.0717891
	-0.00551719 -0.0718643 0.528437

	  PointToIndexMatrix: 
	-1.99972 0.0253029 -0.0220688
	-0.0207187 -1.85778 -0.252648
	-0.0236959 -0.252384 1.85779

	  Inverse Direction: 
	-0.999859 0.0126514 -0.0110344
	-0.01105 -0.990819 -0.134746
	-0.0126378 -0.134605 0.990819

	  PixelContainer: 
	    ImportImageContainer (0x55c134123280)
	      RTTI typeinfo:   itk::ImportImageContainer&lt;unsigned long, double&gt;
	      Reference Count: 1
	      Modified Time: 1505
	      Debug: Off
	      Object Name: 
	      Observers: 
	        none
	      Pointer: 0x7fb856f6b010
	      Container manages memory: true
	      Size: 45722880
	      Capacity: 45722880

	     Moving image = Image (0x55c134121390)
	  RTTI typeinfo:   itk::Image&lt;double, 3u&gt;
	  Reference Count: 2
	  Modified Time: 1726
	  Debug: Off
	  Object Name: 
	  Observers: 
	    none
	  Source: (none)
	  Source output name: (none)
	  Release Data: Off
	  Data Released: False
	  Global Release Data: Off
	  PipelineMTime: 0
	  UpdateMTime: 1723
	  RealTimeStamp: 0 seconds 
	  LargestPossibleRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  BufferedRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  RequestedRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  Spacing: [0.5, 0.533333, 0.533333]
	  Origin: [75.0348, 90.125, -137.286]
	  Direction: 
	-0.999859 -0.01105 -0.0126378
	0.0126514 -0.990819 -0.134605
	-0.0110344 -0.134746 0.990819

	  IndexToPointMatrix: 
	-0.49993 -0.00589333 -0.00674016
	0.00632572 -0.528437 -0.0717891
	-0.00551719 -0.0718643 0.528437

	  PointToIndexMatrix: 
	-1.99972 0.0253029 -0.0220688
	-0.0207187 -1.85778 -0.252648
	-0.0236959 -0.252384 1.85779

	  Inverse Direction: 
	-0.999859 0.0126514 -0.0110344
	-0.01105 -0.990819 -0.134746
	-0.0126378 -0.134605 0.990819

	  PixelContainer: 
	    ImportImageContainer (0x55c134127790)
	      RTTI typeinfo:   itk::ImportImageContainer&lt;unsigned long, double&gt;
	      Reference Count: 1
	      Modified Time: 1720
	      Debug: Off
	      Object Name: 
	      Observers: 
	        none
	      Pointer: 0x7fb841294010
	      Container manages memory: true
	      Size: 45722880
	      Capacity: 45722880

	     Weighting = 1
	     Sampling strategy = regular
	     Number of bins = 32
	     Radius = 4
	     Sampling percentage  = 0.25
	   Transform = Rigid
	     Gradient step = 0.1
	     Update field sigma (voxel space) = 0
	     Total field sigma (voxel space) = 0
	     Update field time sigma = 0
	     Total field time sigma  = 0
	     Number of time indices = 0
	     Number of time point samples = 0
	Stage 2 State
	   Image metric = Mattes
	     Fixed image = Image (0x55c134136090)
	  RTTI typeinfo:   itk::Image&lt;double, 3u&gt;
	  Reference Count: 2
	  Modified Time: 2157
	  Debug: Off
	  Object Name: 
	  Observers: 
	    none
	  Source: (none)
	  Source output name: (none)
	  Release Data: Off
	  Data Released: False
	  Global Release Data: Off
	  PipelineMTime: 0
	  UpdateMTime: 1940
	  RealTimeStamp: 0 seconds 
	  LargestPossibleRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  BufferedRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  RequestedRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  Spacing: [0.5, 0.533333, 0.533333]
	  Origin: [75.0348, 90.125, -137.286]
	  Direction: 
	-0.999859 -0.01105 -0.0126378
	0.0126514 -0.990819 -0.134605
	-0.0110344 -0.134746 0.990819

	  IndexToPointMatrix: 
	-0.49993 -0.00589333 -0.00674016
	0.00632572 -0.528437 -0.0717891
	-0.00551719 -0.0718643 0.528437

	  PointToIndexMatrix: 
	-1.99972 0.0253029 -0.0220688
	-0.0207187 -1.85778 -0.252648
	-0.0236959 -0.252384 1.85779

	  Inverse Direction: 
	-0.999859 0.0126514 -0.0110344
	-0.01105 -0.990819 -0.134746
	-0.0126378 -0.134605 0.990819

	  PixelContainer: 
	    ImportImageContainer (0x55c134138e90)
	      RTTI typeinfo:   itk::ImportImageContainer&lt;unsigned long, double&gt;
	      Reference Count: 1
	      Modified Time: 1937
	      Debug: Off
	      Object Name: 
	      Observers: 
	        none
	      Pointer: 0x7fb82b5bd010
	      Container manages memory: true
	      Size: 45722880
	      Capacity: 45722880

	     Moving image = Image (0x55c1341354d0)
	  RTTI typeinfo:   itk::Image&lt;double, 3u&gt;
	  Reference Count: 2
	  Modified Time: 2158
	  Debug: Off
	  Object Name: 
	  Observers: 
	    none
	  Source: (none)
	  Source output name: (none)
	  Release Data: Off
	  Data Released: False
	  Global Release Data: Off
	  PipelineMTime: 0
	  UpdateMTime: 2155
	  RealTimeStamp: 0 seconds 
	  LargestPossibleRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  BufferedRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  RequestedRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  Spacing: [0.5, 0.533333, 0.533333]
	  Origin: [75.0348, 90.125, -137.286]
	  Direction: 
	-0.999859 -0.01105 -0.0126378
	0.0126514 -0.990819 -0.134605
	-0.0110344 -0.134746 0.990819

	  IndexToPointMatrix: 
	-0.49993 -0.00589333 -0.00674016
	0.00632572 -0.528437 -0.0717891
	-0.00551719 -0.0718643 0.528437

	  PointToIndexMatrix: 
	-1.99972 0.0253029 -0.0220688
	-0.0207187 -1.85778 -0.252648
	-0.0236959 -0.252384 1.85779

	  Inverse Direction: 
	-0.999859 0.0126514 -0.0110344
	-0.01105 -0.990819 -0.134746
	-0.0126378 -0.134605 0.990819

	  PixelContainer: 
	    ImportImageContainer (0x55c134138440)
	      RTTI typeinfo:   itk::ImportImageContainer&lt;unsigned long, double&gt;
	      Reference Count: 1
	      Modified Time: 2152
	      Debug: Off
	      Object Name: 
	      Observers: 
	        none
	      Pointer: 0x7fb8158e6010
	      Container manages memory: true
	      Size: 45722880
	      Capacity: 45722880

	     Weighting = 1
	     Sampling strategy = regular
	     Number of bins = 32
	     Radius = 4
	     Sampling percentage  = 0.25
	   Transform = Affine
	     Gradient step = 0.1
	     Update field sigma (voxel space) = 0
	     Total field sigma (voxel space) = 0
	     Update field time sigma = 0
	     Total field time sigma  = 0
	     Number of time indices = 0
	     Number of time point samples = 0
	Stage 3 State
	   Image metric = Mattes
	     Fixed image = Image (0x55c13413df20)
	  RTTI typeinfo:   itk::Image&lt;double, 3u&gt;
	  Reference Count: 2
	  Modified Time: 2589
	  Debug: Off
	  Object Name: 
	  Observers: 
	    none
	  Source: (none)
	  Source output name: (none)
	  Release Data: Off
	  Data Released: False
	  Global Release Data: Off
	  PipelineMTime: 0
	  UpdateMTime: 2372
	  RealTimeStamp: 0 seconds 
	  LargestPossibleRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  BufferedRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  RequestedRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  Spacing: [0.5, 0.533333, 0.533333]
	  Origin: [75.0348, 90.125, -137.286]
	  Direction: 
	-0.999859 -0.01105 -0.0126378
	0.0126514 -0.990819 -0.134605
	-0.0110344 -0.134746 0.990819

	  IndexToPointMatrix: 
	-0.49993 -0.00589333 -0.00674016
	0.00632572 -0.528437 -0.0717891
	-0.00551719 -0.0718643 0.528437

	  PointToIndexMatrix: 
	-1.99972 0.0253029 -0.0220688
	-0.0207187 -1.85778 -0.252648
	-0.0236959 -0.252384 1.85779

	  Inverse Direction: 
	-0.999859 0.0126514 -0.0110344
	-0.01105 -0.990819 -0.134746
	-0.0126378 -0.134605 0.990819

	  PixelContainer: 
	    ImportImageContainer (0x55c13413de70)
	      RTTI typeinfo:   itk::ImportImageContainer&lt;unsigned long, double&gt;
	      Reference Count: 1
	      Modified Time: 2369
	      Debug: Off
	      Object Name: 
	      Observers: 
	        none
	      Pointer: 0x7fb7ffc0f010
	      Container manages memory: true
	      Size: 45722880
	      Capacity: 45722880

	     Moving image = Image (0x55c13413ce20)
	  RTTI typeinfo:   itk::Image&lt;double, 3u&gt;
	  Reference Count: 2
	  Modified Time: 2590
	  Debug: Off
	  Object Name: 
	  Observers: 
	    none
	  Source: (none)
	  Source output name: (none)
	  Release Data: Off
	  Data Released: False
	  Global Release Data: Off
	  PipelineMTime: 0
	  UpdateMTime: 2587
	  RealTimeStamp: 0 seconds 
	  LargestPossibleRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  BufferedRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  RequestedRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  Spacing: [0.5, 0.533333, 0.533333]
	  Origin: [75.0348, 90.125, -137.286]
	  Direction: 
	-0.999859 -0.01105 -0.0126378
	0.0126514 -0.990819 -0.134605
	-0.0110344 -0.134746 0.990819

	  IndexToPointMatrix: 
	-0.49993 -0.00589333 -0.00674016
	0.00632572 -0.528437 -0.0717891
	-0.00551719 -0.0718643 0.528437

	  PointToIndexMatrix: 
	-1.99972 0.0253029 -0.0220688
	-0.0207187 -1.85778 -0.252648
	-0.0236959 -0.252384 1.85779

	  Inverse Direction: 
	-0.999859 0.0126514 -0.0110344
	-0.01105 -0.990819 -0.134746
	-0.0126378 -0.134605 0.990819

	  PixelContainer: 
	    ImportImageContainer (0x55c13413d870)
	      RTTI typeinfo:   itk::ImportImageContainer&lt;unsigned long, double&gt;
	      Reference Count: 1
	      Modified Time: 2584
	      Debug: Off
	      Object Name: 
	      Observers: 
	        none
	      Pointer: 0x7fb7e9f38010
	      Container manages memory: true
	      Size: 45722880
	      Capacity: 45722880

	     Weighting = 1
	     Sampling strategy = none
	     Number of bins = 32
	     Radius = 4
	     Sampling percentage  = 1
	   Transform = SyN
	     Gradient step = 0.1
	     Update field sigma (voxel space) = 3
	     Total field sigma (voxel space) = 0
	     Update field time sigma = 0
	     Total field time sigma  = 0
	     Number of time indices = 0
	     Number of time point samples = 0
	Registration using 3 total stages.

	Stage 0
	  iterations = 1000x500x250x0
	  convergence threshold = 1e-06
	  convergence window size = 10
	  number of levels = 4
	  using the Mattes MI metric (number of bins = 32, weight = 1, use gradient filter = 0)
	  preprocessing:  winsorizing the image intensities
	  Shrink factors (level 1 out of 4): [12, 11, 11]
	  Shrink factors (level 2 out of 4): [8, 7, 7]
	  Shrink factors (level 3 out of 4): [4, 4, 4]
	  Shrink factors (level 4 out of 4): [2, 2, 2]
	  smoothing sigmas per level: [4, 3, 2, 1]
	  regular sampling (percentage = 0.25)

	*** Running Euler3DTransform registration ***

	DIAGNOSTIC,Iteration,metricValue,convergenceValue,ITERATION_TIME_INDEX,SINCE_LAST
	 2DIAGNOSTIC,     1, -1.847269817564e+00, 1.797693134862e+308, 1.7739e+00, 1.7739e+00, 
	 2DIAGNOSTIC,     2, -1.847325733841e+00, 1.797693134862e+308, 1.7786e+00, 4.7030e-03, 
	 2DIAGNOSTIC,     3, -1.847342828388e+00, 1.797693134862e+308, 1.7842e+00, 5.6381e-03, 
	 2DIAGNOSTIC,     4, -1.847358785005e+00, 1.797693134862e+308, 1.7912e+00, 6.9442e-03, 
	 2DIAGNOSTIC,     5, -1.847490152799e+00, 1.797693134862e+308, 1.7959e+00, 4.7410e-03, 
	 2DIAGNOSTIC,     6, -1.847505958096e+00, 1.797693134862e+308, 1.8011e+00, 5.2249e-03, 
	 2DIAGNOSTIC,     7, -1.847513687333e+00, 1.797693134862e+308, 1.8054e+00, 4.3058e-03, 
	 2DIAGNOSTIC,     8, -1.847514021857e+00, 1.797693134862e+308, 1.8114e+00, 5.9361e-03, 
	 2DIAGNOSTIC,     9, -1.847514295521e+00, 1.797693134862e+308, 1.8160e+00, 4.6048e-03, 
	 2DIAGNOSTIC,    10, -1.847514456888e+00, 1.248046045561e-05, 1.8208e+00, 4.8268e-03, 
	 2DIAGNOSTIC,    11, -1.847514863207e+00, 9.334741336214e-06, 1.8268e+00, 5.9481e-03, 
	 2DIAGNOSTIC,    12, -1.847515015299e+00, 6.875570068093e-06, 1.8315e+00, 4.7009e-03, 
	 2DIAGNOSTIC,    13, -1.847515110651e+00, 4.632715425515e-06, 1.8367e+00, 5.2419e-03, 
	 2DIAGNOSTIC,    14, -1.847515299338e+00, 2.651235940204e-06, 1.8427e+00, 6.0279e-03, 
	 2DIAGNOSTIC,    15, -1.847515328307e+00, 2.243239931601e-06, 1.8479e+00, 5.1799e-03, 
	 2DIAGNOSTIC,    16, -1.847515371645e+00, 2.025294424279e-06, 1.8524e+00, 4.4520e-03, 
	 2DIAGNOSTIC,    17, -1.847515388914e+00, 1.899619578277e-06, 1.8577e+00, 5.3709e-03, 
	 2DIAGNOSTIC,    18, -1.847515389124e+00, 1.788131926521e-06, 1.8720e+00, 1.4276e-02, 
	 2DIAGNOSTIC,    19, -1.847515389124e+00, 1.688661882292e-06, 1.8840e+00, 1.1990e-02, 
	 2DIAGNOSTIC,    20, -1.847515389124e+00, 1.598968728443e-06, 1.8892e+00, 5.1939e-03, 
	 2DIAGNOSTIC,    21, -1.847515389124e+00, 1.520000834893e-06, 1.8943e+00, 5.1341e-03, 
	 2DIAGNOSTIC,    22, -1.847515389124e+00, 1.448785846583e-06, 1.8996e+00, 5.3120e-03, 
	 2DIAGNOSTIC,    23, -1.847515389124e+00, 1.384104955676e-06, 1.9052e+00, 5.5330e-03, 
	 2DIAGNOSTIC,    24, -1.847515389124e+00, 1.325926166029e-06, 1.9101e+00, 4.9131e-03, 
	 2DIAGNOSTIC,    25, -1.847515389124e+00, 1.272527789579e-06, 1.9149e+00, 4.8342e-03, 
	 2DIAGNOSTIC,    26, -1.847515389124e+00, 1.223480330229e-06, 1.9210e+00, 6.1040e-03, 
	 2DIAGNOSTIC,    27, -1.847515389124e+00, 1.178164316655e-06, 1.9260e+00, 4.9849e-03, 
	 2DIAGNOSTIC,    28, -1.847515389124e+00, 1.136086365899e-06, 1.9316e+00, 5.6109e-03, 
	 2DIAGNOSTIC,    29, -1.847515389124e+00, 1.096910384996e-06, 1.9367e+00, 5.1198e-03, 
	 2DIAGNOSTIC,    30, -1.847515389124e+00, 1.060346174114e-06, 1.9419e+00, 5.1770e-03, 
	 2DIAGNOSTIC,    31, -1.847515389124e+00, 1.026140977751e-06, 1.9469e+00, 5.0380e-03, 
	DIAGNOSTIC,Iteration,metricValue,convergenceValue,ITERATION_TIME_INDEX,SINCE_LAST
	 2DIAGNOSTIC,     1, -1.849001441198e+00, 1.797693134862e+308, 3.7029e+00, 1.7560e+00, 
	 2DIAGNOSTIC,     2, -1.849105546208e+00, 1.797693134862e+308, 3.7636e+00, 6.0630e-02, 
	 2DIAGNOSTIC,     3, -1.849105692496e+00, 1.797693134862e+308, 3.8002e+00, 3.6662e-02, 
	 2DIAGNOSTIC,     4, -1.849110061534e+00, 1.797693134862e+308, 3.8330e+00, 3.2729e-02, 
	 2DIAGNOSTIC,     5, -1.849080999893e+00, 1.797693134862e+308, 3.8597e+00, 2.6736e-02, 
	 2DIAGNOSTIC,     6, -1.849089987176e+00, 1.797693134862e+308, 3.8821e+00, 2.2445e-02, 
	 2DIAGNOSTIC,     7, -1.849100932406e+00, 1.797693134862e+308, 3.9040e+00, 2.1896e-02, 
	 2DIAGNOSTIC,     8, -1.849112400599e+00, 1.797693134862e+308, 3.9258e+00, 2.1781e-02, 
	 2DIAGNOSTIC,     9, -1.849124053981e+00, 1.797693134862e+308, 3.9484e+00, 2.2589e-02, 
	 2DIAGNOSTIC,    10, -1.849138825699e+00, 5.570875560773e-06, 3.9707e+00, 2.2315e-02, 
	 2DIAGNOSTIC,    11, -1.849138951285e+00, 4.130348576797e-06, 3.9965e+00, 2.5756e-02, 
	 2DIAGNOSTIC,    12, -1.849114540192e+00, 3.835506374769e-06, 4.0245e+00, 2.7981e-02, 
	 2DIAGNOSTIC,    13, -1.849119294609e+00, 3.540934911520e-06, 4.0527e+00, 2.8240e-02, 
	 2DIAGNOSTIC,    14, -1.849122384976e+00, 3.275333262165e-06, 4.0749e+00, 2.2157e-02, 
	 2DIAGNOSTIC,    15, -1.849125370124e+00, 2.679585775808e-06, 4.1001e+00, 2.5235e-02, 
	 2DIAGNOSTIC,    16, -1.849129677260e+00, 2.235513931192e-06, 4.1327e+00, 3.2571e-02, 
	 2DIAGNOSTIC,    17, -1.849130042931e+00, 1.926875013887e-06, 4.1548e+00, 2.2178e-02, 
	 2DIAGNOSTIC,    18, -1.849130631196e+00, 1.749788376117e-06, 4.1768e+00, 2.1941e-02, 
	 2DIAGNOSTIC,    19, -1.849130675951e+00, 1.680766208483e-06, 4.2022e+00, 2.5367e-02, 
	 2DIAGNOSTIC,    20, -1.849130748664e+00, 1.729914239114e-06, 4.2276e+00, 2.5417e-02, 
	 2DIAGNOSTIC,    21, -1.849130804652e+00, 1.768071910616e-06, 4.2527e+00, 2.5159e-02, 
	 2DIAGNOSTIC,    22, -1.849130902365e+00, 1.608723328175e-06, 4.2779e+00, 2.5168e-02, 
	 2DIAGNOSTIC,    23, -1.849130953953e+00, 1.480150577458e-06, 4.3555e+00, 7.7603e-02, 
	 2DIAGNOSTIC,    24, -1.849130953953e+00, 1.372787381618e-06, 4.4149e+00, 5.9449e-02, 
	 2DIAGNOSTIC,    25, -1.849130953953e+00, 1.287248981768e-06, 4.4508e+00, 3.5882e-02, 
	 2DIAGNOSTIC,    26, -1.849130953953e+00, 1.232336370907e-06, 4.4760e+00, 2.5188e-02, 
	 2DIAGNOSTIC,    27, -1.849130953953e+00, 1.182639793713e-06, 4.5014e+00, 2.5395e-02, 
	 2DIAGNOSTIC,    28, -1.849130953953e+00, 1.139295060119e-06, 4.5296e+00, 2.8199e-02, 
	 2DIAGNOSTIC,    29, -1.849130953953e+00, 1.098872863349e-06, 4.5553e+00, 2.5685e-02, 
	 2DIAGNOSTIC,    30, -1.849130953953e+00, 1.061333760627e-06, 4.5868e+00, 3.1493e-02, 
	 2DIAGNOSTIC,    31, -1.849130953953e+00, 1.026389069611e-06, 4.6119e+00, 2.5145e-02, 
	DIAGNOSTIC,Iteration,metricValue,convergenceValue,ITERATION_TIME_INDEX,SINCE_LAST
	 2DIAGNOSTIC,     1, -1.832227971573e+00, 1.797693134862e+308, 6.6728e+00, 2.0609e+00, 
	 2DIAGNOSTIC,     2, -1.832237852852e+00, 1.797693134862e+308, 6.8405e+00, 1.6767e-01, 
	 2DIAGNOSTIC,     3, -1.832229661375e+00, 1.797693134862e+308, 7.0278e+00, 1.8730e-01, 
	 2DIAGNOSTIC,     4, -1.832232607532e+00, 1.797693134862e+308, 7.2241e+00, 1.9632e-01, 
	 2DIAGNOSTIC,     5, -1.832241999137e+00, 1.797693134862e+308, 7.3871e+00, 1.6300e-01, 
	 2DIAGNOSTIC,     6, -1.832239841873e+00, 1.797693134862e+308, 7.5535e+00, 1.6639e-01, 
	 2DIAGNOSTIC,     7, -1.832240571170e+00, 1.797693134862e+308, 7.8325e+00, 2.7902e-01, 
	 2DIAGNOSTIC,     8, -1.832234932344e+00, 1.797693134862e+308, 7.9764e+00, 1.4395e-01, 
	 2DIAGNOSTIC,     9, -1.832234940034e+00, 1.797693134862e+308, 8.1183e+00, 1.4185e-01, 
	 2DIAGNOSTIC,    10, -1.832234945567e+00, 3.359244244813e-06, 8.2874e+00, 1.6910e-01, 
	 2DIAGNOSTIC,    11, -1.832234947594e+00, 2.894229329309e-06, 8.4367e+00, 1.4937e-01, 
	 2DIAGNOSTIC,    12, -1.832234950520e+00, 2.639965758791e-06, 8.5856e+00, 1.4889e-01, 
	 2DIAGNOSTIC,    13, -1.832234958646e+00, 2.329181100630e-06, 8.7305e+00, 1.4489e-01, 
	 2DIAGNOSTIC,    14, -1.832234967091e+00, 2.103314921106e-06, 8.8780e+00, 1.4750e-01, 
	 2DIAGNOSTIC,    15, -1.832234977700e+00, 2.019983430884e-06, 9.0407e+00, 1.6264e-01, 
	 2DIAGNOSTIC,    16, -1.832240500683e+00, 1.988065921568e-06, 9.1909e+00, 1.5026e-01, 
	 2DIAGNOSTIC,    17, -1.832234993249e+00, 1.916350759447e-06, 9.7165e+00, 5.2552e-01, 
	 2DIAGNOSTIC,    18, -1.832234993246e+00, 1.801766489687e-06, 1.0189e+01, 4.7289e-01, 
	 2DIAGNOSTIC,    19, -1.832234993246e+00, 1.696295978959e-06, 1.0459e+01, 2.6976e-01, 
	 2DIAGNOSTIC,    20, -1.832234993246e+00, 1.598504373132e-06, 1.0621e+01, 1.6207e-01, 
	 2DIAGNOSTIC,    21, -1.832234993246e+00, 1.508761332730e-06, 1.0793e+01, 1.7180e-01, 
	 2DIAGNOSTIC,    22, -1.832234993246e+00, 1.428265954576e-06, 1.0963e+01, 1.6957e-01, 
	 2DIAGNOSTIC,    23, -1.832234993246e+00, 1.357221815816e-06, 1.1133e+01, 1.7056e-01, 
	 2DIAGNOSTIC,    24, -1.832234993246e+00, 1.294420636087e-06, 1.1301e+01, 1.6787e-01, 
	 2DIAGNOSTIC,    25, -1.832234993246e+00, 1.238224762161e-06, 1.1471e+01, 1.7025e-01, 
	 2DIAGNOSTIC,    26, -1.832234993246e+00, 1.223458282115e-06, 1.1614e+01, 1.4319e-01, 
	 2DIAGNOSTIC,    27, -1.832234993246e+00, 1.178145037743e-06, 1.1785e+01, 1.7107e-01, 
	 2DIAGNOSTIC,    28, -1.832234993246e+00, 1.136068438073e-06, 1.1954e+01, 1.6817e-01, 
	 2DIAGNOSTIC,    29, -1.832234993246e+00, 1.096893672274e-06, 1.2122e+01, 1.6796e-01, 
	 2DIAGNOSTIC,    30, -1.832234993246e+00, 1.060330556989e-06, 1.2285e+01, 1.6375e-01, 
	 2DIAGNOSTIC,    31, -1.832234993246e+00, 1.026126351958e-06, 1.2452e+01, 1.6669e-01, 
	DIAGNOSTIC,Iteration,metricValue,convergenceValue,ITERATION_TIME_INDEX,SINCE_LAST
	 2DIAGNOSTIC,     1, -1.823575530639e+00, 1.797693134862e+308, 1.6464e+01, 4.0122e+00, 
	  Elapsed time (stage 0): 1.7997e+01


	Stage 1
	  iterations = 1000x500x250x0
	  convergence threshold = 1.0000e-06
	  convergence window size = 10
	  number of levels = 4
	  using the Mattes MI metric (number of bins = 32, weight = 1.0000e+00, use gradient filter = 0)
	  preprocessing:  winsorizing the image intensities
	  Shrink factors (level 1 out of 4): [12, 11, 11]
	  Shrink factors (level 2 out of 4): [8, 7, 7]
	  Shrink factors (level 3 out of 4): [4, 4, 4]
	  Shrink factors (level 4 out of 4): [2, 2, 2]
	  smoothing sigmas per level: [4, 3, 2, 1]
	  regular sampling (percentage = 2.5000e-01)

	*** Running AffineTransform registration ***

	DIAGNOSTIC,Iteration,metricValue,convergenceValue,ITERATION_TIME_INDEX,SINCE_LAST
	 2DIAGNOSTIC,     1, -1.852512352013e+00, 1.797693134862e+308, 1.7194e+00, 1.7194e+00, 
	 2DIAGNOSTIC,     2, -1.852728306814e+00, 1.797693134862e+308, 1.7266e+00, 7.2470e-03, 
	 2DIAGNOSTIC,     3, -1.852752164515e+00, 1.797693134862e+308, 1.7317e+00, 5.1088e-03, 
	 2DIAGNOSTIC,     4, -1.852829465945e+00, 1.797693134862e+308, 1.7375e+00, 5.7440e-03, 
	 2DIAGNOSTIC,     5, -1.852826114164e+00, 1.797693134862e+308, 1.7422e+00, 4.7350e-03, 
	 2DIAGNOSTIC,     6, -1.852836384047e+00, 1.797693134862e+308, 1.7472e+00, 5.0120e-03, 
	 2DIAGNOSTIC,     7, -1.852842907785e+00, 1.797693134862e+308, 1.7528e+00, 5.5599e-03, 
	 2DIAGNOSTIC,     8, -1.852849237587e+00, 1.797693134862e+308, 1.7586e+00, 5.7819e-03, 
	 2DIAGNOSTIC,     9, -1.852852676373e+00, 1.797693134862e+308, 1.7649e+00, 6.2730e-03, 
	 2DIAGNOSTIC,    10, -1.852853957103e+00, 1.125567120022e-05, 1.7725e+00, 7.6001e-03, 
	 2DIAGNOSTIC,    11, -1.852854274335e+00, 6.281295451577e-06, 1.7788e+00, 6.3210e-03, 
	 2DIAGNOSTIC,    12, -1.852854771418e+00, 4.600053388593e-06, 1.7849e+00, 6.1340e-03, 
	 2DIAGNOSTIC,    13, -1.852854809434e+00, 3.257202021836e-06, 1.7898e+00, 4.9040e-03, 
	 2DIAGNOSTIC,    14, -1.852854850354e+00, 2.882759115058e-06, 1.7952e+00, 5.3549e-03, 
	 2DIAGNOSTIC,    15, -1.852854887660e+00, 2.467165874917e-06, 1.8005e+00, 5.2929e-03, 
	 2DIAGNOSTIC,    16, -1.852854916724e+00, 2.169850623734e-06, 1.8065e+00, 5.9969e-03, 
	 2DIAGNOSTIC,    17, -1.852854919648e+00, 1.948518747213e-06, 1.8121e+00, 5.6171e-03, 
	 2DIAGNOSTIC,    18, -1.852854921064e+00, 1.797911859537e-06, 1.8277e+00, 1.5602e-02, 
	 2DIAGNOSTIC,    19, -1.852854921064e+00, 1.687875804304e-06, 1.8353e+00, 7.6089e-03, 
	 2DIAGNOSTIC,    20, -1.852854921064e+00, 1.597373653385e-06, 1.8406e+00, 5.3420e-03, 
	 2DIAGNOSTIC,    21, -1.852854921064e+00, 1.517069651798e-06, 1.8463e+00, 5.6322e-03, 
	 2DIAGNOSTIC,    22, -1.852854921064e+00, 1.447317544985e-06, 1.8515e+00, 5.2571e-03, 
	 2DIAGNOSTIC,    23, -1.852854921064e+00, 1.383752679406e-06, 1.8571e+00, 5.6028e-03, 
	 2DIAGNOSTIC,    24, -1.852854921064e+00, 1.325677406294e-06, 1.8625e+00, 5.3720e-03, 
	 2DIAGNOSTIC,    25, -1.852854921064e+00, 1.272449445734e-06, 1.8683e+00, 5.8110e-03, 
	 2DIAGNOSTIC,    26, -1.852854921064e+00, 1.223483858677e-06, 1.8736e+00, 5.3461e-03, 
	 2DIAGNOSTIC,    27, -1.852854921064e+00, 1.178160993431e-06, 1.8798e+00, 6.1300e-03, 
	 2DIAGNOSTIC,    28, -1.852854921064e+00, 1.136083274511e-06, 1.8856e+00, 5.8219e-03, 
	 2DIAGNOSTIC,    29, -1.852854921064e+00, 1.096907503155e-06, 1.8911e+00, 5.4770e-03, 
	 2DIAGNOSTIC,    30, -1.852854921064e+00, 1.060343481192e-06, 1.8966e+00, 5.4772e-03, 
	 2DIAGNOSTIC,    31, -1.852854921064e+00, 1.026138455776e-06, 1.9021e+00, 5.5339e-03, 
	DIAGNOSTIC,Iteration,metricValue,convergenceValue,ITERATION_TIME_INDEX,SINCE_LAST
	 2DIAGNOSTIC,     1, -1.846632107868e+00, 1.797693134862e+308, 3.7034e+00, 1.8013e+00, 
	 2DIAGNOSTIC,     2, -1.846891716323e+00, 1.797693134862e+308, 3.7453e+00, 4.1915e-02, 
	 2DIAGNOSTIC,     3, -1.846907537564e+00, 1.797693134862e+308, 3.7718e+00, 2.6510e-02, 
	 2DIAGNOSTIC,     4, -1.846977421595e+00, 1.797693134862e+308, 3.7983e+00, 2.6533e-02, 
	 2DIAGNOSTIC,     5, -1.847028761426e+00, 1.797693134862e+308, 3.8233e+00, 2.5013e-02, 
	 2DIAGNOSTIC,     6, -1.847042554528e+00, 1.797693134862e+308, 3.8515e+00, 2.8208e-02, 
	 2DIAGNOSTIC,     7, -1.847086227656e+00, 1.797693134862e+308, 3.8773e+00, 2.5773e-02, 
	 2DIAGNOSTIC,     8, -1.847085816939e+00, 1.797693134862e+308, 3.9057e+00, 2.8415e-02, 
	 2DIAGNOSTIC,     9, -1.847088768255e+00, 1.797693134862e+308, 3.9410e+00, 3.5245e-02, 
	 2DIAGNOSTIC,    10, -1.847089158206e+00, 1.560587065520e-05, 3.9669e+00, 2.5875e-02, 
	 2DIAGNOSTIC,    11, -1.847090432201e+00, 9.458420110062e-06, 3.9918e+00, 2.4899e-02, 
	 2DIAGNOSTIC,    12, -1.847091024839e+00, 7.089242702860e-06, 4.0173e+00, 2.5521e-02, 
	 2DIAGNOSTIC,    13, -1.847091720633e+00, 4.863669024177e-06, 4.0525e+00, 3.5261e-02, 
	 2DIAGNOSTIC,    14, -1.847091862985e+00, 3.499232480650e-06, 4.0776e+00, 2.5059e-02, 
	 2DIAGNOSTIC,    15, -1.847092023079e+00, 2.734202599441e-06, 4.1027e+00, 2.5156e-02, 
	 2DIAGNOSTIC,    16, -1.847092132064e+00, 2.130457246244e-06, 4.1311e+00, 2.8400e-02, 
	 2DIAGNOSTIC,    17, -1.847092191371e+00, 1.980826899985e-06, 4.1588e+00, 2.7649e-02, 
	 2DIAGNOSTIC,    18, -1.847092228523e+00, 1.833894553660e-06, 4.2430e+00, 8.4184e-02, 
	 2DIAGNOSTIC,    19, -1.847092228523e+00, 1.720235719718e-06, 4.3054e+00, 6.2391e-02, 
	 2DIAGNOSTIC,    20, -1.847092228523e+00, 1.616514897322e-06, 4.3327e+00, 2.7364e-02, 
	 2DIAGNOSTIC,    21, -1.847092228523e+00, 1.529526913652e-06, 4.3599e+00, 2.7185e-02, 
	 2DIAGNOSTIC,    22, -1.847092228523e+00, 1.453097108008e-06, 4.3871e+00, 2.7208e-02, 
	 2DIAGNOSTIC,    23, -1.847092228523e+00, 1.387291108358e-06, 4.4141e+00, 2.6982e-02, 
	 2DIAGNOSTIC,    24, -1.847092228523e+00, 1.327470904221e-06, 4.4432e+00, 2.9065e-02, 
	 2DIAGNOSTIC,    25, -1.847092228523e+00, 1.273220561857e-06, 4.4781e+00, 3.4875e-02, 
	 2DIAGNOSTIC,    26, -1.847092228523e+00, 1.223706375411e-06, 4.5091e+00, 3.1029e-02, 
	 2DIAGNOSTIC,    27, -1.847092228523e+00, 1.178171193668e-06, 4.5414e+00, 3.2350e-02, 
	 2DIAGNOSTIC,    28, -1.847092228523e+00, 1.136092760763e-06, 4.5696e+00, 2.8212e-02, 
	 2DIAGNOSTIC,    29, -1.847092228523e+00, 1.096916346442e-06, 4.6015e+00, 3.1875e-02, 
	 2DIAGNOSTIC,    30, -1.847092228523e+00, 1.060351744755e-06, 4.6299e+00, 2.8342e-02, 
	 2DIAGNOSTIC,    31, -1.847092228523e+00, 1.026146194794e-06, 4.6614e+00, 3.1522e-02, 
	DIAGNOSTIC,Iteration,metricValue,convergenceValue,ITERATION_TIME_INDEX,SINCE_LAST
	 2DIAGNOSTIC,     1, -1.835625007312e+00, 1.797693134862e+308, 6.7441e+00, 2.0827e+00, 
	 2DIAGNOSTIC,     2, -1.835665424201e+00, 1.797693134862e+308, 6.9614e+00, 2.1728e-01, 
	 2DIAGNOSTIC,     3, -1.835672290514e+00, 1.797693134862e+308, 7.1122e+00, 1.5080e-01, 
	 2DIAGNOSTIC,     4, -1.835689622589e+00, 1.797693134862e+308, 7.2676e+00, 1.5540e-01, 
	 2DIAGNOSTIC,     5, -1.835694396859e+00, 1.797693134862e+308, 7.4184e+00, 1.5085e-01, 
	 2DIAGNOSTIC,     6, -1.835697893853e+00, 1.797693134862e+308, 7.5910e+00, 1.7255e-01, 
	 2DIAGNOSTIC,     7, -1.835703683076e+00, 1.797693134862e+308, 7.7685e+00, 1.7756e-01, 
	 2DIAGNOSTIC,     8, -1.835700101150e+00, 1.797693134862e+308, 7.9477e+00, 1.7915e-01, 
	 2DIAGNOSTIC,     9, -1.835700537041e+00, 1.797693134862e+308, 8.1212e+00, 1.7347e-01, 
	 2DIAGNOSTIC,    10, -1.835700755280e+00, 5.241594285596e-06, 8.3210e+00, 1.9989e-01, 
	 2DIAGNOSTIC,    11, -1.835700848978e+00, 3.899227140391e-06, 8.5005e+00, 1.7947e-01, 
	 2DIAGNOSTIC,    12, -1.835700857266e+00, 3.211828257813e-06, 8.6519e+00, 1.5138e-01, 
	 2DIAGNOSTIC,    13, -1.835700867420e+00, 2.657366479614e-06, 8.8292e+00, 1.7727e-01, 
	 2DIAGNOSTIC,    14, -1.835700878144e+00, 2.354863106610e-06, 9.0347e+00, 2.0548e-01, 
	 2DIAGNOSTIC,    15, -1.835700884672e+00, 2.133511632363e-06, 9.2716e+00, 2.3693e-01, 
	 2DIAGNOSTIC,    16, -1.835700887086e+00, 1.970535868437e-06, 9.4250e+00, 1.5347e-01, 
	 2DIAGNOSTIC,    17, -1.835700893078e+00, 1.882145391617e-06, 9.5812e+00, 1.5613e-01, 
	 2DIAGNOSTIC,    18, -1.835700911088e+00, 1.771834547130e-06, 9.7360e+00, 1.5479e-01, 
	 2DIAGNOSTIC,    19, -1.835700965179e+00, 1.676655105004e-06, 1.0272e+01, 5.3621e-01, 
	 2DIAGNOSTIC,    20, -1.835700965178e+00, 1.592426737897e-06, 1.0667e+01, 3.9491e-01, 
	 2DIAGNOSTIC,    21, -1.835700965178e+00, 1.516738513070e-06, 1.0842e+01, 1.7526e-01, 
	 2DIAGNOSTIC,    22, -1.835700965178e+00, 1.447809640960e-06, 1.1019e+01, 1.7623e-01, 
	 2DIAGNOSTIC,    23, -1.835700965178e+00, 1.384760506519e-06, 1.1203e+01, 1.8442e-01, 
	 2DIAGNOSTIC,    24, -1.835700965178e+00, 1.326867180691e-06, 1.1377e+01, 1.7436e-01, 
	 2DIAGNOSTIC,    25, -1.835700965178e+00, 1.273510290785e-06, 1.1593e+01, 2.1529e-01, 
	 2DIAGNOSTIC,    26, -1.835700965178e+00, 1.224173386556e-06, 1.1770e+01, 1.7739e-01, 
	 2DIAGNOSTIC,    27, -1.835700965178e+00, 1.178459275830e-06, 1.1944e+01, 1.7442e-01, 
	 2DIAGNOSTIC,    28, -1.835700965178e+00, 1.136072224649e-06, 1.2117e+01, 1.7287e-01, 
	 2DIAGNOSTIC,    29, -1.835700965178e+00, 1.096897203623e-06, 1.2331e+01, 2.1326e-01, 
	 2DIAGNOSTIC,    30, -1.835700965178e+00, 1.060333856863e-06, 1.2550e+01, 2.1913e-01, 
	 2DIAGNOSTIC,    31, -1.835700965178e+00, 1.026129442368e-06, 1.2729e+01, 1.7935e-01, 
	DIAGNOSTIC,Iteration,metricValue,convergenceValue,ITERATION_TIME_INDEX,SINCE_LAST
	 2DIAGNOSTIC,     1, -1.823786183832e+00, 1.797693134862e+308, 1.6807e+01, 4.0782e+00, 
	  Elapsed time (stage 1): 1.8352e+01


	Stage 2
	  iterations = 100x100x70x50x0
	  convergence threshold = 1.0000e-06
	  convergence window size = 10
	  number of levels = 5
	  using the Mattes MI metric (number of bins = 32, weight = 1.0000e+00, use gradient filter = 0)
	  preprocessing:  winsorizing the image intensities
	  Shrink factors (level 1 out of 5): [10, 9, 9]
	  Shrink factors (level 2 out of 5): [6, 6, 6]
	  Shrink factors (level 3 out of 5): [4, 4, 4]
	  Shrink factors (level 4 out of 5): [2, 2, 2]
	  Shrink factors (level 5 out of 5): [1, 1, 1]
	  smoothing sigmas per level: [5, 3, 2, 1, 0]
	  Using default NONE metricSamplingStrategy 

	*** Running SyN registration (varianceForUpdateField = 3.0000e+00, varianceForTotalField = 0.0000e+00) ***

	XXDIAGNOSTIC,Iteration,metricValue,convergenceValue,ITERATION_TIME_INDEX,SINCE_LAST
	 1DIAGNOSTIC,     1, -1.945323357870e+00, 1.797693134862e+308, 1.7431e+00, 1.7431e+00, 
	 1DIAGNOSTIC,     2, -1.939687099622e+00, 1.797693134862e+308, 1.8028e+00, 5.9690e-02, 
	 1DIAGNOSTIC,     3, -1.933937937793e+00, 1.797693134862e+308, 1.8618e+00, 5.9031e-02, 
	 1DIAGNOSTIC,     4, -1.935216116011e+00, 1.797693134862e+308, 1.9216e+00, 5.9774e-02, 
	 1DIAGNOSTIC,     5, -1.928785463433e+00, 1.797693134862e+308, 1.9807e+00, 5.9049e-02, 
	 1DIAGNOSTIC,     6, -1.931605565263e+00, 1.797693134862e+308, 2.0396e+00, 5.8915e-02, 
	 1DIAGNOSTIC,     7, -1.928823974825e+00, 1.797693134862e+308, 2.0984e+00, 5.8868e-02, 
	 1DIAGNOSTIC,     8, -1.930167058239e+00, 1.797693134862e+308, 2.1570e+00, 5.8592e-02, 
	 1DIAGNOSTIC,     9, -1.926318262673e+00, 1.797693134862e+308, 2.2159e+00, 5.8897e-02, 
	 1DIAGNOSTIC,    10, -1.928939460506e+00, -4.853913078687e-04, 2.2754e+00, 5.9489e-02, 
	XXDIAGNOSTIC,Iteration,metricValue,convergenceValue,ITERATION_TIME_INDEX,SINCE_LAST
	 1DIAGNOSTIC,     1, -1.855395465506e+00, 1.797693134862e+308, 4.1140e+00, 1.8386e+00, 
	 1DIAGNOSTIC,     2, -1.861704340697e+00, 1.797693134862e+308, 4.3267e+00, 2.1263e-01, 
	 1DIAGNOSTIC,     3, -1.858188242627e+00, 1.797693134862e+308, 4.5399e+00, 2.1324e-01, 
	 1DIAGNOSTIC,     4, -1.858689520956e+00, 1.797693134862e+308, 4.7595e+00, 2.1956e-01, 
	 1DIAGNOSTIC,     5, -1.856389023324e+00, 1.797693134862e+308, 4.9753e+00, 2.1586e-01, 
	 1DIAGNOSTIC,     6, -1.856828130765e+00, 1.797693134862e+308, 5.1921e+00, 2.1676e-01, 
	 1DIAGNOSTIC,     7, -1.853618904733e+00, 1.797693134862e+308, 5.4173e+00, 2.2521e-01, 
	 1DIAGNOSTIC,     8, -1.855567101273e+00, 1.797693134862e+308, 5.6317e+00, 2.1436e-01, 
	 1DIAGNOSTIC,     9, -1.852706375011e+00, 1.797693134862e+308, 5.8617e+00, 2.3009e-01, 
	 1DIAGNOSTIC,    10, -1.854680260755e+00, -1.914042202748e-04, 6.0860e+00, 2.2430e-01, 
	XXDIAGNOSTIC,Iteration,metricValue,convergenceValue,ITERATION_TIME_INDEX,SINCE_LAST
	 1DIAGNOSTIC,     1, -1.840732177431e+00, 1.797693134862e+308, 8.4621e+00, 2.3761e+00, 
	 1DIAGNOSTIC,     2, -1.844388798760e+00, 1.797693134862e+308, 9.1469e+00, 6.8477e-01, 
	 1DIAGNOSTIC,     3, -1.841119095005e+00, 1.797693134862e+308, 9.8596e+00, 7.1272e-01, 
	 1DIAGNOSTIC,     4, -1.842227434944e+00, 1.797693134862e+308, 1.0596e+01, 7.3608e-01, 
	 1DIAGNOSTIC,     5, -1.840585019971e+00, 1.797693134862e+308, 1.1296e+01, 7.0011e-01, 
	 1DIAGNOSTIC,     6, -1.841010248209e+00, 1.797693134862e+308, 1.1985e+01, 6.8929e-01, 
	 1DIAGNOSTIC,     7, -1.839552581628e+00, 1.797693134862e+308, 1.2697e+01, 7.1193e-01, 
	 1DIAGNOSTIC,     8, -1.840093705246e+00, 1.797693134862e+308, 1.3375e+01, 6.7789e-01, 
	 1DIAGNOSTIC,     9, -1.838564805993e+00, 1.797693134862e+308, 1.4125e+01, 7.5033e-01, 
	 1DIAGNOSTIC,    10, -1.839344517941e+00, -1.260990669911e-04, 1.4811e+01, 6.8593e-01, 
	XXDIAGNOSTIC,Iteration,metricValue,convergenceValue,ITERATION_TIME_INDEX,SINCE_LAST
	 1DIAGNOSTIC,     1, -1.807752448167e+00, 1.797693134862e+308, 2.3093e+01, 8.2823e+00, 
	 1DIAGNOSTIC,     2, -1.809433248162e+00, 1.797693134862e+308, 2.9045e+01, 5.9514e+00, 
	 1DIAGNOSTIC,     3, -1.808401028951e+00, 1.797693134862e+308, 3.4941e+01, 5.8958e+00, 
	 1DIAGNOSTIC,     4, -1.808432609385e+00, 1.797693134862e+308, 4.0681e+01, 5.7407e+00, 
	 1DIAGNOSTIC,     5, -1.807418139066e+00, 1.797693134862e+308, 4.6531e+01, 5.8498e+00, 
	 1DIAGNOSTIC,     6, -1.807318460396e+00, 1.797693134862e+308, 5.2337e+01, 5.8058e+00, 
	 1DIAGNOSTIC,     7, -1.806295902728e+00, 1.797693134862e+308, 5.8184e+01, 5.8466e+00, 
	 1DIAGNOSTIC,     8, -1.806604430063e+00, 1.797693134862e+308, 6.3937e+01, 5.7536e+00, 
	 1DIAGNOSTIC,     9, -1.805704095100e+00, 1.797693134862e+308, 6.9724e+01, 5.7872e+00, 
	 1DIAGNOSTIC,    10, -1.805979030187e+00, -1.117134725924e-04, 7.5490e+01, 5.7654e+00, 
	 Registration finished. The antsRegistration call was:
	--------------------------------------------------------------------------------------
	/opt/ants-2.4.3/bin/antsRegistration --verbose 1 --dimensionality 3 --float 0 --collapse-output-transforms 1 --output [ sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_T1w_,sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_T1w_Warped.nii.gz,sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_T1w_InverseWarped.nii.gz ] --interpolation Linear --use-histogram-matching 0 --winsorize-image-intensities [ 0.005,0.995 ] --initial-moving-transform [ /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,/home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,1 ] --transform Rigid[ 0.1 ] --metric MI[ /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,/home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,1,32,Regular,0.25 ] --convergence [ 1000x500x250x0,1e-6,10 ] --shrink-factors 12x8x4x2 --smoothing-sigmas 4x3x2x1vox --transform Affine[ 0.1 ] --metric MI[ /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,/home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,1,32,Regular,0.25 ] --convergence [ 1000x500x250x0,1e-6,10 ] --shrink-factors 12x8x4x2 --smoothing-sigmas 4x3x2x1vox --transform SyN[ 0.1,3,0 ] --metric MI[ /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,/home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,1,32] --convergence [ 100x100x70x50x0,1e-6,10 ] --shrink-factors 10x6x4x2x1 --smoothing-sigmas 5x3x2x1x0vox
	--------------------------------------------------------------------------------------
	Moving image resampled into fixed space: sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_T1w_Warped.nii.gz
	Fixed image resampled into moving space: sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_T1w_InverseWarped.nii.gz
	--------------------------------------------------------------------------------------
Stderr:
	/opt/ants-2.4.3/bin/antsRegistrationSyNQuick.sh: line 679:  3728 Killed                  $COMMAND
Traceback:
	Traceback (most recent call last):
	  File &quot;/opt/miniconda-4.12.0/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 453, in aggregate_outputs
	    setattr(outputs, key, val)
	  File &quot;/opt/miniconda-4.12.0/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 330, in validate
	    value = super(File, self).validate(objekt, name, value, return_pathlike=True)
	  File &quot;/opt/miniconda-4.12.0/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 135, in validate
	    self.error(objekt, name, str(value))
	  File &quot;/opt/miniconda-4.12.0/lib/python3.8/site-packages/traits/base_trait_handler.py&quot;, line 74, in error
	    raise TraitError(
	traits.trait_errors.TraitError: The &#39;inverse_warp_field&#39; trait of a RegistrationSynQuickOutputSpec instance must be a pathlike object or string representing an existing file, but a value of &#39;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-1/ses-20170705/qsm_acq-acqmp2ragehighres0p5isoslab_T1w/ants_register-t1-to-qsm/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_T1w_1InverseWarp.nii.gz&#39; &lt;class &#39;str&#39;&gt; was specified.

	During handling of the above exception, another exception occurred:

	Traceback (most recent call last):
	  File &quot;/opt/miniconda-4.12.0/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 400, in run
	    outputs = self.aggregate_outputs(runtime)
	  File &quot;/opt/miniconda-4.12.0/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 460, in aggregate_outputs
	    raise FileNotFoundError(msg)
	FileNotFoundError: No such file or directory &#39;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-1/ses-20170705/qsm_acq-acqmp2ragehighres0p5isoslab_T1w/ants_register-t1-to-qsm/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_T1w_1InverseWarp.nii.gz&#39; for output &#39;inverse_warp_field&#39; of a RegistrationSynQuick interface


260222-03:03:35,77 nipype.workflow INFO:
	 [MultiProc] Running 0 tasks, and 20 jobs ready. Free memory (GB): 14.06/14.06, Free processors: 4/4.
260222-03:03:35,118 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.func_read-json-me&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-1/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/func_read-json-me&quot;.
260222-03:03:35,119 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_read-nii&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-1/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/nibabel_read-nii&quot;.
260222-03:03:35,130 nipype.workflow INFO:
	 [Node] Executing &quot;nibabel_read-nii&quot; &lt;nipype.interfaces.utility.wrappers.Function&gt;
260222-03:03:35,134 nipype.workflow INFO:
	 [Node] Finished &quot;nibabel_read-nii&quot;, elapsed time 0.003257s.
260222-03:03:35,119 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.func_read-json-se&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-1/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/func_read-json-se&quot;.
260222-03:03:35,171 nipype.workflow INFO:
	 [Node] Executing &quot;func_read-json-se&quot; &lt;nipype.interfaces.utility.wrappers.Function&gt;
260222-03:03:35,172 nipype.workflow INFO:
	 [Node] Finished &quot;func_read-json-se&quot;, elapsed time 0.000663s.
260222-03:03:35,130 nipype.workflow INFO:
	 [Node] Executing &quot;func_read-json-me&quot; &lt;nipype.interfaces.utility.wrappers.Function&gt;
260222-03:03:35,182 nipype.workflow INFO:
	 [Node] Finished &quot;func_read-json-me&quot;, elapsed time 0.00046s.
260222-03:03:35,119 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_as-canonical&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-1/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/nibabel_as-canonical&quot;.
260222-03:03:35,221 nipype.workflow INFO:
	 [Node] Executing &quot;nibabel_as-canonical&quot; &lt;nipype.interfaces.utility.wrappers.Function&gt;
260222-03:03:35,237 nipype.workflow INFO:
	 [Node] Finished &quot;nibabel_as-canonical&quot;, elapsed time 0.01487s.
260222-03:03:37,66 nipype.workflow INFO:
	 [Job 6] Completed (qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.func_read-json-me).
260222-03:03:37,67 nipype.workflow INFO:
	 [Job 7] Completed (qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.func_read-json-se).
260222-03:03:37,68 nipype.workflow INFO:
	 [Job 8] Completed (qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_read-nii).
260222-03:03:37,68 nipype.workflow INFO:
	 [Job 9] Completed (qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_as-canonical).
260222-03:03:37,69 nipype.workflow INFO:
	 [MultiProc] Running 0 tasks, and 18 jobs ready. Free memory (GB): 14.06/14.06, Free processors: 4/4.
260222-03:03:37,111 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.fastsurfer_segment-t1&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-1/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/fastsurfer_segment-t1&quot;.
260222-03:03:37,112 nipype.workflow INFO:
	 [Node] Executing &quot;fastsurfer_segment-t1&quot; &lt;qsmxt.interfaces.nipype_interface_fastsurfer.FastSurferInterface&gt;
260222-03:03:39,69 nipype.workflow INFO:
	 [MultiProc] Running 1 tasks, and 17 jobs ready. Free memory (GB): 2.06/14.06, Free processors: 0/4.
                     Currently running:
                       * qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.fastsurfer_segment-t1
260222-03:10:32,938 nipype.workflow INFO:
	 [Node] Finished &quot;fastsurfer_segment-t1&quot;, elapsed time 415.824995s.
260222-03:10:33,477 nipype.workflow INFO:
	 [Job 10] Completed (qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.fastsurfer_segment-t1).
260222-03:10:33,478 nipype.workflow INFO:
	 [MultiProc] Running 0 tasks, and 18 jobs ready. Free memory (GB): 14.06/14.06, Free processors: 4/4.
260222-03:10:33,512 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.ants_register-t1-to-qsm&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-1/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/ants_register-t1-to-qsm&quot;.
260222-03:10:33,514 nipype.workflow INFO:
	 [Node] Executing &quot;ants_register-t1-to-qsm&quot; &lt;nipype.interfaces.ants.registration.RegistrationSynQuick&gt;
260222-03:10:35,482 nipype.workflow INFO:
	 [MultiProc] Running 1 tasks, and 17 jobs ready. Free memory (GB): 6.06/14.06, Free processors: 0/4.
                     Currently running:
                       * qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.ants_register-t1-to-qsm
260222-03:12:21,485 nipype.workflow INFO:
	 [Node] Finished &quot;ants_register-t1-to-qsm&quot;, elapsed time 107.970378s.
260222-03:12:21,641 nipype.workflow INFO:
	 [Job 11] Completed (qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.ants_register-t1-to-qsm).
260222-03:12:21,643 nipype.workflow INFO:
	 [MultiProc] Running 0 tasks, and 17 jobs ready. Free memory (GB): 14.06/14.06, Free processors: 4/4.
260222-03:12:21,681 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.func_read-json-me&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-2/ses-20170705/qsm_acq-acqmp2ragehighres0p5isoslab_T1w/func_read-json-me&quot;.
260222-03:12:21,681 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.nibabel_as-canonical&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-2/ses-20170705/qsm_acq-acqmp2ragehighres0p5isoslab_T1w/nibabel_as-canonical&quot;.
260222-03:12:21,683 nipype.workflow INFO:
	 [Node] Executing &quot;func_read-json-me&quot; &lt;nipype.interfaces.utility.wrappers.Function&gt;
260222-03:12:21,684 nipype.workflow INFO:
	 [Node] Finished &quot;func_read-json-me&quot;, elapsed time 0.000738s.
260222-03:12:21,681 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.func_read-json-se&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-2/ses-20170705/qsm_acq-acqmp2ragehighres0p5isoslab_T1w/func_read-json-se&quot;.
260222-03:12:21,732 nipype.workflow INFO:
	 [Node] Executing &quot;func_read-json-se&quot; &lt;nipype.interfaces.utility.wrappers.Function&gt;
260222-03:12:21,683 nipype.workflow INFO:
	 [Node] Executing &quot;nibabel_as-canonical&quot; &lt;nipype.interfaces.utility.wrappers.Function&gt;
260222-03:12:21,733 nipype.workflow INFO:
	 [Node] Finished &quot;func_read-json-se&quot;, elapsed time 0.000366s.
260222-03:12:21,736 nipype.workflow INFO:
	 [Node] Finished &quot;nibabel_as-canonical&quot;, elapsed time 0.002432s.
260222-03:12:21,681 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.nibabel_read-nii&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-2/ses-20170705/qsm_acq-acqmp2ragehighres0p5isoslab_T1w/nibabel_read-nii&quot;.
260222-03:12:21,783 nipype.workflow INFO:
	 [Node] Executing &quot;nibabel_read-nii&quot; &lt;nipype.interfaces.utility.wrappers.Function&gt;
260222-03:12:21,785 nipype.workflow INFO:
	 [Node] Finished &quot;nibabel_read-nii&quot;, elapsed time 0.001159s.
260222-03:12:23,644 nipype.workflow INFO:
	 [Job 12] Completed (qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.func_read-json-me).
260222-03:12:23,645 nipype.workflow INFO:
	 [Job 13] Completed (qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.func_read-json-se).
260222-03:12:23,645 nipype.workflow INFO:
	 [Job 14] Completed (qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.nibabel_read-nii).
260222-03:12:23,646 nipype.workflow INFO:
	 [Job 15] Completed (qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.nibabel_as-canonical).
260222-03:12:23,647 nipype.workflow INFO:
	 [MultiProc] Running 0 tasks, and 14 jobs ready. Free memory (GB): 14.06/14.06, Free processors: 4/4.
260222-03:12:23,690 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.fastsurfer_segment-t1&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-2/ses-20170705/qsm_acq-acqmp2ragehighres0p5isoslab_T1w/fastsurfer_segment-t1&quot;.
260222-03:12:23,692 nipype.workflow INFO:
	 [Node] Executing &quot;fastsurfer_segment-t1&quot; &lt;qsmxt.interfaces.nipype_interface_fastsurfer.FastSurferInterface&gt;
260222-03:12:25,646 nipype.workflow INFO:
	 [MultiProc] Running 1 tasks, and 13 jobs ready. Free memory (GB): 2.06/14.06, Free processors: 0/4.
                     Currently running:
                       * qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.fastsurfer_segment-t1
260222-03:19:18,32 nipype.workflow INFO:
	 [Node] Finished &quot;fastsurfer_segment-t1&quot;, elapsed time 414.33969s.
260222-03:19:20,47 nipype.workflow INFO:
	 [Job 16] Completed (qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.fastsurfer_segment-t1).
260222-03:19:20,49 nipype.workflow INFO:
	 [MultiProc] Running 0 tasks, and 14 jobs ready. Free memory (GB): 14.06/14.06, Free processors: 4/4.
260222-03:19:20,88 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.ants_register-t1-to-qsm&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-2/ses-20170705/qsm_acq-acqmp2ragehighres0p5isoslab_T1w/ants_register-t1-to-qsm&quot;.
260222-03:19:20,90 nipype.workflow INFO:
	 [Node] Executing &quot;ants_register-t1-to-qsm&quot; &lt;nipype.interfaces.ants.registration.RegistrationSynQuick&gt;
260222-03:19:22,52 nipype.workflow INFO:
	 [MultiProc] Running 1 tasks, and 13 jobs ready. Free memory (GB): 6.06/14.06, Free processors: 0/4.
                     Currently running:
                       * qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.ants_register-t1-to-qsm
260222-03:21:18,30 nipype.workflow INFO:
	 [Node] Finished &quot;ants_register-t1-to-qsm&quot;, elapsed time 117.935842s.
260222-03:21:18,32 nipype.workflow WARNING:
	 Storing result file without outputs
260222-03:21:18,35 nipype.workflow WARNING:
	 [Node] Error on &quot;qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.ants_register-t1-to-qsm&quot; (/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-2/ses-20170705/qsm_acq-acqmp2ragehighres0p5isoslab_T1w/ants_register-t1-to-qsm)
260222-03:21:18,256 nipype.workflow ERROR:
	 Node ants_register-t1-to-qsm failed to run on host f150b6b6a634.
260222-03:21:18,257 nipype.workflow ERROR:
	 Saving crash info to /home/jovyan/workspace/books/examples/quantitative_imaging/crash-20260222-032118-jovyan-ants_register-t1-to-qsm-cec81da9-64d8-4fe9-8e0f-e6795dac3e92.pklz
Traceback (most recent call last):
  File &quot;/opt/miniconda-4.12.0/lib/python3.8/site-packages/nipype/pipeline/plugins/multiproc.py&quot;, line 67, in run_node
    result[&quot;result&quot;] = node.run(updatehash=updatehash)
  File &quot;/opt/miniconda-4.12.0/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 527, in run
    result = self._run_interface(execute=True)
  File &quot;/opt/miniconda-4.12.0/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 645, in _run_interface
    return self._run_command(execute)
  File &quot;/opt/miniconda-4.12.0/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 771, in _run_command
    raise NodeExecutionError(msg)
nipype.pipeline.engine.nodes.NodeExecutionError: Exception raised while executing Node ants_register-t1-to-qsm.

Cmdline:
	antsRegistrationSyNQuick.sh -d 3 -f /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-2/ses-20170705/anat/sub-2_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii -r 32 -m /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-2/ses-20170705/anat/sub-2_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii -n 4 -o sub-2_ses-20170705_acq-acqmp2ragehighres0p5isoslab_T1w_ -p d -s 26 -t s
Stdout:

	--------------------------------------------------------------------------------------
	 Mapping parameters
	--------------------------------------------------------------------------------------
	 ANTSPATH is /opt/ants-2.4.3/bin

	 Dimensionality:           3
	 Output name prefix:       sub-2_ses-20170705_acq-acqmp2ragehighres0p5isoslab_T1w_
	 Fixed images:             /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-2/ses-20170705/anat/sub-2_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii
	 Moving images:            /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-2/ses-20170705/anat/sub-2_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii
	 Mask images:              
	 Initial transforms:       
	 Number of threads:        4
	 Spline distance:          26
	 SyN gradient step:        0.1
	 Transform type:           s
	 MI histogram bins:        32
	 Precision:                d
	 Use histogram matching:   0
	 Repro                     0
	======================================================================================
	 antsRegistration call:
	--------------------------------------------------------------------------------------
	/opt/ants-2.4.3/bin/antsRegistration --verbose 1 --dimensionality 3 --float 0 --collapse-output-transforms 1 --output [ sub-2_ses-20170705_acq-acqmp2ragehighres0p5isoslab_T1w_,sub-2_ses-20170705_acq-acqmp2ragehighres0p5isoslab_T1w_Warped.nii.gz,sub-2_ses-20170705_acq-acqmp2ragehighres0p5isoslab_T1w_InverseWarped.nii.gz ] --interpolation Linear --use-histogram-matching 0 --winsorize-image-intensities [ 0.005,0.995 ] --initial-moving-transform [ /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-2/ses-20170705/anat/sub-2_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,/home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-2/ses-20170705/anat/sub-2_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,1 ] --transform Rigid[ 0.1 ] --metric MI[ /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-2/ses-20170705/anat/sub-2_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,/home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-2/ses-20170705/anat/sub-2_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,1,32,Regular,0.25 ] --convergence [ 1000x500x250x0,1e-6,10 ] --shrink-factors 12x8x4x2 --smoothing-sigmas 4x3x2x1vox --transform Affine[ 0.1 ] --metric MI[ /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-2/ses-20170705/anat/sub-2_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,/home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-2/ses-20170705/anat/sub-2_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,1,32,Regular,0.25 ] --convergence [ 1000x500x250x0,1e-6,10 ] --shrink-factors 12x8x4x2 --smoothing-sigmas 4x3x2x1vox --transform SyN[ 0.1,3,0 ] --metric MI[ /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-2/ses-20170705/anat/sub-2_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,/home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-2/ses-20170705/anat/sub-2_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,1,32] --convergence [ 100x100x70x50x0,1e-6,10 ] --shrink-factors 10x6x4x2x1 --smoothing-sigmas 5x3x2x1x0vox
	--------------------------------------------------------------------------------------
	All_Command_lines_OK
	Using double precision for computations.
	=============================================================================
	The composite transform comprises the following transforms (in order): 
	  1. Center of mass alignment using fixed image: /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-2/ses-20170705/anat/sub-2_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii and moving image: /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-2/ses-20170705/anat/sub-2_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii (type = Euler3DTransform)
	=============================================================================
	  number of levels = 4
	  number of levels = 4
	  number of levels = 5
	  fixed image: /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-2/ses-20170705/anat/sub-2_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii
	  moving image: /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-2/ses-20170705/anat/sub-2_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii
	  fixed image: /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-2/ses-20170705/anat/sub-2_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii
	  moving image: /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-2/ses-20170705/anat/sub-2_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii
	  fixed image: /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-2/ses-20170705/anat/sub-2_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii
	  moving image: /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-2/ses-20170705/anat/sub-2_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii
	Dimension = 3
	Number of stages = 3
	Use histogram matching = false
	Winsorize image intensities = true
	  Lower quantile = 0.005
	  Upper quantile = 0.995


	Stage 1 State
	   Image metric = Mattes
	     Fixed image = Image (0x556df54618f0)
	  RTTI typeinfo:   itk::Image&lt;double, 3u&gt;
	  Reference Count: 2
	  Modified Time: 1725
	  Debug: Off
	  Object Name: 
	  Observers: 
	    none
	  Source: (none)
	  Source output name: (none)
	  Release Data: Off
	  Data Released: False
	  Global Release Data: Off
	  PipelineMTime: 0
	  UpdateMTime: 1508
	  RealTimeStamp: 0 seconds 
	  LargestPossibleRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  BufferedRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  RequestedRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  Spacing: [0.5, 0.533333, 0.533333]
	  Origin: [75.0348, 90.125, -137.286]
	  Direction: 
	-0.999859 -0.01105 -0.0126378
	0.0126514 -0.990819 -0.134605
	-0.0110344 -0.134746 0.990819

	  IndexToPointMatrix: 
	-0.49993 -0.00589333 -0.00674016
	0.00632572 -0.528437 -0.0717891
	-0.00551719 -0.0718643 0.528437

	  PointToIndexMatrix: 
	-1.99972 0.0253029 -0.0220688
	-0.0207187 -1.85778 -0.252648
	-0.0236959 -0.252384 1.85779

	  Inverse Direction: 
	-0.999859 0.0126514 -0.0110344
	-0.01105 -0.990819 -0.134746
	-0.0126378 -0.134605 0.990819

	  PixelContainer: 
	    ImportImageContainer (0x556df5467280)
	      RTTI typeinfo:   itk::ImportImageContainer&lt;unsigned long, double&gt;
	      Reference Count: 1
	      Modified Time: 1505
	      Debug: Off
	      Object Name: 
	      Observers: 
	        none
	      Pointer: 0x7fd917904010
	      Container manages memory: true
	      Size: 45722880
	      Capacity: 45722880

	     Moving image = Image (0x556df5465390)
	  RTTI typeinfo:   itk::Image&lt;double, 3u&gt;
	  Reference Count: 2
	  Modified Time: 1726
	  Debug: Off
	  Object Name: 
	  Observers: 
	    none
	  Source: (none)
	  Source output name: (none)
	  Release Data: Off
	  Data Released: False
	  Global Release Data: Off
	  PipelineMTime: 0
	  UpdateMTime: 1723
	  RealTimeStamp: 0 seconds 
	  LargestPossibleRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  BufferedRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  RequestedRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  Spacing: [0.5, 0.533333, 0.533333]
	  Origin: [75.0348, 90.125, -137.286]
	  Direction: 
	-0.999859 -0.01105 -0.0126378
	0.0126514 -0.990819 -0.134605
	-0.0110344 -0.134746 0.990819

	  IndexToPointMatrix: 
	-0.49993 -0.00589333 -0.00674016
	0.00632572 -0.528437 -0.0717891
	-0.00551719 -0.0718643 0.528437

	  PointToIndexMatrix: 
	-1.99972 0.0253029 -0.0220688
	-0.0207187 -1.85778 -0.252648
	-0.0236959 -0.252384 1.85779

	  Inverse Direction: 
	-0.999859 0.0126514 -0.0110344
	-0.01105 -0.990819 -0.134746
	-0.0126378 -0.134605 0.990819

	  PixelContainer: 
	    ImportImageContainer (0x556df546b790)
	      RTTI typeinfo:   itk::ImportImageContainer&lt;unsigned long, double&gt;
	      Reference Count: 1
	      Modified Time: 1720
	      Debug: Off
	      Object Name: 
	      Observers: 
	        none
	      Pointer: 0x7fd901c2d010
	      Container manages memory: true
	      Size: 45722880
	      Capacity: 45722880

	     Weighting = 1
	     Sampling strategy = regular
	     Number of bins = 32
	     Radius = 4
	     Sampling percentage  = 0.25
	   Transform = Rigid
	     Gradient step = 0.1
	     Update field sigma (voxel space) = 0
	     Total field sigma (voxel space) = 0
	     Update field time sigma = 0
	     Total field time sigma  = 0
	     Number of time indices = 0
	     Number of time point samples = 0
	Stage 2 State
	   Image metric = Mattes
	     Fixed image = Image (0x556df547a090)
	  RTTI typeinfo:   itk::Image&lt;double, 3u&gt;
	  Reference Count: 2
	  Modified Time: 2157
	  Debug: Off
	  Object Name: 
	  Observers: 
	    none
	  Source: (none)
	  Source output name: (none)
	  Release Data: Off
	  Data Released: False
	  Global Release Data: Off
	  PipelineMTime: 0
	  UpdateMTime: 1940
	  RealTimeStamp: 0 seconds 
	  LargestPossibleRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  BufferedRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  RequestedRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  Spacing: [0.5, 0.533333, 0.533333]
	  Origin: [75.0348, 90.125, -137.286]
	  Direction: 
	-0.999859 -0.01105 -0.0126378
	0.0126514 -0.990819 -0.134605
	-0.0110344 -0.134746 0.990819

	  IndexToPointMatrix: 
	-0.49993 -0.00589333 -0.00674016
	0.00632572 -0.528437 -0.0717891
	-0.00551719 -0.0718643 0.528437

	  PointToIndexMatrix: 
	-1.99972 0.0253029 -0.0220688
	-0.0207187 -1.85778 -0.252648
	-0.0236959 -0.252384 1.85779

	  Inverse Direction: 
	-0.999859 0.0126514 -0.0110344
	-0.01105 -0.990819 -0.134746
	-0.0126378 -0.134605 0.990819

	  PixelContainer: 
	    ImportImageContainer (0x556df547ce90)
	      RTTI typeinfo:   itk::ImportImageContainer&lt;unsigned long, double&gt;
	      Reference Count: 1
	      Modified Time: 1937
	      Debug: Off
	      Object Name: 
	      Observers: 
	        none
	      Pointer: 0x7fd8ebf56010
	      Container manages memory: true
	      Size: 45722880
	      Capacity: 45722880

	     Moving image = Image (0x556df54794d0)
	  RTTI typeinfo:   itk::Image&lt;double, 3u&gt;
	  Reference Count: 2
	  Modified Time: 2158
	  Debug: Off
	  Object Name: 
	  Observers: 
	    none
	  Source: (none)
	  Source output name: (none)
	  Release Data: Off
	  Data Released: False
	  Global Release Data: Off
	  PipelineMTime: 0
	  UpdateMTime: 2155
	  RealTimeStamp: 0 seconds 
	  LargestPossibleRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  BufferedRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  RequestedRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  Spacing: [0.5, 0.533333, 0.533333]
	  Origin: [75.0348, 90.125, -137.286]
	  Direction: 
	-0.999859 -0.01105 -0.0126378
	0.0126514 -0.990819 -0.134605
	-0.0110344 -0.134746 0.990819

	  IndexToPointMatrix: 
	-0.49993 -0.00589333 -0.00674016
	0.00632572 -0.528437 -0.0717891
	-0.00551719 -0.0718643 0.528437

	  PointToIndexMatrix: 
	-1.99972 0.0253029 -0.0220688
	-0.0207187 -1.85778 -0.252648
	-0.0236959 -0.252384 1.85779

	  Inverse Direction: 
	-0.999859 0.0126514 -0.0110344
	-0.01105 -0.990819 -0.134746
	-0.0126378 -0.134605 0.990819

	  PixelContainer: 
	    ImportImageContainer (0x556df547c440)
	      RTTI typeinfo:   itk::ImportImageContainer&lt;unsigned long, double&gt;
	      Reference Count: 1
	      Modified Time: 2152
	      Debug: Off
	      Object Name: 
	      Observers: 
	        none
	      Pointer: 0x7fd8d627f010
	      Container manages memory: true
	      Size: 45722880
	      Capacity: 45722880

	     Weighting = 1
	     Sampling strategy = regular
	     Number of bins = 32
	     Radius = 4
	     Sampling percentage  = 0.25
	   Transform = Affine
	     Gradient step = 0.1
	     Update field sigma (voxel space) = 0
	     Total field sigma (voxel space) = 0
	     Update field time sigma = 0
	     Total field time sigma  = 0
	     Number of time indices = 0
	     Number of time point samples = 0
	Stage 3 State
	   Image metric = Mattes
	     Fixed image = Image (0x556df5481f20)
	  RTTI typeinfo:   itk::Image&lt;double, 3u&gt;
	  Reference Count: 2
	  Modified Time: 2589
	  Debug: Off
	  Object Name: 
	  Observers: 
	    none
	  Source: (none)
	  Source output name: (none)
	  Release Data: Off
	  Data Released: False
	  Global Release Data: Off
	  PipelineMTime: 0
	  UpdateMTime: 2372
	  RealTimeStamp: 0 seconds 
	  LargestPossibleRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  BufferedRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  RequestedRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  Spacing: [0.5, 0.533333, 0.533333]
	  Origin: [75.0348, 90.125, -137.286]
	  Direction: 
	-0.999859 -0.01105 -0.0126378
	0.0126514 -0.990819 -0.134605
	-0.0110344 -0.134746 0.990819

	  IndexToPointMatrix: 
	-0.49993 -0.00589333 -0.00674016
	0.00632572 -0.528437 -0.0717891
	-0.00551719 -0.0718643 0.528437

	  PointToIndexMatrix: 
	-1.99972 0.0253029 -0.0220688
	-0.0207187 -1.85778 -0.252648
	-0.0236959 -0.252384 1.85779

	  Inverse Direction: 
	-0.999859 0.0126514 -0.0110344
	-0.01105 -0.990819 -0.134746
	-0.0126378 -0.134605 0.990819

	  PixelContainer: 
	    ImportImageContainer (0x556df5481e70)
	      RTTI typeinfo:   itk::ImportImageContainer&lt;unsigned long, double&gt;
	      Reference Count: 1
	      Modified Time: 2369
	      Debug: Off
	      Object Name: 
	      Observers: 
	        none
	      Pointer: 0x7fd8c05a8010
	      Container manages memory: true
	      Size: 45722880
	      Capacity: 45722880

	     Moving image = Image (0x556df5480e20)
	  RTTI typeinfo:   itk::Image&lt;double, 3u&gt;
	  Reference Count: 2
	  Modified Time: 2590
	  Debug: Off
	  Object Name: 
	  Observers: 
	    none
	  Source: (none)
	  Source output name: (none)
	  Release Data: Off
	  Data Released: False
	  Global Release Data: Off
	  PipelineMTime: 0
	  UpdateMTime: 2587
	  RealTimeStamp: 0 seconds 
	  LargestPossibleRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  BufferedRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  RequestedRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  Spacing: [0.5, 0.533333, 0.533333]
	  Origin: [75.0348, 90.125, -137.286]
	  Direction: 
	-0.999859 -0.01105 -0.0126378
	0.0126514 -0.990819 -0.134605
	-0.0110344 -0.134746 0.990819

	  IndexToPointMatrix: 
	-0.49993 -0.00589333 -0.00674016
	0.00632572 -0.528437 -0.0717891
	-0.00551719 -0.0718643 0.528437

	  PointToIndexMatrix: 
	-1.99972 0.0253029 -0.0220688
	-0.0207187 -1.85778 -0.252648
	-0.0236959 -0.252384 1.85779

	  Inverse Direction: 
	-0.999859 0.0126514 -0.0110344
	-0.01105 -0.990819 -0.134746
	-0.0126378 -0.134605 0.990819

	  PixelContainer: 
	    ImportImageContainer (0x556df5481870)
	      RTTI typeinfo:   itk::ImportImageContainer&lt;unsigned long, double&gt;
	      Reference Count: 1
	      Modified Time: 2584
	      Debug: Off
	      Object Name: 
	      Observers: 
	        none
	      Pointer: 0x7fd8aa8d1010
	      Container manages memory: true
	      Size: 45722880
	      Capacity: 45722880

	     Weighting = 1
	     Sampling strategy = none
	     Number of bins = 32
	     Radius = 4
	     Sampling percentage  = 1
	   Transform = SyN
	     Gradient step = 0.1
	     Update field sigma (voxel space) = 3
	     Total field sigma (voxel space) = 0
	     Update field time sigma = 0
	     Total field time sigma  = 0
	     Number of time indices = 0
	     Number of time point samples = 0
	Registration using 3 total stages.

	Stage 0
	  iterations = 1000x500x250x0
	  convergence threshold = 1e-06
	  convergence window size = 10
	  number of levels = 4
	  using the Mattes MI metric (number of bins = 32, weight = 1, use gradient filter = 0)
	  preprocessing:  winsorizing the image intensities
	  Shrink factors (level 1 out of 4): [12, 11, 11]
	  Shrink factors (level 2 out of 4): [8, 7, 7]
	  Shrink factors (level 3 out of 4): [4, 4, 4]
	  Shrink factors (level 4 out of 4): [2, 2, 2]
	  smoothing sigmas per level: [4, 3, 2, 1]
	  regular sampling (percentage = 0.25)

	*** Running Euler3DTransform registration ***

	DIAGNOSTIC,Iteration,metricValue,convergenceValue,ITERATION_TIME_INDEX,SINCE_LAST
	 2DIAGNOSTIC,     1, -1.856076122370e+00, 1.797693134862e+308, 1.8046e+00, 1.8046e+00, 
	 2DIAGNOSTIC,     2, -1.856209633867e+00, 1.797693134862e+308, 1.8093e+00, 4.7269e-03, 
	 2DIAGNOSTIC,     3, -1.856241994207e+00, 1.797693134862e+308, 1.8136e+00, 4.2841e-03, 
	 2DIAGNOSTIC,     4, -1.856320017657e+00, 1.797693134862e+308, 1.8203e+00, 6.7010e-03, 
	 2DIAGNOSTIC,     5, -1.856475616263e+00, 1.797693134862e+308, 1.8253e+00, 4.9739e-03, 
	 2DIAGNOSTIC,     6, -1.856478477539e+00, 1.797693134862e+308, 1.8300e+00, 4.7181e-03, 
	 2DIAGNOSTIC,     7, -1.856478664061e+00, 1.797693134862e+308, 1.8346e+00, 4.6780e-03, 
	 2DIAGNOSTIC,     8, -1.856479104095e+00, 1.797693134862e+308, 1.8392e+00, 4.5099e-03, 
	 2DIAGNOSTIC,     9, -1.856479847908e+00, 1.797693134862e+308, 1.8443e+00, 5.1148e-03, 
	 2DIAGNOSTIC,    10, -1.856481274673e+00, 1.668790354979e-05, 1.8561e+00, 1.1789e-02, 
	 2DIAGNOSTIC,    11, -1.856481275992e+00, 1.116714951170e-05, 1.8704e+00, 1.4331e-02, 
	 2DIAGNOSTIC,    12, -1.856481275992e+00, 7.560667877854e-06, 1.8787e+00, 8.2951e-03, 
	 2DIAGNOSTIC,    13, -1.856481275992e+0
0, 4.443291313272e-06, 1.8840e+00, 5.3000e-03, 
	 2DIAGNOSTIC,    14, -1.856481275992e+00, 2.394579000420e-06, 1.8895e+00, 5.5289e-03, 
	 2DIAGNOSTIC,    15, -1.856481275992e+00, 2.194965818200e-06, 1.8946e+00, 5.0879e-03, 
	 2DIAGNOSTIC,    16, -1.856481275992e+00, 2.040941349007e-06, 1.8994e+00, 4.8320e-03, 
	 2DIAGNOSTIC,    17, -1.856481275992e+00, 1.902038389609e-06, 1.9045e+00, 5.0292e-03, 
	 2DIAGNOSTIC,    18, -1.856481275992e+00, 1.779431810296e-06, 1.9094e+00, 4.8950e-03, 
	 2DIAGNOSTIC,    19, -1.856481275992e+00, 1.674268925583e-06, 1.9142e+00, 4.8549e-03, 
	 2DIAGNOSTIC,    20, -1.856481275992e+00, 1.590542924951e-06, 1.9191e+00, 4.9012e-03, 
	 2DIAGNOSTIC,    21, -1.856481275992e+00, 1.514800664182e-06, 1.9242e+00, 5.1279e-03, 
	 2DIAGNOSTIC,    22, -1.856481275992e+00, 1.445944247537e-06, 1.9291e+00, 4.8571e-03, 
	 2DIAGNOSTIC,    23, -1.856481275992e+00, 1.383075498525e-06, 1.9342e+00, 5.0650e-03, 
	 2DIAGNOSTIC,    24, -1.856481275992e+00, 1.325445940309e-06, 1.9390e+00, 4.8299e-03, 
	 2DIAGNOSTIC,    25, -1.856481275992e+00, 1.272426855256e-06, 1.9441e+00, 5.1520e-03, 
	 2DIAGNOSTIC,    26, -1.856481275992e+00, 1.223486253595e-06, 1.9491e+00, 4.9241e-03, 
	 2DIAGNOSTIC,    27, -1.856481275992e+00, 1.178170960681e-06, 1.9539e+00, 4.8039e-03, 
	 2DIAGNOSTIC,    28, -1.856481275992e+00, 1.136092542389e-06, 1.9588e+00, 4.8862e-03, 
	 2DIAGNOSTIC,    29, -1.856481275992e+00, 1.096916142869e-06, 1.9636e+00, 4.8361e-03, 
	 2DIAGNOSTIC,    30, -1.856481275992e+00, 1.060351554512e-06, 1.9684e+00, 4.8008e-03, 
	 2DIAGNOSTIC,    31, -1.856481275992e+00, 1.026146016617e-06, 1.9726e+00, 4.2191e-03, 
	DIAGNOSTIC,Iteration,metricValue,convergenceValue,ITERATION_TIME_INDEX,SINCE_LAST
	 2DIAGNOSTIC,     1, -1.863615117952e+00, 1.797693134862e+308, 3.7298e+00, 1.7572e+00, 
	 2DIAGNOSTIC,     2, -1.863810285029e+00, 1.797693134862e+308, 3.7529e+00, 2.3152e-02, 
	 2DIAGNOSTIC,     3, -1.863872760444e+00, 1.797693134862e+308, 3.7773e+00, 2.4414e-02, 
	 2DIAGNOSTIC,     4, -1.863969949943e+00, 1.797693134862e+308, 3.8042e+00, 2.6898e-02, 
	 2DIAGNOSTIC,     5, -1.863956340689e+00, 1.797693134862e+308, 3.8320e+00, 2.7736e-02, 
	 2DIAGNOSTIC,     6, -1.864055784038e+00, 1.797693134862e+308, 3.8580e+00, 2.6066e-02, 
	 2DIAGNOSTIC,     7, -1.864048123688e+00, 1.797693134862e+308, 3.8810e+00, 2.2970e-02, 
	 2DIAGNOSTIC,     8, -1.864065318589e+00, 1.797693134862e+308, 3.9067e+00, 2.5693e-02, 
	 2DIAGNOSTIC,     9, -1.864010988319e+00, 1.797693134862e+308, 3.9325e+00, 2.5790e-02, 
	 2DIAGNOSTIC,    10, -1.863993040056e+00, 1.448580705013e-05, 3.9555e+00, 2.2982e-02, 
	 2DIAGNOSTIC,    11, -1.864004749451e+00, 8.130812225157e-06, 3.9780e+00, 2.2560e-02, 
	 2DIAGNOSTIC,    12, -1.864042846580e+00, 5.296322466292e-06, 4.0036e+00, 2.5562e-02, 
	 2DIAGNOSTIC,    13, -1.863993153827e+00, 2.778219838212e-06, 4.0300e+00, 2.6404e-02, 
	 2DIAGNOSTIC,    14, -1.863986668647e+00, 1.626162844381e-06, 4.0534e+00, 2.3438e-02, 
	DIAGNOSTIC,Iteration,metricValue,convergenceValue,ITERATION_TIME_INDEX,SINCE_LAST
	 2DIAGNOSTIC,     1, -1.836327747965e+00, 1.797693134862e+308, 6.1434e+00, 2.0900e+00, 
	 2DIAGNOSTIC,     2, -1.836404900895e+00, 1.797693134862e+308, 6.3058e+00, 1.6234e-01, 
	 2DIAGNOSTIC,     3, -1.836454146036e+00, 1.797693134862e+308, 6.5144e+00, 2.0866e-01, 
	 2DIAGNOSTIC,     4, -1.836500686713e+00, 1.797693134862e+308, 6.6863e+00, 1.7187e-01, 
	 2DIAGNOSTIC,     5, -1.836583265633e+00, 1.797693134862e+308, 6.8975e+00, 2.1120e-01, 
	 2DIAGNOSTIC,     6, -1.836586945174e+00, 1.797693134862e+308, 7.0641e+00, 1.6664e-01, 
	 2DIAGNOSTIC,     7, -1.836587136574e+00, 1.797693134862e+308, 7.2319e+00, 1.6774e-01, 
	 2DIAGNOSTIC,     8, -1.836585870437e+00, 1.797693134862e+308, 7.3948e+00, 1.6295e-01, 
	 2DIAGNOSTIC,     9, -1.836582744229e+00, 1.797693134862e+308, 7.5613e+00, 1.6646e-01, 
	 2DIAGNOSTIC,    10, -1.836573957160e+00, 1.146078833289e-05, 7.7655e+00, 2.0425e-01, 
	 2DIAGNOSTIC,    11, -1.836576539851e+00, 7.607292650383e-06, 7.9478e+00, 1.8223e-01, 
	 2DIAGNOSTIC,    12, -1.836574684828e+00, 4.947580816039e-06, 8.0887e+00, 1.4091e-01, 
	 2DIAGNOSTIC,    13, -1.836576936908e+00, 3.099085620753e-06, 8.2307e+00, 1.4201e-01, 
	 2DIAGNOSTIC,    14, -1.836577932194e+00, 1.955744018692e-06, 8.3721e+00, 1.4139e-01, 
	 2DIAGNOSTIC,    15, -1.836578335168e+00, 1.849801922429e-06, 8.5417e+00, 1.6959e-01, 
	 2DIAGNOSTIC,    16, -1.836578710724e+00, 1.820797860305e-06, 8.6861e+00, 1.4442e-01, 
	 2DIAGNOSTIC,    17, -1.836573740824e+00, 1.766012615902e-06, 8.8532e+00, 1.6715e-01, 
	 2DIAGNOSTIC,    18, -1.836579710108e+00, 1.768705354267e-06, 9.3749e+00, 5.2168e-01, 
	 2DIAGNOSTIC,    19, -1.836579710107e+00, 1.745531000324e-06, 9.7866e+00, 4.1167e-01, 
	 2DIAGNOSTIC,    20, -1.836579710107e+00, 1.649432975863e-06, 9.9517e+00, 1.6513e-01, 
	 2DIAGNOSTIC,    21, -1.836579710107e+00, 1.577540606659e-06, 1.0115e+01, 1.6350e-01, 
	 2DIAGNOSTIC,    22, -1.836579710107e+00, 1.493373465139e-06, 1.0300e+01, 1.8463e-01, 
	 2DIAGNOSTIC,    23, -1.836579710107e+00, 1.426569318667e-06, 1.0474e+01, 1.7426e-01, 
	 2DIAGNOSTIC,    24, -1.836579710107e+00, 1.366958626986e-06, 1.0643e+01, 1.6933e-01, 
	 2DIAGNOSTIC,    25, -1.836579710107e+00, 1.310876939990e-06, 1.0834e+01, 1.9034e-01, 
	 2DIAGNOSTIC,    26, -1.836579710107e+00, 1.259003894347e-06, 1.1024e+01, 1.9062e-01, 
	 2DIAGNOSTIC,    27, -1.836579710107e+00, 1.178160277775e-06, 1.1240e+01, 2.1528e-01, 
	 2DIAGNOSTIC,    28, -1.836579710107e+00, 1.136082611417e-06, 1.1406e+01, 1.6647e-01, 
	 2DIAGNOSTIC,    29, -1.836579710107e+00, 1.096906884997e-06, 1.1614e+01, 2.0826e-01, 
	 2DIAGNOSTIC,    30, -1.836579710107e+00, 1.060342903564e-06, 1.1777e+01, 1.6304e-01, 
	 2DIAGNOSTIC,    31, -1.836579710107e+00, 1.026137914806e-06, 1.1943e+01, 1.6515e-01, 
	DIAGNOSTIC,Iteration,metricValue,convergenceValue,ITERATION_TIME_INDEX,SINCE_LAST
	 2DIAGNOSTIC,     1, -1.823902726136e+00, 1.797693134862e+308, 1.5991e+01, 4.0483e+00, 
	  Elapsed time (stage 0): 1.7541e+01


	Stage 1
	  iterations = 1000x500x250x0
	  convergence threshold = 1.0000e-06
	  convergence window size = 10
	  number of levels = 4
	  using the Mattes MI metric (number of bins = 32, weight = 1.0000e+00, use gradient filter = 0)
	  preprocessing:  winsorizing the image intensities
	  Shrink factors (level 1 out of 4): [12, 11, 11]
	  Shrink factors (level 2 out of 4): [8, 7, 7]
	  Shrink factors (level 3 out of 4): [4, 4, 4]
	  Shrink factors (level 4 out of 4): [2, 2, 2]
	  smoothing sigmas per level: [4, 3, 2, 1]
	  regular sampling (percentage = 2.5000e-01)

	*** Running AffineTransform registration ***

	DIAGNOSTIC,Iteration,metricValue,convergenceValue,ITERATION_TIME_INDEX,SINCE_LAST
	 2DIAGNOSTIC,     1, -1.856768032214e+00, 1.797693134862e+308, 1.7778e+00, 1.7778e+00, 
	 2DIAGNOSTIC,     2, -1.856855903064e+00, 1.797693134862e+308, 1.7834e+00, 5.6660e-03, 
	 2DIAGNOSTIC,     3, -1.856879156333e+00, 1.797693134862e+308, 1.7891e+00, 5.6438e-03, 
	 2DIAGNOSTIC,     4, -1.856925032918e+00, 1.797693134862e+308, 1.7945e+00, 5.4641e-03, 
	 2DIAGNOSTIC,     5, -1.856939915771e+00, 1.797693134862e+308, 1.7993e+00, 4.7162e-03, 
	 2DIAGNOSTIC,     6, -1.856948036259e+00, 1.797693134862e+308, 1.8045e+00, 5.2249e-03, 
	 2DIAGNOSTIC,     7, -1.856955416794e+00, 1.797693134862e+308, 1.8099e+00, 5.3842e-03, 
	 2DIAGNOSTIC,     8, -1.856958229336e+00, 1.797693134862e+308, 1.8146e+00, 4.7278e-03, 
	 2DIAGNOSTIC,     9, -1.856960098742e+00, 1.797693134862e+308, 1.8205e+00, 5.9350e-03, 
	 2DIAGNOSTIC,    10, -1.856960541761e+00, 8.608086576309e-06, 1.8255e+00, 5.0011e-03, 
	 2DIAGNOSTIC,    11, -1.856960995410e+00, 5.821843580667e-06, 1.8305e+00, 4.9591e-03, 
	 2DIAGNOSTIC,    12, -1.856962097046e+00, 4.371899720121e-06, 1.8381e+00, 7.6001e-03, 
	 2DIAGNOSTIC,    13, -1.856962138712e+00, 3.250888669523e-06, 1.8432e+00, 5.1100e-03, 
	 2DIAGNOSTIC,    14, -1.856962164062e+00, 2.716280277468e-06, 1.8489e+00, 5.7051e-03, 
	 2DIAGNOSTIC,    15, -1.856962195164e+00, 2.363601541835e-06, 1.8550e+00, 6.0961e-03, 
	 2DIAGNOSTIC,    16, -1.856962218572e+00, 2.109100299533e-06, 1.8598e+00, 4.8301e-03, 
	 2DIAGNOSTIC,    17, -1.856962273297e+00, 1.939705725908e-06, 1.8647e+00, 4.9000e-03, 
	 2DIAGNOSTIC,    18, -1.856962286634e+00, 1.806436602705e-06, 1.8696e+00, 4.8499e-03, 
	 2DIAGNOSTIC,    19, -1.856962291913e+00, 1.698751575047e-06, 1.8777e+00, 8.0740e-03, 
	 2DIAGNOSTIC,    20, -1.856962293071e+00, 1.602964343220e-06, 1.8827e+00, 4.9899e-03, 
	 2DIAGNOSTIC,    21, -1.856962295902e+00, 1.518240121325e-06, 1.8875e+00, 4.8521e-03, 
	 2DIAGNOSTIC,    22, -1.856962300619e+00, 1.448581750989e-06, 1.8923e+00, 4.8308e-03, 
	 2DIAGNOSTIC,    23, -1.856962307337e+00, 1.385050500700e-06, 1.8972e+00, 4.8401e-03, 
	 2DIAGNOSTIC,    24, -1.856962315114e+00, 1.326838152058e-06, 1.9022e+00, 5.0662e-03, 
	 2DIAGNOSTIC,    25, -1.856962323455e+00, 1.273392407741e-06, 1.9072e+00, 4.9970e-03, 
	 2DIAGNOSTIC,    26, -1.856962327808e+00, 1.224120526437e-06, 1.9128e+00, 5.6069e-03, 
	 2DIAGNOSTIC,    27, -1.856962329585e+00, 1.178755748482e-06, 1.9284e+00, 1.5531e-02, 
	 2DIAGNOSTIC,    28, -1.856962329585e+00, 1.136647089311e-06, 1.9393e+00, 1.0939e-02, 
	 2DIAGNOSTIC,    29, -1.856962329585e+00, 1.097416623970e-06, 1.9460e+00, 6.7210e-03, 
	 2DIAGNOSTIC,    30, -1.856962329585e+00, 1.060758573604e-06, 1.9520e+00, 5.9681e-03, 
	 2DIAGNOSTIC,    31, -1.856962329585e+00, 1.026439725348e-06, 1.9575e+00, 5.5120e-03, 
	DIAGNOSTIC,Iteration,metricValue,convergenceValue,ITERATION_TIME_INDEX,SINCE_LAST
	 2DIAGNOSTIC,     1, -1.852116372469e+00, 1.797693134862e+308, 3.7078e+00, 1.7503e+00, 
	 2DIAGNOSTIC,     2, -1.852379372870e+00, 1.797693134862e+308, 3.7469e+00, 3.9103e-02, 
	 2DIAGNOSTIC,     3, -1.852393981397e+00, 1.797693134862e+308, 3.7716e+00, 2.4677e-02, 
	 2DIAGNOSTIC,     4, -1.852338247132e+00, 1.797693134862e+308, 3.7995e+00, 2.7866e-02, 
	 2DIAGNOSTIC,     5, -1.852403424390e+00, 1.797693134862e+308, 3.8238e+00, 2.4355e-02, 
	 2DIAGNOSTIC,     6, -1.852398723316e+00, 1.797693134862e+308, 3.8484e+00, 2.4607e-02, 
	 2DIAGNOSTIC,     7, -1.852346727732e+00, 1.797693134862e+308, 3.8760e+00, 2.7537e-02, 
	 2DIAGNOSTIC,     8, -1.852340826214e+00, 1.797693134862e+308, 3.9005e+00, 2.4587e-02, 
	 2DIAGNOSTIC,     9, -1.852268049660e+00, 1.797693134862e+308, 3.9282e+00, 2.7641e-02, 
	 2DIAGNOSTIC,    10, -1.852253677701e+00, 3.271782214528e-06, 3.9629e+00, 3.4704e-02, 
	DIAGNOSTIC,Iteration,metricValue,convergenceValue,ITERATION_TIME_INDEX,SINCE_LAST
	 2DIAGNOSTIC,     1, -1.837274523709e+00, 1.797693134862e+308, 5.9899e+00, 2.0270e+00, 
	 2DIAGNOSTIC,     2, -1.837371088800e+00, 1.797693134862e+308, 6.1537e+00, 1.6382e-01, 
	 2DIAGNOSTIC,     3, -1.837425272342e+00, 1.797693134862e+308, 6.3299e+00, 1.7619e-01, 
	 2DIAGNOSTIC,     4, -1.837464436088e+00, 1.797693134862e+308, 6.5476e+00, 2.1778e-01, 
	 2DIAGNOSTIC,     5, -1.837480575488e+00, 1.797693134862e+308, 6.7170e+00, 1.6932e-01, 
	 2DIAGNOSTIC,     6, -1.837476366378e+00, 1.797693134862e+308, 6.9258e+00, 2.0883e-01, 
	 2DIAGNOSTIC,     7, -1.837482120636e+00, 1.797693134862e+308, 7.0916e+00, 1.6577e-01, 
	 2DIAGNOSTIC,     8, -1.837488695683e+00, 1.797693134862e+308, 7.2659e+00, 1.7438e-01, 
	 2DIAGNOSTIC,     9, -1.837494591835e+00, 1.797693134862e+308, 7.4226e+00, 1.5665e-01, 
	 2DIAGNOSTIC,    10, -1.837491999772e+00, 9.019438172830e-06, 7.5973e+00, 1.7470e-01, 
	 2DIAGNOSTIC,    11, -1.837495852518e+00, 5.830299165899e-06, 7.7966e+00, 1.9933e-01, 
	 2DIAGNOSTIC,    12, -1.837496424966e+00, 4.148798101400e-06, 7.9997e+00, 2.0311e-01, 
	 2DIAGNOSTIC,    13, -1.837496433880e+00, 3.221685490523e-06, 8.1949e+00, 1.9514e-01, 
	 2DIAGNOSTIC,    14, -1.837496434870e+00, 2.784222072089e-06, 8.3690e+00, 1.7412e-01, 
	 2DIAGNOSTIC,    15, -1.837496435153e+00, 2.528005278141e-06, 8.5663e+00, 1.9735e-01, 
	 2DIAGNOSTIC,    16, -1.837496435242e+00, 2.225323639277e-06, 8.7680e+00, 2.0168e-01, 
	 2DIAGNOSTIC,    17, -1.837496435265e+00, 1.987100349217e-06, 8.9695e+00, 2.0149e-01, 
	 2DIAGNOSTIC,    18, -1.837496435273e+00, 1.819938357385e-06, 9.1663e+00, 1.9675e-01, 
	 2DIAGNOSTIC,    19, -1.837496435274e+00, 1.714548077070e-06, 9.3661e+00, 1.9987e-01, 
	 2DIAGNOSTIC,    20, -1.837496435275e+00, 1.595104075554e-06, 9.5636e+00, 1.9747e-01, 
	 2DIAGNOSTIC,    21, -1.837496435275e+00, 1.514865889410e-06, 9.7587e+00, 1.9511e-01, 
	 2DIAGNOSTIC,    22, -1.837496435275e+00, 1.445937022171e-06, 9.9881e+00, 2.2940e-01, 
	 2DIAGNOSTIC,    23, -1.837496435275e+00, 1.383060609490e-06, 1.0226e+01, 2.3838e-01, 
	 2DIAGNOSTIC,    24, -1.837496435275e+00, 1.325429956747e-06, 1.0405e+01, 1.7824e-01, 
	 2DIAGNOSTIC,    25, -1.837496435275e+00, 1.272411450266e-06, 1.0601e+01, 1.9627e-01, 
	 2DIAGNOSTIC,    26, -1.837496435275e+00, 1.223471835302e-06, 1.0776e+01, 1.7548e-01, 
	 2DIAGNOSTIC,    27, -1.837496435275e+00, 1.178157542338e-06, 1.0956e+01, 1.7923e-01, 
	 2DIAGNOSTIC,    28, -1.837496435275e+00, 1.136080056877e-06, 1.1157e+01, 2.0119e-01, 
	 2DIAGNOSTIC,    29, -1.837496435275e+00, 1.096904501445e-06, 1.1331e+01, 1.7403e-01, 
	 2DIAGNOSTIC,    30, -1.837496435275e+00, 1.060340675700e-06, 1.1508e+01, 1.7679e-01, 
	 2DIAGNOSTIC,    31, -1.837496435275e+00, 1.026135828218e-06, 1.1684e+01, 1.7639e-01, 
	DIAGNOSTIC,Iteration,metricValue,convergenceValue,ITERATION_TIME_INDEX,SINCE_LAST
	 2DIAGNOSTIC,     1, -1.823685140995e+00, 1.797693134862e+308, 1.5723e+01, 4.0394e+00, 
	  Elapsed time (stage 1): 1.7201e+01


	Stage 2
	  iterations = 100x100x70x50x0
	  convergence threshold = 1.0000e-06
	  convergence window size = 10
	  number of levels = 5
	  using the Mattes MI metric (number of bins = 32, weight = 1.0000e+00, use gradient filter = 0)
	  preprocessing:  winsorizing the image intensities
	  Shrink factors (level 1 out of 5): [10, 9, 9]
	  Shrink factors (level 2 out of 5): [6, 6, 6]
	  Shrink factors (level 3 out of 5): [4, 4, 4]
	  Shrink factors (level 4 out of 5): [2, 2, 2]
	  Shrink factors (level 5 out of 5): [1, 1, 1]
	  smoothing sigmas per level: [5, 3, 2, 1, 0]
	  Using default NONE metricSamplingStrategy 

	*** Running SyN registration (varianceForUpdateField = 3.0000e+00, varianceForTotalField = 0.0000e+00) ***

	XXDIAGNOSTIC,Iteration,metricValue,convergenceValue,ITERATION_TIME_INDEX,SINCE_LAST
	 1DIAGNOSTIC,     1, -1.945321621585e+00, 1.797693134862e+308, 1.5909e+00, 1.5909e+00, 
	 1DIAGNOSTIC,     2, -1.939617687221e+00, 1.797693134862e+308, 1.6517e+00, 6.0847e-02, 
	 1DIAGNOSTIC,     3, -1.933834885214e+00, 1.797693134862e+308, 1.7103e+00, 5.8560e-02, 
	 1DIAGNOSTIC,     4, -1.935127102290e+00, 1.797693134862e+308, 1.7686e+00, 5.8375e-02, 
	 1DIAGNOSTIC,     5, -1.930658870057e+00, 1.797693134862e+308, 1.8274e+00, 5.8794e-02, 
	 1DIAGNOSTIC,     6, -1.932995628010e+00, 1.797693134862e+308, 1.8875e+00, 6.0110e-02, 
	 1DIAGNOSTIC,     7, -1.927868993508e+00, 1.797693134862e+308, 1.9456e+00, 5.8024e-02, 
	 1DIAGNOSTIC,     8, -1.930765956268e+00, 1.797693134862e+308, 2.0040e+00, 5.8485e-02, 
	 1DIAGNOSTIC,     9, -1.925748978954e+00, 1.797693134862e+308, 2.0619e+00, 5.7825e-02, 
	 1DIAGNOSTIC,    10, -1.928588711861e+00, -4.967670168242e-04, 2.1212e+00, 5.9285e-02, 
	XXDIAGNOSTIC,Iteration,metricValue,convergenceValue,ITERATION_TIME_INDEX,SINCE_LAST
	 1DIAGNOSTIC,     1, -1.852633983819e+00, 1.797693134862e+308, 3.9707e+00, 1.8496e+00, 
	 1DIAGNOSTIC,     2, -1.861697890609e+00, 1.797693134862e+308, 4.1817e+00, 2.1096e-01, 
	 1DIAGNOSTIC,     3, -1.858786403997e+00, 1.797693134862e+308, 4.4028e+00, 2.2112e-01, 
	 1DIAGNOSTIC,     4, -1.859778353050e+00, 1.797693134862e+308, 4.6138e+00, 2.1096e-01, 
	 1DIAGNOSTIC,     5, -1.856671481765e+00, 1.797693134862e+308, 4.8282e+00, 2.1445e-01, 
	 1DIAGNOSTIC,     6, -1.858347471299e+00, 1.797693134862e+308, 5.0394e+00, 2.1117e-01, 
	 1DIAGNOSTIC,     7, -1.855304140489e+00, 1.797693134862e+308, 5.2551e+00, 2.1571e-01, 
	 1DIAGNOSTIC,     8, -1.857043569234e+00, 1.797693134862e+308, 5.4660e+00, 2.1089e-01, 
	 1DIAGNOSTIC,     9, -1.854080594830e+00, 1.797693134862e+308, 5.7030e+00, 2.3701e-01, 
	 1DIAGNOSTIC,    10, -1.855860220738e+00, -9.572570541815e-05, 5.9492e+00, 2.4620e-01, 
	XXDIAGNOSTIC,Iteration,metricValue,convergenceValue,ITERATION_TIME_INDEX,SINCE_LAST
	 1DIAGNOSTIC,     1, -1.840442450328e+00, 1.797693134862e+308, 8.2722e+00, 2.3230e+00, 
	 1DIAGNOSTIC,     2, -1.844848812529e+00, 1.797693134862e+308, 9.0073e+00, 7.3515e-01, 
	 1DIAGNOSTIC,     3, -1.840921834484e+00, 1.797693134862e+308, 9.7290e+00, 7.2171e-01, 
	 1DIAGNOSTIC,     4, -1.841981279235e+00, 1.797693134862e+308, 1.0403e+01, 6.7400e-01, 
	 1DIAGNOSTIC,     5, -1.840554051486e+00, 1.797693134862e+308, 1.1074e+01, 6.7094e-01, 
	 1DIAGNOSTIC,     6, -1.840789560713e+00, 1.797693134862e+308, 1.1781e+01, 7.0669e-01, 
	 1DIAGNOSTIC,     7, -1.839509258774e+00, 1.797693134862e+308, 1.2515e+01, 7.3450e-01, 
	 1DIAGNOSTIC,     8, -1.839987251090e+00, 1.797693134862e+308, 1.3200e+01, 6.8511e-01, 
	 1DIAGNOSTIC,     9, -1.838332403139e+00, 1.797693134862e+308, 1.3879e+01, 6.7875e-01, 
	 1DIAGNOSTIC,    10, -1.839154290715e+00, -1.319474691041e-04, 1.4557e+01, 6.7789e-01, 
	XXDIAGNOSTIC,Iteration,metricValue,convergenceValue,ITERATION_TIME_INDEX,SINCE_LAST
	 1DIAGNOSTIC,     1, -1.807350863311e+00, 1.797693134862e+308, 2.2239e+01, 7.6819e+00, 
	 1DIAGNOSTIC,     2, -1.809365869390e+00, 1.797693134862e+308, 2.8073e+01, 5.8338e+00, 
	 1DIAGNOSTIC,     3, -1.808453749543e+00, 1.797693134862e+308, 3.3773e+01, 5.7005e+00, 
	 1DIAGNOSTIC,     4, -1.808598464488e+00, 1.797693134862e+308, 3.9420e+01, 5.6466e+00, 
	 1DIAGNOSTIC,     5, -1.807471148802e+00, 1.797693134862e+308, 4.5025e+01, 5.6052e+00, 
	 1DIAGNOSTIC,     6, -1.807318718921e+00, 1.797693134862e+308, 5.0672e+01, 5.6473e+00, 
	 1DIAGNOSTIC,     7, -1.806622352495e+00, 1.797693134862e+308, 5.6341e+01, 5.6688e+00, 
	 1DIAGNOSTIC,     8, -1.806589671570e+00, 1.797693134862e+308, 6.1920e+01, 5.5786e+00, 
	 1DIAGNOSTIC,     9, -1.806273000154e+00, 1.797693134862e+308, 6.7618e+01, 5.6981e+00, 
	 1DIAGNOSTIC,    10, -1.806195098337e+00, -9.295926050681e-05, 7.3323e+01, 5.7050e+00, 
	 Registration finished. The antsRegistration call was:
	--------------------------------------------------------------------------------------
	/opt/ants-2.4.3/bin/antsRegistration --verbose 1 --dimensionality 3 --float 0 --collapse-output-transforms 1 --output [ sub-2_ses-20170705_acq-acqmp2ragehighres0p5isoslab_T1w_,sub-2_ses-20170705_acq-acqmp2ragehighres0p5isoslab_T1w_Warped.nii.gz,sub-2_ses-20170705_acq-acqmp2ragehighres0p5isoslab_T1w_InverseWarped.nii.gz ] --interpolation Linear --use-histogram-matching 0 --winsorize-image-intensities [ 0.005,0.995 ] --initial-moving-transform [ /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-2/ses-20170705/anat/sub-2_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,/home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-2/ses-20170705/anat/sub-2_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,1 ] --transform Rigid[ 0.1 ] --metric MI[ /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-2/ses-20170705/anat/sub-2_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,/home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-2/ses-20170705/anat/sub-2_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,1,32,Regular,0.25 ] --convergence [ 1000x500x250x0,1e-6,10 ] --shrink-factors 12x8x4x2 --smoothing-sigmas 4x3x2x1vox --transform Affine[ 0.1 ] --metric MI[ /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-2/ses-20170705/anat/sub-2_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,/home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-2/ses-20170705/anat/sub-2_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,1,32,Regular,0.25 ] --convergence [ 1000x500x250x0,1e-6,10 ] --shrink-factors 12x8x4x2 --smoothing-sigmas 4x3x2x1vox --transform SyN[ 0.1,3,0 ] --metric MI[ /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-2/ses-20170705/anat/sub-2_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,/home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-2/ses-20170705/anat/sub-2_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,1,32] --convergence [ 100x100x70x50x0,1e-6,10 ] --shrink-factors 10x6x4x2x1 --smoothing-sigmas 5x3x2x1x0vox
	--------------------------------------------------------------------------------------
	Moving image resampled into fixed space: sub-2_ses-20170705_acq-acqmp2ragehighres0p5isoslab_T1w_Warped.nii.gz
	Fixed image resampled into moving space: sub-2_ses-20170705_acq-acqmp2ragehighres0p5isoslab_T1w_InverseWarped.nii.gz
	--------------------------------------------------------------------------------------
Stderr:
	/opt/ants-2.4.3/bin/antsRegistrationSyNQuick.sh: line 679:  6463 Killed                  $COMMAND
Traceback:
	Traceback (most recent call last):
	  File &quot;/opt/miniconda-4.12.0/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 453, in aggregate_outputs
	    setattr(outputs, key, val)
	  File &quot;/opt/miniconda-4.12.0/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 330, in validate
	    value = super(File, self).validate(objekt, name, value, return_pathlike=True)
	  File &quot;/opt/miniconda-4.12.0/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 135, in validate
	    self.error(objekt, name, str(value))
	  File &quot;/opt/miniconda-4.12.0/lib/python3.8/site-packages/traits/base_trait_handler.py&quot;, line 74, in error
	    raise TraitError(
	traits.trait_errors.TraitError: The &#39;inverse_warp_field&#39; trait of a RegistrationSynQuickOutputSpec instance must be a pathlike object or string representing an existing file, but a value of &#39;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-2/ses-20170705/qsm_acq-acqmp2ragehighres0p5isoslab_T1w/ants_register-t1-to-qsm/sub-2_ses-20170705_acq-acqmp2ragehighres0p5isoslab_T1w_1InverseWarp.nii.gz&#39; &lt;class &#39;str&#39;&gt; was specified.

	During handling of the above exception, another exception occurred:

	Traceback (most recent call last):
	  File &quot;/opt/miniconda-4.12.0/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 400, in run
	    outputs = self.aggregate_outputs(runtime)
	  File &quot;/opt/miniconda-4.12.0/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 460, in aggregate_outputs
	    raise FileNotFoundError(msg)
	FileNotFoundError: No such file or directory &#39;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-2/ses-20170705/qsm_acq-acqmp2ragehighres0p5isoslab_T1w/ants_register-t1-to-qsm/sub-2_ses-20170705_acq-acqmp2ragehighres0p5isoslab_T1w_1InverseWarp.nii.gz&#39; for output &#39;inverse_warp_field&#39; of a RegistrationSynQuick interface


260222-03:21:18,266 nipype.workflow INFO:
	 [MultiProc] Running 0 tasks, and 13 jobs ready. Free memory (GB): 14.06/14.06, Free processors: 4/4.
260222-03:21:18,315 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.func_read-json-me&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-2/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/func_read-json-me&quot;.
260222-03:21:18,316 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.func_read-json-se&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-2/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/func_read-json-se&quot;.
260222-03:21:18,316 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_as-canonical&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-2/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/nibabel_as-canonical&quot;.
260222-03:21:18,333 nipype.workflow INFO:
	 [Node] Executing &quot;nibabel_as-canonical&quot; &lt;nipype.interfaces.utility.wrappers.Function&gt;
260222-03:21:18,353 nipype.workflow INFO:
	 [Node] Finished &quot;nibabel_as-canonical&quot;, elapsed time 0.019014s.
260222-03:21:18,316 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_read-nii&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-2/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/nibabel_read-nii&quot;.
260222-03:21:18,368 nipype.workflow INFO:
	 [Node] Executing &quot;nibabel_read-nii&quot; &lt;nipype.interfaces.utility.wrappers.Function&gt;
260222-03:21:18,370 nipype.workflow INFO:
	 [Node] Finished &quot;nibabel_read-nii&quot;, elapsed time 0.001443s.
260222-03:21:18,333 nipype.workflow INFO:
	 [Node] Executing &quot;func_read-json-me&quot; &lt;nipype.interfaces.utility.wrappers.Function&gt;
260222-03:21:18,385 nipype.workflow INFO:
	 [Node] Finished &quot;func_read-json-me&quot;, elapsed time 0.000741s.
260222-03:21:18,333 nipype.workflow INFO:
	 [Node] Executing &quot;func_read-json-se&quot; &lt;nipype.interfaces.utility.wrappers.Function&gt;
260222-03:21:18,435 nipype.workflow INFO:
	 [Node] Finished &quot;func_read-json-se&quot;, elapsed time 0.000545s.
260222-03:21:20,247 nipype.workflow INFO:
	 [Job 18] Completed (qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.func_read-json-me).
260222-03:21:20,248 nipype.workflow INFO:
	 [Job 19] Completed (qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.func_read-json-se).
260222-03:21:20,249 nipype.workflow INFO:
	 [Job 20] Completed (qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_read-nii).
260222-03:21:20,250 nipype.workflow INFO:
	 [Job 21] Completed (qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_as-canonical).
260222-03:21:20,251 nipype.workflow INFO:
	 [MultiProc] Running 0 tasks, and 11 jobs ready. Free memory (GB): 14.06/14.06, Free processors: 4/4.
260222-03:21:20,293 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.fastsurfer_segment-t1&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-2/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/fastsurfer_segment-t1&quot;.
260222-03:21:20,295 nipype.workflow INFO:
	 [Node] Executing &quot;fastsurfer_segment-t1&quot; &lt;qsmxt.interfaces.nipype_interface_fastsurfer.FastSurferInterface&gt;
260222-03:21:22,250 nipype.workflow INFO:
	 [MultiProc] Running 1 tasks, and 10 jobs ready. Free memory (GB): 2.06/14.06, Free processors: 0/4.
                     Currently running:
                       * qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.fastsurfer_segment-t1
260222-03:28:16,917 nipype.workflow INFO:
	 [Node] Finished &quot;fastsurfer_segment-t1&quot;, elapsed time 416.621444s.
260222-03:28:18,659 nipype.workflow INFO:
	 [Job 22] Completed (qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.fastsurfer_segment-t1).
260222-03:28:18,660 nipype.workflow INFO:
	 [MultiProc] Running 0 tasks, and 11 jobs ready. Free memory (GB): 14.06/14.06, Free processors: 4/4.
260222-03:28:18,706 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.ants_register-t1-to-qsm&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-2/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/ants_register-t1-to-qsm&quot;.
260222-03:28:18,708 nipype.workflow INFO:
	 [Node] Executing &quot;ants_register-t1-to-qsm&quot; &lt;nipype.interfaces.ants.registration.RegistrationSynQuick&gt;
260222-03:28:20,664 nipype.workflow INFO:
	 [MultiProc] Running 1 tasks, and 10 jobs ready. Free memory (GB): 6.06/14.06, Free processors: 0/4.
                     Currently running:
                       * qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.ants_register-t1-to-qsm
260222-03:30:08,526 nipype.workflow INFO:
	 [Node] Finished &quot;ants_register-t1-to-qsm&quot;, elapsed time 109.81749s.
260222-03:30:08,811 nipype.workflow INFO:
	 [Job 23] Completed (qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.ants_register-t1-to-qsm).
260222-03:30:08,812 nipype.workflow INFO:
	 [MultiProc] Running 0 tasks, and 10 jobs ready. Free memory (GB): 14.06/14.06, Free processors: 4/4.
260222-03:30:08,855 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.func_getfirst-canonical-magnitude&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-1/ses-20170705/qsm_acq-acqmp2ragehighres0p5isoslab_T1w/func_getfirst-canonical-magnitude&quot;.
260222-03:30:08,856 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_numpy_scale-phase&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-1/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/nibabel_numpy_scale-phase&quot;.
260222-03:30:08,856 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.func_getfirst-canonical-magnitude&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-1/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/func_getfirst-canonical-magnitude&quot;.
260222-03:30:08,858 nipype.workflow INFO:
	 [Node] Executing &quot;nibabel_numpy_scale-phase&quot; &lt;qsmxt.interfaces.nipype_interface_processphase.ScalePhaseInterface&gt;
260222-03:30:08,858 nipype.workflow INFO:
	 [Node] Executing &quot;func_getfirst-canonical-magnitude&quot; &lt;nipype.interfaces.utility.wrappers.Function&gt;
260222-03:30:08,858 nipype.workflow INFO:
	 [Node] Executing &quot;func_getfirst-canonical-magnitude&quot; &lt;nipype.interfaces.utility.wrappers.Function&gt;
260222-03:30:08,859 nipype.workflow INFO:
	 [Node] Finished &quot;func_getfirst-canonical-magnitude&quot;, elapsed time 0.000301s.
260222-03:30:08,860 nipype.workflow INFO:
	 [Node] Finished &quot;func_getfirst-canonical-magnitude&quot;, elapsed time 0.000326s.
260222-03:30:08,855 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.numpy_numpy_nibabel_mgz2nii&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-1/ses-20170705/qsm_acq-acqmp2ragehighres0p5isoslab_T1w/numpy_numpy_nibabel_mgz2nii&quot;.
260222-03:30:08,908 nipype.workflow INFO:
	 [Node] Executing &quot;numpy_numpy_nibabel_mgz2nii&quot; &lt;qsmxt.interfaces.nipype_interface_mgz2nii.Mgz2NiiInterface&gt;
260222-03:30:09,60 nipype.workflow INFO:
	 [Node] Finished &quot;numpy_numpy_nibabel_mgz2nii&quot;, elapsed time 0.151014s.
260222-03:30:09,137 nipype.workflow INFO:
	 [Node] Finished &quot;nibabel_numpy_scale-phase&quot;, elapsed time 0.278535s.
260222-03:30:10,813 nipype.workflow INFO:
	 [Job 24] Completed (qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.func_getfirst-canonical-magnitude).
260222-03:30:10,814 nipype.workflow INFO:
	 [Job 25] Completed (qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.numpy_numpy_nibabel_mgz2nii).
260222-03:30:10,814 nipype.workflow INFO:
	 [Job 26] Completed (qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_numpy_scale-phase).
260222-03:30:10,815 nipype.workflow INFO:
	 [Job 27] Completed (qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.func_getfirst-canonical-magnitude).
260222-03:30:10,816 nipype.workflow INFO:
	 [MultiProc] Running 0 tasks, and 8 jobs ready. Free memory (GB): 14.06/14.06, Free processors: 4/4.
260222-03:30:10,850 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.numpy_numpy_nibabel_mgz2nii&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-1/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/numpy_numpy_nibabel_mgz2nii&quot;.
260222-03:30:10,851 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.numpy_numpy_nibabel_mgz2nii&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-2/ses-20170705/qsm_acq-acqmp2ragehighres0p5isoslab_T1w/numpy_numpy_nibabel_mgz2nii&quot;.
260222-03:30:10,851 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_numpy_scale-phase&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-2/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/nibabel_numpy_scale-phase&quot;.
260222-03:30:10,853 nipype.workflow INFO:
	 [Node] Executing &quot;numpy_numpy_nibabel_mgz2nii&quot; &lt;qsmxt.interfaces.nipype_interface_mgz2nii.Mgz2NiiInterface&gt;
260222-03:30:10,854 nipype.workflow INFO:
	 [Node] Executing &quot;numpy_numpy_nibabel_mgz2nii&quot; &lt;qsmxt.interfaces.nipype_interface_mgz2nii.Mgz2NiiInterface&gt;
260222-03:30:10,851 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.func_getfirst-canonical-magnitude&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-2/ses-20170705/qsm_acq-acqmp2ragehighres0p5isoslab_T1w/func_getfirst-canonical-magnitude&quot;.
260222-03:30:10,853 nipype.workflow INFO:
	 [Node] Executing &quot;nibabel_numpy_scale-phase&quot; &lt;qsmxt.interfaces.nipype_interface_processphase.ScalePhaseInterface&gt;
260222-03:30:10,905 nipype.workflow INFO:
	 [Node] Executing &quot;func_getfirst-canonical-magnitude&quot; &lt;nipype.interfaces.utility.wrappers.Function&gt;
260222-03:30:10,906 nipype.workflow INFO:
	 [Node] Finished &quot;func_getfirst-canonical-magnitude&quot;, elapsed time 0.000339s.
260222-03:30:11,13 nipype.workflow INFO:
	 [Node] Finished &quot;numpy_numpy_nibabel_mgz2nii&quot;, elapsed time 0.158647s.
260222-03:30:11,33 nipype.workflow INFO:
	 [Node] Finished &quot;numpy_numpy_nibabel_mgz2nii&quot;, elapsed time 0.178908s.
260222-03:30:11,209 nipype.workflow INFO:
	 [Node] Finished &quot;nibabel_numpy_scale-phase&quot;, elapsed time 0.305032s.
260222-03:30:12,815 nipype.workflow INFO:
	 [Job 28] Completed (qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.numpy_numpy_nibabel_mgz2nii).
260222-03:30:12,816 nipype.workflow INFO:
	 [Job 29] Completed (qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.func_getfirst-canonical-magnitude).
260222-03:30:12,816 nipype.workflow INFO:
	 [Job 30] Completed (qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.numpy_numpy_nibabel_mgz2nii).
260222-03:30:12,817 nipype.workflow INFO:
	 [Job 31] Completed (qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_numpy_scale-phase).
260222-03:30:12,818 nipype.workflow INFO:
	 [MultiProc] Running 0 tasks, and 8 jobs ready. Free memory (GB): 14.06/14.06, Free processors: 4/4.
260222-03:30:12,853 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.func_getfirst-canonical-magnitude&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-2/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/func_getfirst-canonical-magnitude&quot;.
260222-03:30:12,853 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.nibabel_numpy_nilearn_t1w-seg-resampled&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-1/ses-20170705/qsm_acq-acqmp2ragehighres0p5isoslab_T1w/nibabel_numpy_nilearn_t1w-seg-resampled&quot;.
260222-03:30:12,855 nipype.workflow INFO:
	 [Node] Executing &quot;func_getfirst-canonical-magnitude&quot; &lt;nipype.interfaces.utility.wrappers.Function&gt;
260222-03:30:12,855 nipype.workflow INFO:
	 [Node] Executing &quot;nibabel_numpy_nilearn_t1w-seg-resampled&quot; &lt;qsmxt.interfaces.nipype_interface_resample_like.ResampleLikeInterface&gt;
260222-03:30:12,856 nipype.workflow INFO:
	 [Node] Finished &quot;func_getfirst-canonical-magnitude&quot;, elapsed time 0.000304s.
260222-03:30:12,853 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.numpy_numpy_nibabel_mgz2nii&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-2/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/numpy_numpy_nibabel_mgz2nii&quot;.
260222-03:30:12,907 nipype.workflow INFO:
	 [Node] Executing &quot;numpy_numpy_nibabel_mgz2nii&quot; &lt;qsmxt.interfaces.nipype_interface_mgz2nii.Mgz2NiiInterface&gt;
260222-03:30:12,853 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_numpy_nilearn_axial-resampling&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-1/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/nibabel_numpy_nilearn_axial-resampling&quot;.
260222-03:30:12,957 nipype.workflow INFO:

	 [Node] Executing &quot;nibabel_numpy_nilearn_axial-resampling&quot; &lt;qsmxt.interfaces.nipype_interface_axialsampling.AxialSamplingInterface&gt;
260222-03:30:12,966 nipype.workflow INFO:
	 [Node] Finished &quot;nibabel_numpy_nilearn_axial-resampling&quot;, elapsed time 0.004303s.
260222-03:30:13,87 nipype.workflow INFO:
	 [Node] Finished &quot;numpy_numpy_nibabel_mgz2nii&quot;, elapsed time 0.177566s.
260222-03:30:14,817 nipype.workflow INFO:
	 [Job 32] Completed (qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.func_getfirst-canonical-magnitude).
260222-03:30:14,818 nipype.workflow INFO:
	 [Job 33] Completed (qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.numpy_numpy_nibabel_mgz2nii).
260222-03:30:14,819 nipype.workflow INFO:
	 [Job 36] Completed (qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_numpy_nilearn_axial-resampling).
260222-03:30:14,820 nipype.workflow INFO:
	 [MultiProc] Running 1 tasks, and 8 jobs ready. Free memory (GB): 12.06/14.06, Free processors: 3/4.
                     Currently running:
                       * qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.nibabel_numpy_nilearn_t1w-seg-resampled
260222-03:30:14,862 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_numpy_nilearn_t1w-seg-resampled&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-1/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/nibabel_numpy_nilearn_t1w-seg-resampled&quot;.
260222-03:30:14,863 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.ants_transform-segmentation-to-qsm&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-1/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/ants_transform-segmentation-to-qsm&quot;.
260222-03:30:14,865 nipype.workflow INFO:
	 [Node] Executing &quot;nibabel_numpy_nilearn_t1w-seg-resampled&quot; &lt;qsmxt.interfaces.nipype_interface_resample_like.ResampleLikeInterface&gt;
260222-03:30:14,866 nipype.workflow INFO:
	 [Node] Executing &quot;ants_transform-segmentation-to-qsm&quot; &lt;nipype.interfaces.ants.resampling.ApplyTransforms&gt;
260222-03:30:14,863 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.nibabel_numpy_nilearn_t1w-seg-resampled&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-2/ses-20170705/qsm_acq-acqmp2ragehighres0p5isoslab_T1w/nibabel_numpy_nilearn_t1w-seg-resampled&quot;.
260222-03:30:14,918 nipype.workflow INFO:
	 [Node] Executing &quot;nibabel_numpy_nilearn_t1w-seg-resampled&quot; &lt;qsmxt.interfaces.nipype_interface_resample_like.ResampleLikeInterface&gt;
260222-03:30:15,906 nipype.workflow INFO:
	 [Node] Finished &quot;nibabel_numpy_nilearn_t1w-seg-resampled&quot;, elapsed time 3.04959s.
260222-03:30:16,664 nipype.workflow INFO:
	 [Node] Finished &quot;ants_transform-segmentation-to-qsm&quot;, elapsed time 1.7964989999999998s.
260222-03:30:16,819 nipype.workflow INFO:
	 [Job 34] Completed (qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.nibabel_numpy_nilearn_t1w-seg-resampled).
260222-03:30:16,820 nipype.workflow INFO:
	 [Job 38] Completed (qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.ants_transform-segmentation-to-qsm).
260222-03:30:16,822 nipype.workflow INFO:
	 [MultiProc] Running 2 tasks, and 6 jobs ready. Free memory (GB): 10.06/14.06, Free processors: 2/4.
                     Currently running:
                       * qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.nibabel_numpy_nilearn_t1w-seg-resampled
                       * qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_numpy_nilearn_t1w-seg-resampled
260222-03:30:16,881 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_numpy_nilearn_axial-resampling&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-2/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/nibabel_numpy_nilearn_axial-resampling&quot;.
260222-03:30:16,881 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_numpy_nilearn_t1w-seg-resampled&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-2/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/nibabel_numpy_nilearn_t1w-seg-resampled&quot;.
260222-03:30:16,884 nipype.workflow INFO:
	 [Node] Executing &quot;nibabel_numpy_nilearn_t1w-seg-resampled&quot; &lt;qsmxt.interfaces.nipype_interface_resample_like.ResampleLikeInterface&gt;
260222-03:30:16,884 nipype.workflow INFO:
	 [Node] Executing &quot;nibabel_numpy_nilearn_axial-resampling&quot; &lt;qsmxt.interfaces.nipype_interface_axialsampling.AxialSamplingInterface&gt;
260222-03:30:16,887 nipype.workflow INFO:
	 [Node] Finished &quot;nibabel_numpy_nilearn_axial-resampling&quot;, elapsed time 0.001969s.
260222-03:30:18,821 nipype.workflow INFO:
	 [Job 41] Completed (qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_numpy_nilearn_axial-resampling).
260222-03:30:18,823 nipype.workflow INFO:
	 [MultiProc] Running 3 tasks, and 6 jobs ready. Free memory (GB): 8.06/14.06, Free processors: 1/4.
                     Currently running:
                       * qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_numpy_nilearn_t1w-seg-resampled
                       * qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.nibabel_numpy_nilearn_t1w-seg-resampled
                       * qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_numpy_nilearn_t1w-seg-resampled
260222-03:30:18,877 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.ants_transform-segmentation-to-qsm&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-2/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/ants_transform-segmentation-to-qsm&quot;.
260222-03:30:18,884 nipype.workflow INFO:
	 [Node] Executing &quot;ants_transform-segmentation-to-qsm&quot; &lt;nipype.interfaces.ants.resampling.ApplyTransforms&gt;
260222-03:30:19,168 nipype.workflow INFO:
	 [Node] Finished &quot;nibabel_numpy_nilearn_t1w-seg-resampled&quot;, elapsed time 4.302591s.
260222-03:30:19,223 nipype.workflow INFO:
	 [Node] Finished &quot;nibabel_numpy_nilearn_t1w-seg-resampled&quot;, elapsed time 4.303595s.
260222-03:30:19,323 nipype.workflow INFO:
	 [Node] Finished &quot;ants_transform-segmentation-to-qsm&quot;, elapsed time 0.438088s.
260222-03:30:20,45 nipype.workflow INFO:
	 [Node] Finished &quot;nibabel_numpy_nilearn_t1w-seg-resampled&quot;, elapsed time 3.160265s.
260222-03:30:20,822 nipype.workflow INFO:
	 [Job 37] Completed (qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_numpy_nilearn_t1w-seg-resampled).
260222-03:30:20,823 nipype.workflow INFO:
	 [Job 39] Completed (qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.nibabel_numpy_nilearn_t1w-seg-resampled).
260222-03:30:20,824 nipype.workflow INFO:
	 [Job 42] Completed (qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_numpy_nilearn_t1w-seg-resampled).
260222-03:30:20,824 nipype.workflow INFO:
	 [Job 43] Completed (qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.ants_transform-segmentation-to-qsm).
260222-03:30:20,825 nipype.workflow INFO:
	 [MultiProc] Running 0 tasks, and 6 jobs ready. Free memory (GB): 14.06/14.06, Free processors: 4/4.
260222-03:30:20,865 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.mask_workflow.fsl-bet&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-1/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/mask_workflow/fsl-bet&quot;.
260222-03:30:20,867 nipype.workflow INFO:
	 [Node] Executing &quot;fsl-bet&quot; &lt;qsmxt.interfaces.nipype_interface_bet2.Bet2Interface&gt;
260222-03:30:22,825 nipype.workflow INFO:
	 [MultiProc] Running 1 tasks, and 5 jobs ready. Free memory (GB): 12.06/14.06, Free processors: 0/4.
                     Currently running:
                       * qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.mask_workflow.fsl-bet
260222-03:30:23,468 nipype.workflow INFO:
	 [Node] Finished &quot;fsl-bet&quot;, elapsed time 2.6004519999999998s.
260222-03:30:24,826 nipype.workflow INFO:
	 [Job 45] Completed (qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.mask_workflow.fsl-bet).
260222-03:30:24,828 nipype.workflow INFO:
	 [MultiProc] Running 0 tasks, and 6 jobs ready. Free memory (GB): 14.06/14.06, Free processors: 4/4.
260222-03:30:24,863 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.qsm_workflow.mrt_romeo&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-1/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/qsm_workflow/mrt_romeo&quot;.
260222-03:30:24,863 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.combine_lists2&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-2/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/combine_lists2&quot;.
260222-03:30:24,865 nipype.workflow INFO:
	 [Node] Executing &quot;combine_lists2&quot; &lt;nipype.interfaces.utility.wrappers.Function&gt;
260222-03:30:24,866 nipype.workflow INFO:
	 [Node] Finished &quot;combine_lists2&quot;, elapsed time 0.000325s.
260222-03:30:24,867 nipype.workflow INFO:
	 [Node] Executing &quot;mrt_romeo&quot; &lt;qsmxt.interfaces.nipype_interface_romeo.RomeoB0Interface&gt;
260222-03:30:24,863 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.combine_lists2&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-1/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/combine_lists2&quot;.
260222-03:30:24,863 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.qsm_workflow.mrt_romeo&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-2/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/qsm_workflow/mrt_romeo&quot;.
260222-03:30:24,916 nipype.workflow INFO:
	 [Node] Executing &quot;combine_lists2&quot; &lt;nipype.interfaces.utility.wrappers.Function&gt;
260222-03:30:24,916 nipype.workflow INFO:
	 [Node] Executing &quot;mrt_romeo&quot; &lt;qsmxt.interfaces.nipype_interface_romeo.RomeoB0Interface&gt;
260222-03:30:24,917 nipype.workflow INFO:
	 [Node] Finished &quot;combine_lists2&quot;, elapsed time 0.000324s.
260222-03:30:26,828 nipype.workflow INFO:
	 [Job 47] Completed (qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.combine_lists2).
260222-03:30:26,829 nipype.workflow INFO:
	 [Job 51] Completed (qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.combine_lists2).
260222-03:30:26,830 nipype.workflow INFO:
	 [MultiProc] Running 2 tasks, and 2 jobs ready. Free memory (GB): 9.38/14.06, Free processors: 2/4.
                     Currently running:
                       * qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.qsm_workflow.mrt_romeo
                       * qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.qsm_workflow.mrt_romeo
260222-03:30:26,869 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.mask_workflow.scipy_numpy_nibabel_bet_erode&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-1/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/mask_workflow/scipy_numpy_nibabel_bet_erode&quot;.
260222-03:30:26,871 nipype.workflow INFO:
	 [Node] Executing &quot;scipy_numpy_nibabel_bet_erode&quot; &lt;qsmxt.interfaces.nipype_interface_erode.ErosionInterface&gt;
260222-03:30:27,215 nipype.workflow INFO:
	 [Node] Finished &quot;scipy_numpy_nibabel_bet_erode&quot;, elapsed time 0.343027s.
260222-03:30:28,829 nipype.workflow INFO:
	 [Job 52] Completed (qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.mask_workflow.scipy_numpy_nibabel_bet_erode).
260222-03:30:28,830 nipype.workflow INFO:
	 [MultiProc] Running 2 tasks, and 1 jobs ready. Free memory (GB): 9.38/14.06, Free processors: 2/4.
                     Currently running:
                       * qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.qsm_workflow.mrt_romeo
                       * qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.qsm_workflow.mrt_romeo
260222-03:35:18,8 nipype.workflow INFO:
	 [Node] Finished &quot;mrt_romeo&quot;, elapsed time 293.140401s.
260222-03:35:19,102 nipype.workflow INFO:
	 [Job 46] Completed (qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.qsm_workflow.mrt_romeo).
260222-03:35:19,104 nipype.workflow INFO:
	 [MultiProc] Running 1 tasks, and 2 jobs ready. Free memory (GB): 11.72/14.06, Free processors: 3/4.
                     Currently running:
                       * qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.qsm_workflow.mrt_romeo
260222-03:35:19,152 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.qsm_workflow.nibabel-numpy_normalize-phase&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-1/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/qsm_workflow/nibabel-numpy_normalize-phase&quot;.
260222-03:35:19,155 nipype.workflow INFO:
	 [Node] Executing &quot;nibabel-numpy_normalize-phase&quot; &lt;qsmxt.interfaces.nipype_interface_processphase.PhaseToNormalizedInterface&gt;
260222-03:35:19,216 nipype.workflow INFO:
	 [Node] Finished &quot;nibabel-numpy_normalize-phase&quot;, elapsed time 0.060103s.
260222-03:35:21,104 nipype.workflow INFO:
	 [Job 53] Completed (qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.qsm_workflow.nibabel-numpy_normalize-phase).
260222-03:35:21,105 nipype.workflow INFO:
	 [MultiProc] Running 1 tasks, and 2 jobs ready. Free memory (GB): 11.72/14.06, Free processors: 3/4.
                     Currently running:
                       * qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.qsm_workflow.mrt_romeo
260222-03:35:21,145 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.qsm_workflow.qsmjl_vsharp&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-1/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/qsm_workflow/qsmjl_vsharp&quot;.
260222-03:35:21,149 nipype.workflow INFO:
	 [Node] Executing &quot;qsmjl_vsharp&quot; &lt;qsmxt.interfaces.nipype_interface_qsmjl.VsharpInterface&gt;
260222-03:35:23,107 nipype.workflow INFO:
	 [MultiProc] Running 2 tasks, and 1 jobs ready. Free memory (GB): 9.72/14.06, Free processors: 1/4.
                     Currently running:
                       * qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.qsm_workflow.qsmjl_vsharp
                       * qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.qsm_workflow.mrt_romeo
260222-03:35:33,277 nipype.workflow INFO:
	 [Node] Finished &quot;mrt_romeo&quot;, elapsed time 308.359976s.
260222-03:35:35,117 nipype.workflow INFO:
	 [Job 50] Completed (qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.qsm_workflow.mrt_romeo).
260222-03:35:35,119 nipype.workflow INFO:
	 [MultiProc] Running 1 tasks, and 2 jobs ready. Free memory (GB): 12.06/14.06, Free processors: 2/4.
                     Currently running:
                       * qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.qsm_workflow.qsmjl_vsharp
260222-03:35:35,166 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.qsm_workflow.nibabel-numpy_normalize-phase&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-2/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/qsm_workflow/nibabel-numpy_normalize-phase&quot;.
260222-03:35:35,169 nipype.workflow INFO:
	 [Node] Executing &quot;nibabel-numpy_normalize-phase&quot; &lt;qsmxt.interfaces.nipype_interface_processphase.PhaseToNormalizedInterface&gt;
260222-03:35:35,230 nipype.workflow INFO:
	 [Node] Finished &quot;nibabel-numpy_normalize-phase&quot;, elapsed time 0.059841s.
260222-03:35:37,119 nipype.workflow INFO:
	 [Job 55] Completed (qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.qsm_workflow.nibabel-numpy_normalize-phase).
260222-03:35:37,121 nipype.workflow INFO:
	 [MultiProc] Running 1 tasks, and 1 jobs ready. Free memory (GB): 12.06/14.06, Free processors: 2/4.
                     Currently running:
                       * qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.qsm_workflow.qsmjl_vsharp
260222-03:37:28,527 nipype.workflow INFO:
	 [Node] Finished &quot;qsmjl_vsharp&quot;, elapsed time 127.37766s.
260222-03:37:29,232 nipype.workflow INFO:
	 [Job 56] Completed (qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.qsm_workflow.qsmjl_vsharp).
260222-03:37:29,233 nipype.workflow INFO:
	 [MultiProc] Running 0 tasks, and 2 jobs ready. Free memory (GB): 14.06/14.06, Free processors: 4/4.
260222-03:37:29,270 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.mask_workflow.fsl-bet&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-2/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/mask_workflow/fsl-bet&quot;.
260222-03:37:29,272 nipype.workflow INFO:
	 [Node] Executing &quot;fsl-bet&quot; &lt;qsmxt.interfaces.nipype_interface_bet2.Bet2Interface&gt;
260222-03:37:31,234 nipype.workflow INFO:
	 [MultiProc] Running 1 tasks, and 1 jobs ready. Free memory (GB): 12.06/14.06, Free processors: 0/4.
                     Currently running:
                       * qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.mask_workflow.fsl-bet
260222-03:37:31,592 nipype.workflow INFO:
	 [Node] Finished &quot;fsl-bet&quot;, elapsed time 2.319076s.
260222-03:37:33,236 nipype.workflow INFO:
	 [Job 49] Completed (qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.mask_workflow.fsl-bet).
260222-03:37:33,237 nipype.workflow INFO:
	 [MultiProc] Running 0 tasks, and 2 jobs ready. Free memory (GB): 14.06/14.06, Free processors: 4/4.
260222-03:37:33,272 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.mask_workflow.scipy_numpy_nibabel_bet_erode&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-2/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/mask_workflow/scipy_numpy_nibabel_bet_erode&quot;.
260222-03:37:33,273 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.qsm_workflow.qsmjl_rts&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-1/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/qsm_workflow/qsmjl_rts&quot;.
260222-03:37:33,274 nipype.workflow INFO:
	 [Node] Executing &quot;scipy_numpy_nibabel_bet_erode&quot; &lt;qsmxt.interfaces.nipype_interface_erode.ErosionInterface&gt;
260222-03:37:33,275 nipype.workflow INFO:
	 [Node] Executing &quot;qsmjl_rts&quot; &lt;qsmxt.interfaces.nipype_interface_qsmjl.RtsQsmInterface&gt;
260222-03:37:33,643 nipype.workflow INFO:
	 [Node] Finished &quot;scipy_numpy_nibabel_bet_erode&quot;, elapsed time 0.367821s.
260222-03:37:35,237 nipype.workflow INFO:
	 [Job 54] Completed (qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.mask_workflow.scipy_numpy_nibabel_bet_erode).
260222-03:37:35,239 nipype.workflow INFO:
	 [MultiProc] Running 1 tasks, and 1 jobs ready. Free memory (GB): 11.65/14.06, Free processors: 2/4.
                     Currently running:
                       * qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.qsm_workflow.qsmjl_rts
260222-03:37:35,288 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.qsm_workflow.qsmjl_vsharp&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-2/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/qsm_workflow/qsmjl_vsharp&quot;.
260222-03:37:35,291 nipype.workflow INFO:
	 [Node] Executing &quot;qsmjl_vsharp&quot; &lt;qsmxt.interfaces.nipype_interface_qsmjl.VsharpInterface&gt;
260222-03:37:37,240 nipype.workflow INFO:
	 [MultiProc] Running 2 tasks, and 0 jobs ready. Free memory (GB): 9.65/14.06, Free processors: 0/4.
                     Currently running:
                       * qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.qsm_workflow.qsmjl_vsharp
                       * qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.qsm_workflow.qsmjl_rts
260222-03:37:51,763 nipype.workflow INFO:
	 [Node] Finished &quot;qsmjl_vsharp&quot;, elapsed time 16.470731s.
260222-03:37:52,922 nipype.workflow INFO:
	 [Node] Finished &quot;qsmjl_rts&quot;, elapsed time 19.645969s.
260222-03:37:53,256 nipype.workflow INFO:
	 [Job 58] Completed (qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.qsm_workflow.qsmjl_rts).
260222-03:37:53,257 nipype.workflow INFO:
	 [Job 57] Completed (qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.qsm_workflow.qsmjl_vsharp).
260222-03:37:53,258 nipype.workflow INFO:
	 [MultiProc] Running 0 tasks, and 2 jobs ready. Free memory (GB): 14.06/14.06, Free processors: 4/4.
260222-03:37:53,294 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_numpy_qsm-average&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-1/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/nibabel_numpy_qsm-average&quot;.
260222-03:37:53,296 nipype.workflow INFO:
	 [Node] Executing &quot;nibabel_numpy_qsm-average&quot; &lt;qsmxt.interfaces.nipype_interface_nonzeroaverage.NonzeroAverageInterface&gt;
260222-03:37:53,297 nipype.workflow INFO:
	 [Node] Finished &quot;nibabel_numpy_qsm-average&quot;, elapsed time 0.000123s.
260222-03:37:53,294 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.qsm_workflow.qsmjl_rts&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-2/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/qsm_workflow/qsmjl_rts&quot;.
260222-03:37:53,347 nipype.workflow INFO:
	 [Node] Executing &quot;qsmjl_rts&quot; &lt;qsmxt.interfaces.nipype_interface_qsmjl.RtsQsmInterface&gt;
260222-03:37:55,258 nipype.workflow INFO:
	 [Job 60] Completed (qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_numpy_qsm-average).
260222-03:37:55,260 nipype.workflow INFO:
	 [MultiProc] Running 1 tasks, and 1 jobs ready. Free memory (GB): 11.65/14.06, Free processors: 2/4.
                     Currently running:
                       * qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.qsm_workflow.qsmjl_rts
260222-03:37:55,297 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_numpy_nilearn_qsm-resampled&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-1/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/nibabel_numpy_nilearn_qsm-resampled&quot;.
260222-03:37:55,300 nipype.workflow INFO:
	 [Node] Executing &quot;nibabel_numpy_nilearn_qsm-resampled&quot; &lt;qsmxt.interfaces.nipype_interface_resample_like.ResampleLikeInterface&gt;
260222-03:37:55,302 nipype.workflow INFO:
	 [Node] Finished &quot;nibabel_numpy_nilearn_qsm-resampled&quot;, elapsed time 0.001937s.
260222-03:37:57,259 nipype.workflow INFO:
	 [Job 62] Completed (qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_numpy_nilearn_qsm-resampled).
260222-03:37:57,261 nipype.workflow INFO:
	 [MultiProc] Running 1 tasks, and 2 jobs ready. Free memory (GB): 11.65/14.06, Free processors: 2/4.
                     Currently running:
                       * qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.qsm_workflow.qsmjl_rts
260222-03:37:57,305 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.combine_lists1&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-1/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/combine_lists1&quot;.
260222-03:37:57,307 nipype.workflow INFO:
	 [Node] Executing &quot;combine_lists1&quot; &lt;nipype.interfaces.utility.wrappers.Function&gt;
260222-03:37:57,308 nipype.workflow INFO:
	 [Node] Finished &quot;combine_lists1&quot;, elapsed time 0.000412s.
260222-03:37:57,305 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_numpy_qsm-referenced&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-1/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/nibabel_numpy_qsm-referenced&quot;.
260222-03:37:57,358 nipype.workflow INFO:
	 [Node] Executing &quot;nibabel_numpy_qsm-referenced&quot; &lt;qsmxt.interfaces.nipype_interface_qsm_referencing.ReferenceQSMInterface&gt;
260222-03:37:57,665 nipype.workflow INFO:
	 [Node] Finished &quot;nibabel_numpy_qsm-referenced&quot;, elapsed time 0.305901s.
260222-03:37:59,261 nipype.workflow INFO:
	 [Job 64] Completed (qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_numpy_qsm-referenced).
260222-03:37:59,262 nipype.workflow INFO:
	 [Job 65] Completed (qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.combine_lists1).
260222-03:37:59,263 nipype.workflow INFO:
	 [MultiProc] Running 1 tasks, and 2 jobs ready. Free memory (GB): 11.65/14.06, Free processors: 2/4.
                     Currently running:
                       * qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.qsm_workflow.qsmjl_rts
260222-03:37:59,307 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.copy_qsm_json_sidecar&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-1/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/copy_qsm_json_sidecar&quot;.
260222-03:37:59,309 nipype.workflow INFO:
	 [Node] Executing &quot;copy_qsm_json_sidecar&quot; &lt;qsmxt.interfaces.nipype_interface_copy_json_sidecar.CopyJsonSidecarInterface&gt;
260222-03:37:59,311 nipype.workflow INFO:
	 [Node] Finished &quot;copy_qsm_json_sidecar&quot;, elapsed time 0.000711s.
260222-03:37:59,307 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.create_permutations&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-1/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/create_permutations&quot;.
260222-03:37:59,361 nipype.workflow INFO:
	 [Node] Executing &quot;create_permutations&quot; &lt;nipype.interfaces.utility.wrappers.Function&gt;
260222-03:37:59,362 nipype.workflow INFO:
	 [Node] Finished &quot;create_permutations&quot;, elapsed time 0.000421s.
260222-03:38:01,263 nipype.workflow INFO:
	 [Job 68] Completed (qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.copy_qsm_json_sidecar).
260222-03:38:01,264 nipype.workflow INFO:
	 [Job 69] Completed (qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.create_permutations).
260222-03:38:01,265 nipype.workflow INFO:
	 [MultiProc] Running 1 tasks, and 1 jobs ready. Free memory (GB): 11.65/14.06, Free processors: 2/4.
                     Currently running:
                       * qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.qsm_workflow.qsmjl_rts
260222-03:38:01,312 nipype.workflow INFO:
	 [Node] Setting-up &quot;_nibabel_numpy_analyse-qsm0&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-1/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/nibabel_numpy_analyse-qsm/mapflow/_nibabel_numpy_analyse-qsm0&quot;.
260222-03:38:01,314 nipype.workflow INFO:
	 [Node] Executing &quot;_nibabel_numpy_analyse-qsm0&quot; &lt;qsmxt.interfaces.nipype_interface_analyse.AnalyseInterface&gt;
260222-03:38:03,266 nipype.workflow INFO:
	 [MultiProc] Running 2 tasks, and 0 jobs ready. Free memory (GB): 9.65/14.06, Free processors: 1/4.
                     Currently running:
                       * qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_numpy_analyse-qsm
                       * qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.qsm_workflow.qsmjl_rts
260222-03:38:13,707 nipype.workflow INFO:
	 [Node] Finished &quot;qsmjl_rts&quot;, elapsed time 20.358802s.
260222-03:38:15,280 nipype.workflow INFO:
	 [Job 59] Completed (qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.qsm_workflow.qsmjl_rts).
260222-03:38:15,282 nipype.workflow INFO:
	 [MultiProc] Running 1 tasks, and 1 jobs ready. Free memory (GB): 12.06/14.06, Free processors: 3/4.
                     Currently running:
                       * qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_numpy_analyse-qsm
260222-03:38:15,335 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_numpy_qsm-average&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-2/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/nibabel_numpy_qsm-average&quot;.
260222-03:38:15,338 nipype.workflow INFO:
	 [Node] Executing &quot;nibabel_numpy_qsm-average&quot; &lt;qsmxt.interfaces.nipype_interface_nonzeroaverage.NonzeroAverageInterface&gt;
260222-03:38:15,340 nipype.workflow INFO:
	 [Node] Finished &quot;nibabel_numpy_qsm-average&quot;, elapsed time 0.000192s.
260222-03:38:17,282 nipype.workflow INFO:
	 [Job 61] Completed (qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_numpy_qsm-average).
260222-03:38:17,284 nipype.workflow INFO:
	 [MultiProc] Running 1 tasks, and 1 jobs ready. Free memory (GB): 12.06/14.06, Free processors: 3/4.
                     Currently running:
                       * qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_numpy_analyse-qsm
260222-03:38:17,334 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_numpy_nilearn_qsm-resampled&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-2/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/nibabel_numpy_nilearn_qsm-resampled&quot;.
260222-03:38:17,336 nipype.workflow INFO:
	 [Node] Executing &quot;nibabel_numpy_nilearn_qsm-resampled&quot; &lt;qsmxt.interfaces.nipype_interface_resample_like.ResampleLikeInterface&gt;
260222-03:38:17,338 nipype.workflow INFO:
	 [Node] Finished &quot;nibabel_numpy_nilearn_qsm-resampled&quot;, elapsed time 0.001384s.
260222-03:38:19,284 nipype.workflow INFO:
	 [Job 63] Completed (qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_numpy_nilearn_qsm-resampled).
260222-03:38:19,286 nipype.workflow INFO:
	 [MultiProc] Running 1 tasks, and 2 jobs ready. Free memory (GB): 12.06/14.06, Free processors: 3/4.
                     Currently running:
                       * qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_numpy_analyse-qsm
260222-03:38:19,339 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_numpy_qsm-referenced&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-2/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/nibabel_numpy_qsm-referenced&quot;.
260222-03:38:19,340 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.combine_lists1&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-2/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/combine_lists1&quot;.
260222-03:38:19,342 nipype.workflow INFO:
	 [Node] Executing &quot;combine_lists1&quot; &lt;nipype.interfaces.utility.wrappers.Function&gt;
260222-03:38:19,343 nipype.workflow INFO:
	 [Node] Finished &quot;combine_lists1&quot;, elapsed time 0.000393s.
260222-03:38:19,342 nipype.workflow INFO:
	 [Node] Executing &quot;nibabel_numpy_qsm-referenced&quot; &lt;qsmxt.interfaces.nipype_interface_qsm_referencing.ReferenceQSMInterface&gt;
260222-03:38:19,716 nipype.workflow INFO:
	 [Node] Finished &quot;nibabel_numpy_qsm-referenced&quot;, elapsed time 0.322444s.
260222-03:38:21,286 nipype.workflow INFO:
	 [Job 66] Completed (qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_numpy_qsm-referenced).
260222-03:38:21,287 nipype.workflow INFO:
	 [Job 67] Completed (qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.combine_lists1).
260222-03:38:21,288 nipype.workflow INFO:
	 [MultiProc] Running 1 tasks, and 2 jobs ready. Free memory (GB): 12.06/14.06, Free processors: 3/4.
                     Currently running:
                       * qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_numpy_analyse-qsm
260222-03:38:21,341 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.copy_qsm_json_sidecar&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-2/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/copy_qsm_json_sidecar&quot;.
260222-03:38:21,344 nipype.workflow INFO:
	 [Node] Executing &quot;copy_qsm_json_sidecar&quot; &lt;qsmxt.interfaces.nipype_interface_copy_json_sidecar.CopyJsonSidecarInterface&gt;
260222-03:38:21,345 nipype.workflow INFO:
	 [Node] Finished &quot;copy_qsm_json_sidecar&quot;, elapsed time 0.000494s.
260222-03:38:21,341 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.create_permutations&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-2/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/create_permutations&quot;.
260222-03:38:21,394 nipype.workflow INFO:
	 [Node] Executing &quot;create_permutations&quot; &lt;nipype.interfaces.utility.wrappers.Function&gt;
260222-03:38:21,395 nipype.workflow INFO:
	 [Node] Finished &quot;create_permutations&quot;, elapsed time 0.000336s.
260222-03:38:23,288 nipype.workflow INFO:
	 [Job 70] Completed (qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.copy_qsm_json_sidecar).
260222-03:38:23,289 nipype.workflow INFO:
	 [Job 71] Completed (qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.create_permutations).
260222-03:38:23,291 nipype.workflow INFO:
	 [MultiProc] Running 1 tasks, and 1 jobs ready. Free memory (GB): 12.06/14.06, Free processors: 3/4.
                     Currently running:
                       * qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_numpy_analyse-qsm
260222-03:38:23,349 nipype.workflow INFO:
	 [Node] Setting-up &quot;_nibabel_numpy_analyse-qsm0&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-2/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/nibabel_numpy_analyse-qsm/mapflow/_nibabel_numpy_analyse-qsm0&quot;.
260222-03:38:23,351 nipype.workflow INFO:
	 [Node] Executing &quot;_nibabel_numpy_analyse-qsm0&quot; &lt;qsmxt.interfaces.nipype_interface_analyse.AnalyseInterface&gt;
260222-03:38:25,291 nipype.workflow INFO:
	 [MultiProc] Running 2 tasks, and 0 jobs ready. Free memory (GB): 10.06/14.06, Free processors: 2/4.
                     Currently running:
                       * qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_numpy_analyse-qsm
                       * qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_numpy_analyse-qsm
260222-03:38:30,511 nipype.workflow INFO:
	 [Node] Finished &quot;_nibabel_numpy_analyse-qsm0&quot;, elapsed time 29.19643s.
260222-03:38:31,296 nipype.workflow INFO:
	 [Job 72] Completed (qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_numpy_analyse-qsm).
260222-03:38:31,299 nipype.workflow INFO:
	 [MultiProc] Running 1 tasks, and 1 jobs ready. Free memory (GB): 12.06/14.06, Free processors: 3/4.
                     Currently running:
                       * qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_numpy_analyse-qsm
260222-03:38:31,363 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.copyfile&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-1/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/copyfile&quot;.
260222-03:38:31,368 nipype.workflow INFO:
	 [Node] Executing &quot;copyfile&quot; &lt;qsmxt.interfaces.nipype_interface_copyfile.DynamicCopyFiles&gt;
260222-03:38:31,502 nipype.workflow INFO:
	 [Node] Finished &quot;copyfile&quot;, elapsed time 0.13273s.
260222-03:38:33,298 nipype.workflow INFO:
	 [Job 74] Completed (qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.copyfile).
260222-03:38:33,300 nipype.workflow INFO:
	 [MultiProc] Running 1 tasks, and 0 jobs ready. Free memory (GB): 12.06/14.06, Free processors: 3/4.
                     Currently running:
                       * qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_numpy_analyse-qsm
260222-03:38:51,244 nipype.workflow INFO:
	 [Node] Finished &quot;_nibabel_numpy_analyse-qsm0&quot;, elapsed time 27.891986s.
260222-03:38:51,315 nipype.workflow INFO:
	 [Job 73] Completed (qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.nibabel_numpy_analyse-qsm).
260222-03:38:51,317 nipype.workflow INFO:
	 [MultiProc] Running 0 tasks, and 1 jobs ready. Free memory (GB): 14.06/14.06, Free processors: 4/4.
260222-03:38:51,359 nipype.workflow INFO:
	 [Node] Setting-up &quot;qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.copyfile&quot; in &quot;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-2/ses-20170705/qsm_acq-acqqsmp21mmisote20_T2starw/copyfile&quot;.
260222-03:38:51,364 nipype.workflow INFO:
	 [Node] Executing &quot;copyfile&quot; &lt;qsmxt.interfaces.nipype_interface_copyfile.DynamicCopyFiles&gt;
260222-03:38:51,494 nipype.workflow INFO:
	 [Node] Finished &quot;copyfile&quot;, elapsed time 0.129729s.
260222-03:38:53,317 nipype.workflow INFO:
	 [Job 75] Completed (qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqqsmp21mmisote20_T2starw.copyfile).
260222-03:38:53,319 nipype.workflow INFO:
	 [MultiProc] Running 0 tasks, and 0 jobs ready. Free memory (GB): 14.06/14.06, Free processors: 4/4.
260222-03:38:55,319 nipype.workflow INFO:
	 ***********************************
260222-03:38:55,319 nipype.workflow ERROR:
	 could not run node: qsmxt-workflow.sub-1.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.ants_register-t1-to-qsm
260222-03:38:55,319 nipype.workflow INFO:
	 crashfile: /home/jovyan/workspace/books/examples/quantitative_imaging/crash-20260222-030335-jovyan-ants_register-t1-to-qsm-4727b226-f59d-4e47-b51a-90e5df393386.pklz
260222-03:38:55,320 nipype.workflow ERROR:
	 could not run node: qsmxt-workflow.sub-2.ses-20170705.qsm_acq-acqmp2ragehighres0p5isoslab_T1w.ants_register-t1-to-qsm
260222-03:38:55,320 nipype.workflow INFO:
	 crashfile: /home/jovyan/workspace/books/examples/quantitative_imaging/crash-20260222-032118-jovyan-ants_register-t1-to-qsm-cec81da9-64d8-4fe9-8e0f-e6795dac3e92.pklz
260222-03:38:55,320 nipype.workflow INFO:
	 ***********************************
RuntimeError: Traceback (most recent call last):
  File &quot;/opt/miniconda-4.12.0/lib/python3.8/site-packages/nipype/pipeline/plugins/multiproc.py&quot;, line 67, in run_node
    result[&quot;result&quot;] = node.run(updatehash=updatehash)
  File &quot;/opt/miniconda-4.12.0/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 527, in run
    result = self._run_interface(execute=True)
  File &quot;/opt/miniconda-4.12.0/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 645, in _run_interface
    return self._run_command(execute)
  File &quot;/opt/miniconda-4.12.0/lib/python3.8/site-packages/nipype/pipeline/engine/nodes.py&quot;, line 771, in _run_command
    raise NodeExecutionError(msg)
nipype.pipeline.engine.nodes.NodeExecutionError: Exception raised while executing Node ants_register-t1-to-qsm.

Cmdline:
	antsRegistrationSyNQuick.sh -d 3 -f /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii -r 32 -m /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii -n 4 -o sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_T1w_ -p d -s 26 -t s
Stdout:

	--------------------------------------------------------------------------------------
	 Mapping parameters
	--------------------------------------------------------------------------------------
	 ANTSPATH is /opt/ants-2.4.3/bin

	 Dimensionality:           3
	 Output name prefix:       sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_T1w_
	 Fixed images:             /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii
	 Moving images:            /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii
	 Mask images:              
	 Initial transforms:       
	 Number of threads:        4
	 Spline distance:          26
	 SyN gradient step:        0.1
	 Transform type:           s
	 MI histogram bins:        32
	 Precision:                d
	 Use histogram matching:   0
	 Repro                     0
	======================================================================================
	 antsRegistration call:
	--------------------------------------------------------------------------------------
	/opt/ants-2.4.3/bin/antsRegistration --verbose 1 --dimensionality 3 --float 0 --collapse-output-transforms 1 --output [ sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_T1w_,sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_T1w_Warped.nii.gz,sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_T1w_InverseWarped.nii.gz ] --interpolation Linear --use-histogram-matching 0 --winsorize-image-intensities [ 0.005,0.995 ] --initial-moving-transform [ /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,/home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,1 ] --transform Rigid[ 0.1 ] --metric MI[ /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,/home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,1,32,Regular,0.25 ] --convergence [ 1000x500x250x0,1e-6,10 ] --shrink-factors 12x8x4x2 --smoothing-sigmas 4x3x2x1vox --transform Affine[ 0.1 ] --metric MI[ /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,/home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,1,32,Regular,0.25 ] --convergence [ 1000x500x250x0,1e-6,10 ] --shrink-factors 12x8x4x2 --smoothing-sigmas 4x3x2x1vox --transform SyN[ 0.1,3,0 ] --metric MI[ /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,/home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,1,32] --convergence [ 100x100x70x50x0,1e-6,10 ] --shrink-factors 10x6x4x2x1 --smoothing-sigmas 5x3x2x1x0vox
	--------------------------------------------------------------------------------------
	All_Command_lines_OK
	Using double precision for computations.
	=============================================================================
	The composite transform comprises the following transforms (in order): 
	  1. Center of mass alignment using fixed image: /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii and moving image: /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii (type = Euler3DTransform)
	=============================================================================
	  number of levels = 4
	  number of levels = 4
	  number of levels = 5
	  fixed image: /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii
	  moving image: /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii
	  fixed image: /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii
	  moving image: /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii
	  fixed image: /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii
	  moving image: /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii
	Dimension = 3
	Number of stages = 3
	Use histogram matching = false
	Winsorize image intensities = true
	  Lower quantile = 0.005
	  Upper quantile = 0.995


	Stage 1 State
	   Image metric = Mattes
	     Fixed image = Image (0x55c13411d8f0)
	  RTTI typeinfo:   itk::Image&lt;double, 3u&gt;
	  Reference Count: 2
	  Modified Time: 1725
	  Debug: Off
	  Object Name: 
	  Observers: 
	    none
	  Source: (none)
	  Source output name: (none)
	  Release Data: Off
	  Data Released: False
	  Global Release Data: Off
	  PipelineMTime: 0
	  UpdateMTime: 1508
	  RealTimeStamp: 0 seconds 
	  LargestPossibleRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  BufferedRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  RequestedRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  Spacing: [0.5, 0.533333, 0.533333]
	  Origin: [75.0348, 90.125, -137.286]
	  Direction: 
	-0.999859 -0.01105 -0.0126378
	0.0126514 -0.990819 -0.134605
	-0.0110344 -0.134746 0.990819

	  IndexToPointMatrix: 
	-0.49993 -0.00589333 -0.00674016
	0.00632572 -0.528437 -0.0717891
	-0.00551719 -0.0718643 0.528437

	  PointToIndexMatrix: 
	-1.99972 0.0253029 -0.0220688
	-0.0207187 -1.85778 -0.252648
	-0.0236959 -0.252384 1.85779

	  Inverse Direction: 
	-0.999859 0.0126514 -0.0110344
	-0.01105 -0.990819 -0.134746
	-0.0126378 -0.134605 0.990819

	  PixelContainer: 
	    ImportImageContainer (0x55c134123280)
	      RTTI typeinfo:   itk::ImportImageContainer&lt;unsigned long, double&gt;
	      Reference Count: 1
	      Modified Time: 1505
	      Debug: Off
	      Object Name: 
	      Observers: 
	        none
	      Pointer: 0x7fb856f6b010
	      Container manages memory: true
	      Size: 45722880
	      Capacity: 45722880

	     Moving image = Image (0x55c134121390)
	  RTTI typeinfo:   itk::Image&lt;double, 3u&gt;
	  Reference Count: 2
	  Modified Time: 1726
	  Debug: Off
	  Object Name: 
	  Observers: 
	    none
	  Source: (none)
	  Source output name: (none)
	  Release Data: Off
	  Data Released: False
	  Global Release Data: Off
	  PipelineMTime: 0
	  UpdateMTime: 1723
	  RealTimeStamp: 0 seconds 
	  LargestPossibleRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  BufferedRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  RequestedRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  Spacing: [0.5, 0.533333, 0.533333]
	  Origin: [75.0348, 90.125, -137.286]
	  Direction: 
	-0.999859 -0.01105 -0.0126378
	0.0126514 -0.990819 -0.134605
	-0.0110344 -0.134746 0.990819

	  IndexToPointMatrix: 
	-0.49993 -0.00589333 -0.00674016
	0.00632572 -0.528437 -0.0717891
	-0.00551719 -0.0718643 0.528437

	  PointToIndexMatrix: 
	-1.99972 0.0253029 -0.0220688
	-0.0207187 -1.85778 -0.252648
	-0.0236959 -0.252384 1.85779

	  Inverse Direction: 
	-0.999859 0.0126514 -0.0110344
	-0.01105 -0.990819 -0.134746
	-0.0126378 -0.134605 0.990819

	  PixelContainer: 
	    ImportImageContainer (0x55c134127790)
	      RTTI typeinfo:   itk::ImportImageContainer&lt;unsigned long, double&gt;
	      Reference Count: 1
	      Modified Time: 1720
	      Debug: Off
	      Object Name: 
	      Observers: 
	        none
	      Pointer: 0x7fb841294010
	      Container manages memory: true
	      Size: 45722880
	      Capacity: 45722880

	     Weighting = 1
	     Sampling strategy = regular
	     Number of bins = 32
	     Radius = 4
	     Sampling percentage  = 0.25
	   Transform = Rigid
	     Gradient step = 0.1
	     Update field sigma (voxel space) = 0
	     Total field sigma (voxel space) = 0
	     Update field time sigma = 0
	     Total field time sigma  = 0
	     Number of time indices = 0
	     Number of time point samples = 0
	Stage 2 State
	   Image metric = Mattes
	     Fixed image = Image (0x55c134136090)
	  RTTI typeinfo:   itk::Image&lt;double, 3u&gt;
	  Reference Count: 2
	  Modified Time: 2157
	  Debug: Off
	  Object Name: 
	  Observers: 
	    none
	  Source: (none)
	  Source output name: (none)
	  Release Data: Off
	  Data Released: False
	  Global Release Data: Off
	  PipelineMTime: 0
	  UpdateMTime: 1940
	  RealTimeStamp: 0 seconds 
	  LargestPossibleRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  BufferedRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  RequestedRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  Spacing: [0.5, 0.533333, 0.533333]
	  Origin: [75.0348, 90.125, -137.286]
	  Direction: 
	-0.999859 -0.01105 -0.0126378
	0.0126514 -0.990819 -0.134605
	-0.0110344 -0.134746 0.990819

	  IndexToPointMatrix: 
	-0.49993 -0.00589333 -0.00674016
	0.00632572 -0.528437 -0.0717891
	-0.00551719 -0.0718643 0.528437

	  PointToIndexMatrix: 
	-1.99972 0.0253029 -0.0220688
	-0.0207187 -1.85778 -0.252648
	-0.0236959 -0.252384 1.85779

	  Inverse Direction: 
	-0.999859 0.0126514 -0.0110344
	-0.01105 -0.990819 -0.134746
	-0.0126378 -0.134605 0.990819

	  PixelContainer: 
	    ImportImageContainer (0x55c134138e90)
	      RTTI typeinfo:   itk::ImportImageContainer&lt;unsigned long, double&gt;
	      Reference Count: 1
	      Modified Time: 1937
	      Debug: Off
	      Object Name: 
	      Observers: 
	        none
	      Pointer: 0x7fb82b5bd010
	      Container manages memory: true
	      Size: 45722880
	      Capacity: 45722880

	     Moving image = Image (0x55c1341354d0)
	  RTTI typeinfo:   itk::Image&lt;double, 3u&gt;
	  Reference Count: 2
	  Modified Time: 2158
	  Debug: Off
	  Object Name: 
	  Observers: 
	    none
	  Source: (none)
	  Source output name: (none)
	  Release Data: Off
	  Data Released: False
	  Global Release Data: Off
	  PipelineMTime: 0
	  UpdateMTime: 2155
	  RealTimeStamp: 0 seconds 
	  LargestPossibleRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  BufferedRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  RequestedRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  Spacing: [0.5, 0.533333, 0.533333]
	  Origin: [75.0348, 90.125, -137.286]
	  Direction: 
	-0.999859 -0.01105 -0.0126378
	0.0126514 -0.990819 -0.134605
	-0.0110344 -0.134746 0.990819

	  IndexToPointMatrix: 
	-0.49993 -0.00589333 -0.00674016
	0.00632572 -0.528437 -0.0717891
	-0.00551719 -0.0718643 0.528437

	  PointToIndexMatrix: 
	-1.99972 0.0253029 -0.0220688
	-0.0207187 -1.85778 -0.252648
	-0.0236959 -0.252384 1.85779

	  Inverse Direction: 
	-0.999859 0.0126514 -0.0110344
	-0.01105 -0.990819 -0.134746
	-0.0126378 -0.134605 0.990819

	  PixelContainer: 
	    ImportImageContainer (0x55c134138440)
	      RTTI typeinfo:   itk::ImportImageContainer&lt;unsigned long, double&gt;
	      Reference Count: 1
	      Modified Time: 2152
	      Debug: Off
	      Object Name: 
	      Observers: 
	        none
	      Pointer: 0x7fb8158e6010
	      Container manages memory: true
	      Size: 45722880
	      Capacity: 45722880

	     Weighting = 1
	     Sampling strategy = regular
	     Number of bins = 32
	     Radius = 4
	     Sampling percentage  = 0.25
	   Transform = Affine
	     Gradient step = 0.1
	     Update field sigma (voxel space) = 0
	     Total field sigma (voxel space) = 0
	     Update field time sigma = 0
	     Total field time sigma  = 0
	     Number of time indices = 0
	     Number of time point samples = 0
	Stage 3 State
	   Image metric = Mattes
	     Fixed image = Image (0x55c13413df20)
	  RTTI typeinfo:   itk::Image&lt;double, 3u&gt;
	  Reference Count: 2
	  Modified Time: 2589
	  Debug: Off
	  Object Name: 
	  Observers: 
	    none
	  Source: (none)
	  Source output name: (none)
	  Release Data: Off
	  Data Released: False
	  Global Release Data: Off
	  PipelineMTime: 0
	  UpdateMTime: 2372
	  RealTimeStamp: 0 seconds 
	  LargestPossibleRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  BufferedRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  RequestedRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  Spacing: [0.5, 0.533333, 0.533333]
	  Origin: [75.0348, 90.125, -137.286]
	  Direction: 
	-0.999859 -0.01105 -0.0126378
	0.0126514 -0.990819 -0.134605
	-0.0110344 -0.134746 0.990819

	  IndexToPointMatrix: 
	-0.49993 -0.00589333 -0.00674016
	0.00632572 -0.528437 -0.0717891
	-0.00551719 -0.0718643 0.528437

	  PointToIndexMatrix: 
	-1.99972 0.0253029 -0.0220688
	-0.0207187 -1.85778 -0.252648
	-0.0236959 -0.252384 1.85779

	  Inverse Direction: 
	-0.999859 0.0126514 -0.0110344
	-0.01105 -0.990819 -0.134746
	-0.0126378 -0.134605 0.990819

	  PixelContainer: 
	    ImportImageContainer (0x55c13413de70)
	      RTTI typeinfo:   itk::ImportImageContainer&lt;unsigned long, double&gt;
	      Reference Count: 1
	      Modified Time: 2369
	      Debug: Off
	      Object Name: 
	      Observers: 
	        none
	      Pointer: 0x7fb7ffc0f010
	      Container manages memory: true
	      Size: 45722880
	      Capacity: 45722880

	     Moving image = Image (0x55c13413ce20)
	  RTTI typeinfo:   itk::Image&lt;double, 3u&gt;
	  Reference Count: 2
	  Modified Time: 2590
	  Debug: Off
	  Object Name: 
	  Observers: 
	    none
	  Source: (none)
	  Source output name: (none)
	  Release Data: Off
	  Data Released: False
	  Global Release Data: Off
	  PipelineMTime: 0
	  UpdateMTime: 2587
	  RealTimeStamp: 0 seconds 
	  LargestPossibleRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  BufferedRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  RequestedRegion: 
	    Dimension: 3
	    Index: [0, 0, 0]
	    Size: [288, 378, 420]
	  Spacing: [0.5, 0.533333, 0.533333]
	  Origin: [75.0348, 90.125, -137.286]
	  Direction: 
	-0.999859 -0.01105 -0.0126378
	0.0126514 -0.990819 -0.134605
	-0.0110344 -0.134746 0.990819

	  IndexToPointMatrix: 
	-0.49993 -0.00589333 -0.00674016
	0.00632572 -0.528437 -0.0717891
	-0.00551719 -0.0718643 0.528437

	  PointToIndexMatrix: 
	-1.99972 0.0253029 -0.0220688
	-0.0207187 -1.85778 -0.252648
	-0.0236959 -0.252384 1.85779

	  Inverse Direction: 
	-0.999859 0.0126514 -0.0110344
	-0.01105 -0.990819 -0.134746
	-0.0126378 -0.134605 0.990819

	  PixelContainer: 
	    ImportImageContainer (0x55c13413d870)
	      RTTI typeinfo:   itk::ImportImageContainer&lt;unsigned long, double&gt;
	      Reference Count: 1
	      Modified Time: 2584
	      Debug: Off
	      Object Name: 
	      Observers: 
	        none
	      Pointer: 0x7fb7e9f38010
	      Container manages memory: true
	      Size: 45722880
	      Capacity: 45722880

	     Weighting = 1
	     Sampling strategy = none
	     Number of bins = 32
	     Radius = 4
	     Sampling percentage  = 1
	   Transform = SyN
	     Gradient step = 0.1
	     Update field sigma (voxel space) = 3
	     Total field sigma (voxel space) = 0
	     Update field time sigma = 0
	     Total field time sigma  = 0
	     Number of time indices = 0
	     Number of time point samples = 0
	Registration using 3 total stages.

	Stage 0
	  iterations = 1000x500x250x0
	  convergence threshold = 1e-06
	  convergence window size = 10
	  number of levels = 4
	  using the Mattes MI metric (number of bins = 32, weight = 1, use gradient filter = 0)
	  preprocessing:  winsorizing the image intensities
	  Shrink factors (level 1 out of 4): [12, 11, 11]
	  Shrink factors (level 2 out of 4): [8, 7, 7]
	  Shrink factors (level 3 out of 4): [4, 4, 4]
	  Shrink factors (level 4 out of 4): [2, 2, 2]
	  smoothing sigmas per level: [4, 3, 2, 1]
	  regular sampling (percentage = 0.25)

	*** Running Euler3DTransform registration ***

	DIAGNOSTIC,Iteration,metricValue,convergenceValue,ITERATION_TIME_INDEX,SINCE_LAST
	 2DIAGNOSTIC,     1, -1.847269817564e+00, 1.797693134862e+308, 1.7739e+00, 1.7739e+00, 
	 2DIAGNOSTIC,     2, -1.847325733841e+00, 1.797693134862e+308, 1.7786e+00, 4.7030e-03, 
	 2DIAGNOSTIC,     3, -1.847342828388e+00, 1.797693134862e+308, 1.7842e+00, 5.6381e-03, 
	 2DIAGNOSTIC,     4, -1.847358785005e+00, 1.797693134862e+308, 1.7912e+00, 6.9442e-03, 
	 2DIAGNOSTIC,     5, -1.847490152799e+00, 1.797693134862e+308, 1.7959e+00, 4.7410e-03, 
	 2DIAGNOSTIC,     6, -1.847505958096e+00, 1.797693134862e+308, 1.8011e+00, 5.2249e-03, 
	 2DIAGNOSTIC,     7, -1.847513687333e+00, 1.797693134862e+308, 1.8054e+00, 4.3058e-03, 
	 2DIAGNOSTIC,     8, -1.847514021857e+00, 1.797693134862e+308, 1.8114e+00, 5.9361e-03, 
	 2DIAGNOSTIC,     9, -1.847514295521e+00, 1.797693134862e+308, 1.8160e+00, 4.6048e-03, 
	 2DIAGNOSTIC,    10, -1.847514456888e+00, 1.248046045561e-05, 1.8208e+00, 4.8268e-03, 
	 2DIAGNOSTIC,    11, -1.847514863207e+00, 9.334741336214e-06, 1.8268e+00, 5.9481e-03, 
	 2DIAGNOSTIC,    12, -1.847515015299e+00, 6.875570068093e-06, 1.8315e+00, 4.7009e-03, 
	 2DIAGNOSTIC,    13, -1.847515110651e+00, 4.632715425515e-06, 1.8367e+00, 5.2419e-03, 
	 2DIAGNOSTIC,    14, -1.847515299338e+00, 2.651235940204e-06, 1.8427e+00, 6.0279e-03, 
	 2DIAGNOSTIC,    15, -1.847515328307e+00, 2.243239931601e-06, 1.8479e+00, 5.1799e-03, 
	 2DIAGNOSTIC,    16, -1.847515371645e+00, 2.025294424279e-06, 1.8524e+00, 4.4520e-03, 
	 2DIAGNOSTIC,    17, -1.847515388914e+00, 1.899619578277e-06, 1.8577e+00, 5.3709e-03, 
	 2DIAGNOSTIC,    18, -1.847515389124e+00, 1.788131926521e-06, 1.8720e+00, 1.4276e-02, 
	 2DIAGNOSTIC,    19, -1.847515389124e+00, 1.688661882292e-06, 1.8840e+00, 1.1990e-02, 
	 2DIAGNOSTIC,    20, -1.847515389124e+00, 1.598968728443e-06, 1.8892e+00, 5.1939e-03, 
	 2DIAGNOSTIC,    21, -1.847515389124e+00, 1.520000834893e-06, 1.8943e+00, 5.1341e-03, 
	 2DIAGNOSTIC,    22, -1.847515389124e+00, 1.448785846583e-06, 1.8996e+00, 5.3120e-03, 
	 2DIAGNOSTIC,    23, -1.847515389124e+00, 1.384104955676e-06, 1.9052e+00, 5.5330e-03, 
	 2DIAGNOSTIC,    24, -1.847515389124e+00, 1.325926166029e-06, 1.9101e+00, 4.9131e-03, 
	 2DIAGNOSTIC,    25, -1.847515389124e+00, 1.272527789579e-06, 1.9149e+00, 4.8342e-03, 
	 2DIAGNOSTIC,    26, -1.847515389124e+00, 1.223480330229e-06, 1.9210e+00, 6.1040e-03, 
	 2DIAGNOSTIC,    27, -1.847515389124e+00, 1.178164316655e-06, 1.9260e+00, 4.9849e-03, 
	 2DIAGNOSTIC,    28, -1.847515389124e+00, 1.136086365899e-06, 1.9316e+00, 5.6109e-03, 
	 2DIAGNOSTIC,    29, -1.847515389124e+00, 1.096910384996e-06, 1.9367e+00, 5.1198e-03, 
	 2DIAGNOSTIC,    30, -1.847515389124e+00, 1.060346174114e-06, 1.9419e+00, 5.1770e-03, 
	 2DIAGNOSTIC,    31, -1.847515389124e+00, 1.026140977751e-06, 1.9469e+00, 5.0380e-03, 
	DIAGNOSTIC,Iteration,metricValue,convergenceValue,ITERATION_TIME_INDEX,SINCE_LAST
	 2DIAGNOSTIC,     1, -1.849001441198e+00, 1.797693134862e+308, 3.7029e+00, 1.7560e+00, 
	 2DIAGNOSTIC,     2, -1.849105546208e+00, 1.797693134862e+308, 3.7636e+00, 6.0630e-02, 
	 2DIAGNOSTIC,     3, -1.849105692496e+00, 1.797693134862e+308, 3.8002e+00, 3.6662e-02, 
	 2DIAGNOSTIC,     4, -1.849110061534e+00, 1.797693134862e+308, 3.8330e+00, 3.2729e-02, 
	 2DIAGNOSTIC,     5, -1.849080999893e+00, 1.797693134862e+308, 3.8597e+00, 2.6736e-02, 
	 2DIAGNOSTIC,     6, -1.849089987176e+00, 1.797693134862e+308, 3.8821e+00, 2.2445e-02, 
	 2DIAGNOSTIC,     7, -1.849100932406e+00, 1.797693134862e+308, 3.9040e+00, 2.1896e-02, 
	 2DIAGNOSTIC,     8, -1.849112400599e+00, 1.797693134862e+308, 3.9258e+00, 2.1781e-02, 
	 2DIAGNOSTIC,     9, -1.849124053981e+00, 1.797693134862e+308, 3.9484e+00, 2.2589e-02, 
	 2DIAGNOSTIC,    10, -1.849138825699e+00, 5.570875560773e-06, 3.9707e+00, 2.2315e-02, 
	 2DIAGNOSTIC,    11, -1.849138951285e+00, 4.130348576797e-06, 3.9965e+00, 2.5756e-02, 
	 2DIAGNOSTIC,    12, -1.849114540192e+00, 3.835506374769e-06, 4.0245e+00, 2.7981e-02, 
	 2DIAGNOSTIC,    13, -1.849119294609e+00, 3.540934911520e-06, 4.0527e+00, 2.8240e-02, 
	 2DIAGNOSTIC,    14, -1.849122384976e+00, 3.275333262165e-06, 4.0749e+00, 2.2157e-02, 
	 2DIAGNOSTIC,    15, -1.849125370124e+00, 2.679585775808e-06, 4.1001e+00, 2.5235e-02, 
	 2DIAGNOSTIC,    16, -1.849129677260e+00, 2.235513931192e-06, 4.1327e+00, 3.2571e-02, 
	 2DIAGNOSTIC,    17, -1.849130042931e+00, 1.926875013887e-06, 4.1548e+00, 2.2178e-02, 
	 2DIAGNOSTIC,    18, -1.849130631196e+00, 1.749788376117e-06, 4.1768e+00, 2.1941e-02, 
	 2DIAGNOSTIC,    19, -1.849130675951e+00, 1.680766208483e-06, 4.2022e+00, 2.5367e-02, 
	 2DIAGNOSTIC,    20, -1.849130748664e+00, 1.729914239114e-06, 4.2276e+00, 2.5417e-02, 
	 2DIAGNOSTIC,    21, -1.849130804652e+00, 1.768071910616e-06, 4.2527e+00, 2.5159e-02, 
	 2DIAGNOSTIC,    22, -1.849130902365e+00, 1.608723328175e-06, 4.2779e+00, 2.5168e-02, 
	 2DIAGNOSTIC,    23, -1.849130953953e+00, 1.480150577458e-06, 4.3555e+00, 7.7603e-02, 
	 2DIAGNOSTIC,    24, -1.849130953953e+00, 1.372787381618e-06, 4.4149e+00, 5.9449e-02, 
	 2DIAGNOSTIC,    25, -1.849130953953e+00, 1.287248981768e-06, 4.4508e+00, 3.5882e-02, 
	 2DIAGNOSTIC,    26, -1.849130953953e+00, 1.232336370907e-06, 4.4760e+00, 2.5188e-02, 
	 2DIAGNOSTIC,    27, -1.849130953953e+00, 1.182639793713e-06, 4.5014e+00, 2.5395e-02, 
	 2DIAGNOSTIC,    28, -1.849130953953e+00, 1.139295060119e-06, 4.5296e+00, 2.8199e-02, 
	 2DIAGNOSTIC,    29, -1.849130953953e+00, 1.098872863349e-06, 4.5553e+00, 2.5685e-02, 
	 2DIAGNOSTIC,    30, -1.849130953953e+00, 1.061333760627e-06, 4.5868e+00, 3.1493e-02, 
	 2DIAGNOSTIC,    31, -1.849130953953e+00, 1.026389069611e-06, 4.6119e+00, 2.5145e-02, 
	DIAGNOSTIC,Iteration,metricValue,convergenceValue,ITERATION_TIME_INDEX,SINCE_LAST
	 2DIAGNOSTIC,     1, -1.832227971573e+00, 1.797693134862e+308, 6.6728e+00, 2.0609e+00, 
	 2DIAGNOSTIC,     2, -1.832237852852e+00, 1.797693134862e+308, 6.8405e+00, 1.6767e-01, 
	 2DIAGNOSTIC,     3, -1.832229661375e+00, 1.797693134862e+308, 7.0278e+00, 1.8730e-01, 
	 2DIAGNOSTIC,     4, -1.832232607532e+00, 1.797693134862e+308, 7.2241e+00, 1.9632e-01, 
	 2DIAGNOSTIC,     5, -1.832241999137e+00, 1.797693134862e+308, 7.3871e+00, 1.6300e-01, 
	 2DIAGNOSTIC,     6, -1.832239841873e+00, 1.797693134862e+308, 7.5535e+00, 1.6639e-01, 
	 2DIAGNOSTIC,     7, -1.832240571170e+00, 1.797693134862e+308, 7.8325e+00, 2.7902e-01, 
	 2DIAGNOSTIC,     8, -1.832234932344e+00, 1.797693134862e+308, 7.9764e+00, 1.4395e-01, 
	 2DIAGNOSTIC,     9, -1.832234940034e+00, 1.797693134862e+308, 8.1183e+00, 1.4185e-01, 
	 2DIAGNOSTIC,    10, -1.832234945567e+00, 3.359244244813e-06, 8.2874e+00, 1.6910e-01, 
	 2DIAGNOSTIC,    11, -1.832234947594e+00, 2.894229329309e-06, 8.4367e+00, 1.4937e-01, 
	 2DIAGNOSTIC,    12, -1.832234950520e+00, 2.639965758791e-06, 8.5856e+00, 1.4889e-01, 
	 2DIAGNOSTIC,    13, -1.832234958646e+00, 2.329181100630e-06, 8.7305e+00, 1.4489e-01, 
	 2DIAGNOSTIC,    14, -1.832234967091e+00, 2.103314921106e-06, 8.8780e+00, 1.4750e-01, 
	 2DIAGNOSTIC,    15, -1.832234977700e+00, 2.019983430884e-06, 9.0407e+00, 1.6264e-01, 
	 2DIAGNOSTIC,    16, -1.832240500683e+00, 1.988065921568e-06, 9.1909e+00, 1.5026e-01, 
	 2DIAGNOSTIC,    17, -1.832234993249e+00, 1.916350759447e-06, 9.7165e+00, 5.2552e-01, 
	 2DIAGNOSTIC,    18, -1.832234993246e+00, 1.801766489687e-06, 1.0189e+01, 4.7289e-01, 
	 2DIAGNOSTIC,    19, -1.832234993246e+00, 1.696295978959e-06, 1.0459e+01, 2.6976e-01, 
	 2DIAGNOSTIC,    20, -1.832234993246e+00, 1.598504373132e-06, 1.0621e+01, 1.6207e-01, 
	 2DIAGNOSTIC,    21, -1.832234993246e+00, 1.508761332730e-06, 1.0793e+01, 1.7180e-01, 
	 2DIAGNOSTIC,    22, -1.832234993246e+00, 1.428265954576e-06, 1.0963e+01, 1.6957e-01, 
	 2DIAGNOSTIC,    23, -1.832234993246e+00, 1.357221815816e-06, 1.1133e+01, 1.7056e-01, 
	 2DIAGNOSTIC,    24, -1.832234993246e+00, 1.294420636087e-06, 1.1301e+01, 1.6787e-01, 
	 2DIAGNOSTIC,    25, -1.832234993246e+00, 1.238224762161e-06, 1.1471e+01, 1.7025e-01, 
	 2DIAGNOSTIC,    26, -1.832234993246e+00, 1.223458282115e-06, 1.1614e+01, 1.4319e-01, 
	 2DIAGNOSTIC,    27, -1.832234993246e+00, 1.178145037743e-06, 1.1785e+01, 1.7107e-01, 
	 2DIAGNOSTIC,    28, -1.832234993246e+00, 1.136068438073e-06, 1.1954e+01, 1.6817e-01, 
	 2DIAGNOSTIC,    29, -1.832234993246e+00, 1.096893672274e-06, 1.2122e+01, 1.6796e-01, 
	 2DIAGNOSTIC,    30, -1.832234993246e+00, 1.060330556989e-06, 1.2285e+01, 1.6375e-01, 
	 2DIAGNOSTIC,    31, -1.832234993246e+00, 1.026126351958e-06, 1.2452e+01, 1.6669e-01, 
	DIAGNOSTIC,Iteration,metricValue,convergenceValue,ITERATION_TIME_INDEX,SINCE_LAST
	 2DIAGNOSTIC,     1, -1.823575530639e+00, 1.797693134862e+308, 1.6464e+01, 4.0122e+00, 
	  Elapsed time (stage 0): 1.7997e+01


	Stage 1
	  iterations = 1000x500x250x0
	  convergence threshold = 1.0000e-06
	  convergence window size = 10
	  number of levels = 4
	  using the Mattes MI metric (number of bins = 32, weight = 1.0000e+00, use gradient filter = 0)
	  preprocessing:  winsorizing the image intensities
	  Shrink factors (level 1 out of 4): [12, 11, 11]
	  Shrink factors (level 2 out of 4): [8, 7, 7]
	  Shrink factors (level 3 out of 4): [4, 4, 4]
	  Shrink factors (level 4 out of 4): [2, 2, 2]
	  smoothing sigmas per level: [4, 3, 2, 1]
	  regular sampling (percentage = 2.5000e-01)

	*** Running AffineTransform registration ***

	DIAGNOSTIC,Iteration,metricValue,convergenceValue,ITERATION_TIME_INDEX,SINCE_LAST
	 2DIAGNOSTIC,     1, -1.852512352013e+00, 1.797693134862e+308, 1.7194e+00, 1.7194e+00, 
	 2DIAGNOSTIC,     2, -1.852728306814e+00, 1.797693134862e+308, 1.7266e+00, 7.2470e-03, 
	 2DIAGNOSTIC,     3, -1.852752164515e+00, 1.797693134862e+308, 1.7317e+00, 5.1088e-03, 
	 2DIAGNOSTIC,     4, -1.852829465945e+00, 1.797693134862e+308, 1.7375e+00, 5.7440e-03, 
	 2DIAGNOSTIC,     5, -1.852826114164e+00, 1.797693134862e+308, 1.7422e+00, 4.7350e-03, 
	 2DIAGNOSTIC,     6, -1.852836384047e+00, 1.797693134862e+308, 1.7472e+00, 5.0120e-03, 
	 2DIAGNOSTIC,     7, -1.852842907785e+00, 1.797693134862e+308, 1.7528e+00, 5.5599e-03, 
	 2DIAGNOSTIC,     8, -1.852849237587e+00, 1.797693134862e+308, 1.7586e+00, 5.7819e-03, 
	 2DIAGNOSTIC,     9, -1.852852676373e+00, 1.797693134862e+308, 1.7649e+00, 6.2730e-03, 
	 2DIAGNOSTIC,    10, -1.852853957103e+00, 1.125567120022e-05, 1.7725e+00, 7.6001e-03, 
	 2DIAGNOSTIC,    11, -1.852854274335e+00, 6.281295451577e-06, 1.7788e+00, 6.3210e-03, 
	 2DIAGNOSTIC,    12, -1.852854771418e+00, 4.600053388593e-06, 1.7849e+00, 6.1340e-03, 
	 2DIAGNOSTIC,    13, -1.852854809434e+00, 3.257202021836e-06, 1.7898e+00, 4.9040e-03, 
	 2DIAGNOSTIC,    14, -1.852854850354e+00, 2.882759115058e-06, 1.7952e+00, 5.3549e-03, 
	 2DIAGNOSTIC,    15, -1.852854887660e+00, 2.467165874917e-06, 1.8005e+00, 5.2929e-03, 
	 2DIAGNOSTIC,    16, -1.852854916724e+00, 2.169850623734e-06, 1.8065e+00, 5.9969e-03, 
	 2DIAGNOSTIC,    17, -1.852854919648e+00, 1.948518747213e-06, 1.8121e+00, 5.6171e-03, 
	 2DIAGNOSTIC,    18, -1.852854921064e+00, 1.797911859537e-06, 1.8277e+00, 1.5602e-02, 
	 2DIAGNOSTIC,    19, -1.852854921064e+00, 1.687875804304e-06, 1.8353e+00, 7.6089e-03, 
	 2DIAGNOSTIC,    20, -1.852854921064e+00, 1.597373653385e-06, 1.8406e+00, 5.3420e-03, 
	 2DIAGNOSTIC,    21, -1.852854921064e+00, 1.517069651798e-06, 1.8463e+00, 5.6322e-03, 
	 2DIAGNOSTIC,    22, -1.852854921064e+00, 1.447317544985e-06, 1.8515e+00, 5.2571e-03, 
	 2DIAGNOSTIC,    23, -1.852854921064e+00, 1.383752679406e-06, 1.8571e+00, 5.6028e-03, 
	 2DIAGNOSTIC,    24, -1.852854921064e+00, 1.325677406294e-06, 1.8625e+00, 5.3720e-03, 
	 2DIAGNOSTIC,    25, -1.852854921064e+00, 1.272449445734e-06, 1.8683e+00, 5.8110e-03, 
	 2DIAGNOSTIC,    26, -1.852854921064e+00, 1.223483858677e-06, 1.8736e+00, 5.3461e-03, 
	 2DIAGNOSTIC,    27, -1.852854921064e+00, 1.178160993431e-06, 1.8798e+00, 6.1300e-03, 
	 2DIAGNOSTIC,    28, -1.852854921064e+00, 1.136083274511e-06, 1.8856e+00, 5.8219e-03, 
	 2DIAGNOSTIC,    29, -1.852854921064e+00, 1.096907503155e-06, 1.8911e+00, 5.4770e-03, 
	 2DIAGNOSTIC,    30, -1.852854921064e+00, 1.060343481192e-06, 1.8966e+00, 5.4772e-03, 
	 2DIAGNOSTIC,    31, -1.852854921064e+00, 1.026138455776e-06, 1.9021e+00, 5.5339e-03, 
	DIAGNOSTIC,Iteration,metricValue,convergenceValue,ITERATION_TIME_INDEX,SINCE_LAST
	 2DIAGNOSTIC,     1, -1.846632107868e+00, 1.797693134862e+308, 3.7034e+00, 1.8013e+00, 
	 2DIAGNOSTIC,     2, -1.846891716323e+00, 1.797693134862e+308, 3.7453e+00, 4.1915e-02, 
	 2DIAGNOSTIC,     3, -1.846907537564e+00, 1.797693134862e+308, 3.7718e+00, 2.6510e-02, 
	 2DIAGNOSTIC,     4, -1.846977421595e+00, 1.797693134862e+308, 3.7983e+00, 2.6533e-02, 
	 2DIAGNOSTIC,     5, -1.847028761426e+00, 1.797693134862e+308, 3.8233e+00, 2.5013e-02, 
	 2DIAGNOSTIC,     6, -1.847042554528e+00, 1.797693134862e+308, 3.8515e+00, 2.8208e-02, 
	 2DIAGNOSTIC,     7, -1.847086227656e+00, 1.797693134862e+308, 3.8773e+00, 2.5773e-02, 
	 2DIAGNOSTIC,     8, -1.847085816939e+00, 1.797693134862e+308, 3.9057e+00, 2.8415e-02, 
	 2DIAGNOSTIC,     9, -1.847088768255e+00, 1.797693134862e+308, 3.9410e+00, 3.5245e-02, 
	 2DIAGNOSTIC,    10, -1.847089158206e+00, 1.560587065520e-05, 3.9669e+00, 2.5875e-02, 
	 2DIAGNOSTIC,    11, -1.847090432201e+00, 9.458420110062e-06, 3.9918e+00, 2.4899e-02, 
	 2DIAGNOSTIC,    12, -1.847091024839e+00, 7.089242702860e-06, 4.0173e+00, 2.5521e-02, 
	 2DIAGNOSTIC,    13, -1.847091720633e+00, 4.863669024177e-06, 4.0525e+00, 3.5261e-02, 
	 2DIAGNOSTIC,    14, -1.847091862985e+00, 3.499232480650e-06, 4.0776e+00, 2.5059e-02, 
	 2DIAGNOSTIC,    15, -1.847092023079e+00, 2.734202599441e-06, 4.1027e+00, 2.5156e-02, 
	 2DIAGNOSTIC,    16, -1.847092132064e+00, 2.130457246244e-06, 4.1311e+00, 2.8400e-02, 
	 2DIAGNOSTIC,    17, -1.847092191371e+00, 1.980826899985e-06, 4.1588e+00, 2.7649e-02, 
	 2DIAGNOSTIC,    18, -1.847092228523e+00, 1.833894553660e-06, 4.2430e+00, 8.4184e-02, 
	 2DIAGNOSTIC,    19, -1.847092228523e+00, 1.720235719718e-06, 4.3054e+00, 6.2391e-02, 
	 2DIAGNOSTIC,    20, -1.847092228523e+00, 1.616514897322e-06, 4.3327e+00, 2.7364e-02, 
	 2DIAGNOSTIC,    21, -1.847092228523e+00, 1.529526913652e-06, 4.3599e+00, 2.7185e-02, 
	 2DIAGNOSTIC,    22, -1.847092228523e+00, 1.453097108008e-06, 4.3871e+00, 2.7208e-02, 
	 2DIAGNOSTIC,    23, -1.847092228523e+00, 1.387291108358e-06, 4.4141e+00, 2.6982e-02, 
	 2DIAGNOSTIC,    24, -1.847092228523e+00, 1.327470904221e-06, 4.4432e+00, 2.9065e-02, 
	 2DIAGNOSTIC,    25, -1.847092228523e+00, 1.273220561857e-06, 4.4781e+00, 3.4875e-02, 
	 2DIAGNOSTIC,    26, -1.847092228523e+00, 1.223706375411e-06, 4.5091e+00, 3.1029e-02, 
	 2DIAGNOSTIC,    27, -1.847092228523e+00, 1.178171193668e-06, 4.5414e+00, 3.2350e-02, 
	 2DIAGNOSTIC,    28, -1.847092228523e+00, 1.136092760763e-06, 4.5696e+00, 2.8212e-02, 
	 2DIAGNOSTIC,    29, -1.847092228523e+00, 1.096916346442e-06, 4.6015e+00, 3.1875e-02, 
	 2DIAGNOSTIC,    30, -1.847092228523e+00, 1.060351744755e-06, 4.6299e+00, 2.8342e-02, 
	 2DIAGNOSTIC,    31, -1.847092228523e+00, 1.026146194794e-06, 4.6614e+00, 3.1522e-02, 
	DIAGNOSTIC,Iteration,metricValue,convergenceValue,ITERATION_TIME_INDEX,SINCE_LAST
	 2DIAGNOSTIC,     1, -1.835625007312e+00, 1.797693134862e+308, 6.7441e+00, 2.0827e+00, 
	 2DIAGNOSTIC,     2, -1.835665424201e+00, 1.797693134862e+308, 6.9614e+00, 2.1728e-01, 
	 2DIAGNOSTIC,     3, -1.835672290514e+00, 1.797693134862e+308, 7.1122e+00, 1.5080e-01, 
	 2DIAGNOSTIC,     4, -1.835689622589e+00, 1.797693134862e+308, 7.2676e+00, 1.5540e-01, 
	 2DIAGNOSTIC,     5, -1.835694396859e+00, 1.797693134862e+308, 7.4184e+00, 1.5085e-01, 
	 2DIAGNOSTIC,     6, -1.835697893853e+00, 1.797693134862e+308, 7.5910e+00, 1.7255e-01, 
	 2DIAGNOSTIC,     7, -1.835703683076e+00, 1.797693134862e+308, 7.7685e+00, 1.7756e-01, 
	 2DIAGNOSTIC,     8, -1.835700101150e+00, 1.797693134862e+308, 7.9477e+00, 1.7915e-01, 
	 2DIAGNOSTIC,     9, -1.835700537041e+00, 1.797693134862e+308, 8.1212e+00, 1.7347e-01, 
	 2DIAGNOSTIC,    10, -1.835700755280e+00, 5.241594285596e-06, 8.3210e+00, 1.9989e-01, 
	 2DIAGNOSTIC,    11, -1.835700848978e+00, 3.899227140391e-06, 8.5005e+00, 1.7947e-01, 
	 2DIAGNOSTIC,    12, -1.835700857266e+00, 3.211828257813e-06, 8.6519e+00, 1.5138e-01, 
	 2DIAGNOSTIC,    13, -1.835700867420e+00, 2.657366479614e-06, 8.8292e+00, 1.7727e-01, 
	 2DIAGNOSTIC,    14, -1.835700878144e+00, 2.354863106610e-06, 9.0347e+00, 2.0548e-01, 
	 2DIAGNOSTIC,    15, -1.835700884672e+00, 2.133511632363e-06, 9.2716e+00, 2.3693e-01, 
	 2DIAGNOSTIC,    16, -1.835700887086e+00, 1.970535868437e-06, 9.4250e+00, 1.5347e-01, 
	 2DIAGNOSTIC,    17, -1.835700893078e+00, 1.882145391617e-06, 9.5812e+00, 1.5613e-01, 
	 2DIAGNOSTIC,    18, -1.835700911088e+00, 1.771834547130e-06, 9.7360e+00, 1.5479e-01, 
	 2DIAGNOSTIC,    19, -1.835700965179e+00, 1.676655105004e-06, 1.0272e+01, 5.3621e-01, 
	 2DIAGNOSTIC,    20, -1.835700965178e+00, 1.592426737897e-06, 1.0667e+01, 3.9491e-01, 
	 2DIAGNOSTIC,    21, -1.835700965178e+00, 1.516738513070e-06, 1.0842e+01, 1.7526e-01, 
	 2DIAGNOSTIC,    22, -1.835700965178e+00, 1.447809640960e-06, 1.1019e+01, 1.7623e-01, 
	 2DIAGNOSTIC,    23, -1.835700965178e+00, 1.384760506519e-06, 1.1203e+01, 1.8442e-01, 
	 2DIAGNOSTIC,    24, -1.835700965178e+00, 1.326867180691e-06, 1.1377e+01, 1.7436e-01, 
	 2DIAGNOSTIC,    25, -1.835700965178e+00, 1.273510290785e-06, 1.1593e+01, 2.1529e-01, 
	 2DIAGNOSTIC,    26, -1.835700965178e+00, 1.224173386556e-06, 1.1770e+01, 1.7739e-01, 
	 2DIAGNOSTIC,    27, -1.835700965178e+00, 1.178459275830e-06, 1.1944e+01, 1.7442e-01, 
	 2DIAGNOSTIC,    28, -1.835700965178e+00, 1.136072224649e-06, 1.2117e+01, 1.7287e-01, 
	 2DIAGNOSTIC,    29, -1.835700965178e+00, 1.096897203623e-06, 1.2331e+01, 2.1326e-01, 
	 2DIAGNOSTIC,    30, -1.835700965178e+00, 1.060333856863e-06, 1.2550e+01, 2.1913e-01, 
	 2DIAGNOSTIC,    31, -1.835700965178e+00, 1.026129442368e-06, 1.2729e+01, 1.7935e-01, 
	DIAGNOSTIC,Iteration,metricValue,convergenceValue,ITERATION_TIME_INDEX,SINCE_LAST
	 2DIAGNOSTIC,     1, -1.823786183832e+00, 1.797693134862e+308, 1.6807e+01, 4.0782e+00, 
	  Elapsed time (stage 1): 1.8352e+01


	Stage 2
	  iterations = 100x100x70x50x0
	  convergence threshold = 1.0000e-06
	  convergence window size = 10
	  number of levels = 5
	  using the Mattes MI metric (number of bins = 32, weight = 1.0000e+00, use gradient filter = 0)
	  preprocessing:  winsorizing the image intensities
	  Shrink factors (level 1 out of 5): [10, 9, 9]
	  Shrink factors (level 2 out of 5): [6, 6, 6]
	  Shrink factors (level 3 out of 5): [4, 4, 4]
	  Shrink factors (level 4 out of 5): [2, 2, 2]
	  Shrink factors (level 5 out of 5): [1, 1, 1]
	  smoothing sigmas per level: [5, 3, 2, 1, 0]
	  Using default NONE metricSamplingStrategy 

	*** Running SyN registration (varianceForUpdateField = 3.0000e+00, varianceForTotalField = 0.0000e+00) ***

	XXDIAGNOSTIC,Iteration,metricValue,convergenceValue,ITERATION_TIME_INDEX,SINCE_LAST
	 1DIAGNOSTIC,     1, -1.945323357870e+00, 1.797693134862e+308, 1.7431e+00, 1.7431e+00, 
	 1DIAGNOSTIC,     2, -1.939687099622e+00, 1.797693134862e+308, 1.8028e+00, 5.9690e-02, 
	 1DIAGNOSTIC,     3, -1.933937937793e+00, 1.797693134862e+308, 1.8618e+00, 5.9031e-02, 
	 1DIAGNOSTIC,     4, -1.935216116011e+00, 1.797693134862e+308, 1.9216e+00, 5.9774e-02, 
	 1DIAGNOSTIC,     5, -1.928785463433e+00, 1.797693134862e+308, 1.9807e+00, 5.9049e-02, 
	 1DIAGNOSTIC,     6, -1.931605565263e+00, 1.797693134862e+308, 2.0396e+00, 5.8915e-02, 
	 1DIAGNOSTIC,     7, -1.928823974825e+00, 1.797693134862e+308, 2.0984e+00, 5.8868e-02, 
	 1DIAGNOSTIC,     8, -1.930167058239e+00, 1.797693134862e+308, 2.1570e+00, 5.8592e-02, 
	 1DIAGNOSTIC,     9, -1.926318262673e+00, 1.797693134862e+308, 2.2159e+00, 5.8897e-02, 
	 1DIAGNOSTIC,    10, -1.928939460506e+00, -4.853913078687e-04, 2.2754e+00, 5.9489e-02, 
	XXDIAGNOSTIC,Iteration,metricValue,convergenceValue,ITERATION_TIME_INDEX,SINCE_LAST
	 1DIAGNOSTIC,     1, -1.855395465506e+00, 1.797693134862e+308, 4.1140e+00, 1.8386e+00, 
	 1DIAGNOSTIC,     2, -1.861704340697e+00, 1.797693134862e+308, 4.3267e+00, 2.1263e-01, 
	 1DIAGNOSTIC,     3, -1.858188242627e+00, 1.797693134862e+308, 4.5399e+00, 2.1324e-01, 
	 1DIAGNOSTIC,     4, -1.858689520956e+00, 1.797693134862e+308, 4.7595e+00, 2.1956e-01, 
	 1DIAGNOSTIC,     5, -1.856389023324e+00, 1.797693134862e+308, 4.9753e+00, 2.1586e-01, 
	 1DIAGNOSTIC,     6, -1.856828130765e+00, 1.797693134862e+308, 5.1921e+00, 2.1676e-01, 
	 1DIAGNOSTIC,     7, -1.853618904733e+00, 1.797693134862e+308, 5.4173e+00, 2.2521e-01, 
	 1DIAGNOSTIC,     8, -1.855567101273e+00, 1.797693134862e+308, 5.6317e+00, 2.1436e-01, 
	 1DIAGNOSTIC,     9, -1.852706375011e+00, 1.797693134862e+308, 5.8617e+00, 2.3009e-01, 
	 1DIAGNOSTIC,    10, -1.854680260755e+00, -1.914042202748e-04, 6.0860e+00, 2.2430e-01, 
	XXDIAGNOSTIC,Iteration,metricValue,convergenceValue,ITERATION_TIME_INDEX,SINCE_LAST
	 1DIAGNOSTIC,     1, -1.840732177431e+00, 1.797693134862e+308, 8.4621e+00, 2.3761e+00, 
	 1DIAGNOSTIC,     2, -1.844388798760e+00, 1.797693134862e+308, 9.1469e+00, 6.8477e-01, 
	 1DIAGNOSTIC,     3, -1.841119095005e+00, 1.797693134862e+308, 9.8596e+00, 7.1272e-01, 
	 1DIAGNOSTIC,     4, -1.842227434944e+00, 1.797693134862e+308, 1.0596e+01, 7.3608e-01, 
	 1DIAGNOSTIC,     5, -1.840585019971e+00, 1.797693134862e+308, 1.1296e+01, 7.0011e-01, 
	 1DIAGNOSTIC,     6, -1.841010248209e+00, 1.797693134862e+308, 1.1985e+01, 6.8929e-01, 
	 1DIAGNOSTIC,     7, -1.839552581628e+00, 1.797693134862e+308, 1.2697e+01, 7.1193e-01, 
	 1DIAGNOSTIC,     8, -1.840093705246e+00, 1.797693134862e+308, 1.3375e+01, 6.7789e-01, 
	 1DIAGNOSTIC,     9, -1.838564805993e+00, 1.797693134862e+308, 1.4125e+01, 7.5033e-01, 
	 1DIAGNOSTIC,    10, -1.839344517941e+00, -1.260990669911e-04, 1.4811e+01, 6.8593e-01, 
	XXDIAGNOSTIC,Iteration,metricValue,convergenceValue,ITERATION_TIME_INDEX,SINCE_LAST
	 1DIAGNOSTIC,     1, -1.807752448167e+00, 1.797693134862e+308, 2.3093e+01, 8.2823e+00, 
	 1DIAGNOSTIC,     2, -1.809433248162e+00, 1.797693134862e+308, 2.9045e+01, 5.9514e+00, 
	 1DIAGNOSTIC,     3, -1.808401028951e+00, 1.797693134862e+308, 3.4941e+01, 5.8958e+00, 
	 1DIAGNOSTIC,     4, -1.808432609385e+00, 1.797693134862e+308, 4.0681e+01, 5.7407e+00, 
	 1DIAGNOSTIC,     5, -1.807418139066e+00, 1.797693134862e+308, 4.6531e+01, 5.8498e+00, 
	 1DIAGNOSTIC,     6, -1.807318460396e+00, 1.797693134862e+308, 5.2337e+01, 5.8058e+00, 
	 1DIAGNOSTIC,     7, -1.806295902728e+00, 1.797693134862e+308, 5.8184e+01, 5.8466e+00, 
	 1DIAGNOSTIC,     8, -1.806604430063e+00, 1.797693134862e+308, 6.3937e+01, 5.7536e+00, 
	 1DIAGNOSTIC,     9, -1.805704095100e+00, 1.797693134862e+308, 6.9724e+01, 5.7872e+00, 
	 1DIAGNOSTIC,    10, -1.805979030187e+00, -1.117134725924e-04, 7.5490e+01, 5.7654e+00, 
	 Registration finished. The antsRegistration call was:
	--------------------------------------------------------------------------------------
	/opt/ants-2.4.3/bin/antsRegistration --verbose 1 --dimensionality 3 --float 0 --collapse-output-transforms 1 --output [ sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_T1w_,sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_T1w_Warped.nii.gz,sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_T1w_InverseWarped.nii.gz ] --interpolation Linear --use-histogram-matching 0 --winsorize-image-intensities [ 0.005,0.995 ] --initial-moving-transform [ /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,/home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,1 ] --transform Rigid[ 0.1 ] --metric MI[ /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,/home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,1,32,Regular,0.25 ] --convergence [ 1000x500x250x0,1e-6,10 ] --shrink-factors 12x8x4x2 --smoothing-sigmas 4x3x2x1vox --transform Affine[ 0.1 ] --metric MI[ /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,/home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,1,32,Regular,0.25 ] --convergence [ 1000x500x250x0,1e-6,10 ] --shrink-factors 12x8x4x2 --smoothing-sigmas 4x3x2x1vox --transform SyN[ 0.1,3,0 ] --metric MI[ /home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,/home/jovyan/workspace/books/examples/quantitative_imaging/bids/sub-1/ses-20170705/anat/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_part-mag_T1w.nii,1,32] --convergence [ 100x100x70x50x0,1e-6,10 ] --shrink-factors 10x6x4x2x1 --smoothing-sigmas 5x3x2x1x0vox
	--------------------------------------------------------------------------------------
	Moving image resampled into fixed space: sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_T1w_Warped.nii.gz
	Fixed image resampled into moving space: sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_T1w_InverseWarped.nii.gz
	--------------------------------------------------------------------------------------
Stderr:
	/opt/ants-2.4.3/bin/antsRegistrationSyNQuick.sh: line 679:  3728 Killed                  $COMMAND
Traceback:
	Traceback (most recent call last):
	  File &quot;/opt/miniconda-4.12.0/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 453, in aggregate_outputs
	    setattr(outputs, key, val)
	  File &quot;/opt/miniconda-4.12.0/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 330, in validate
	    value = super(File, self).validate(objekt, name, value, return_pathlike=True)
	  File &quot;/opt/miniconda-4.12.0/lib/python3.8/site-packages/nipype/interfaces/base/traits_extension.py&quot;, line 135, in validate
	    self.error(objekt, name, str(value))
	  File &quot;/opt/miniconda-4.12.0/lib/python3.8/site-packages/traits/base_trait_handler.py&quot;, line 74, in error
	    raise TraitError(
	traits.trait_errors.TraitError: The &#39;inverse_warp_field&#39; trait of a RegistrationSynQuickOutputSpec instance must be a pathlike object or string representing an existing file, but a value of &#39;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-1/ses-20170705/qsm_acq-acqmp2ragehighres0p5isoslab_T1w/ants_register-t1-to-qsm/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_T1w_1InverseWarp.nii.gz&#39; &lt;class &#39;str&#39;&gt; was specified.

	During handling of the above exception, another exception occurred:

	Traceback (most recent call last):
	  File &quot;/opt/miniconda-4.12.0/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 400, in run
	    outputs = self.aggregate_outputs(runtime)
	  File &quot;/opt/miniconda-4.12.0/lib/python3.8/site-packages/nipype/interfaces/base/core.py&quot;, line 460, in aggregate_outputs
	    raise FileNotFoundError(msg)
	FileNotFoundError: No such file or directory &#39;/home/jovyan/workspace/books/examples/quantitative_imaging/bids/derivatives/workflow/qsmxt-workflow/sub-1/ses-20170705/qsm_acq-acqmp2ragehighres0p5isoslab_T1w/ants_register-t1-to-qsm/sub-1_ses-20170705_acq-acqmp2ragehighres0p5isoslab_T1w_1InverseWarp.nii.gz&#39; for output &#39;inverse_warp_field&#39; of a RegistrationSynQuick interface



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File &quot;/opt/miniconda-4.12.0/bin/qsmxt&quot;, line 8, in &lt;module&gt;
    sys.exit(main())
  File &quot;/opt/miniconda-4.12.0/lib/python3.8/site-packages/qsmxt/cli/main.py&quot;, line 1879, in main
    wf.run(
  File &quot;/opt/miniconda-4.12.0/lib/python3.8/site-packages/nipype/pipeline/engine/workflows.py&quot;, line 638, in run
    runner.run(execgraph, updatehash=updatehash, config=self.config)
  File &quot;/opt/miniconda-4.12.0/lib/python3.8/site-packages/nipype/pipeline/plugins/base.py&quot;, line 224, in run
    raise error from cause
RuntimeError: 2 raised. Re-raising first.
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="view-results">
<h1>View results<a class="headerlink" href="#view-results" title="Link to this heading">#</a></h1>
<p>Let’s have a look at the generated <code class="docutils literal notranslate"><span class="pre">qsm</span></code> folder:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>tree<span class="w"> </span>bids/derivatives/qsmxt-*-*<span class="w"> </span>--dirsfirst
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold -Color-Bold-Blue">bids/derivatives/qsmxt-2026-02-22-025224</span>
├── <span class=" -Color -Color-Bold -Color-Bold-Blue">sub-1</span>
│   └── <span class=" -Color -Color-Bold -Color-Bold-Blue">ses-20170705</span>
│       ├── <span class=" -Color -Color-Bold -Color-Bold-Blue">anat</span>
│       │   ├── sub-1_ses-20170705_acq-acqqsmp21mmisote20_T2starw_Chimap.json
│       │   ├── sub-1_ses-20170705_acq-acqqsmp21mmisote20_T2starw_Chimap.nii
│       │   ├── sub-1_ses-20170705_acq-acqqsmp21mmisote20_T2starw_space-orig_dseg.nii
│       │   └── sub-1_ses-20170705_acq-acqqsmp21mmisote20_T2starw_space-qsm_dseg.nii
│       └── <span class=" -Color -Color-Bold -Color-Bold-Blue">extra_data</span>
│           ├── sub-1_ses-20170705_acq-acqqsmp21mmisote20_T2starw_desc-t1w-to-qsm_transform.mat
│           └── sub-1_ses-20170705_acq-acqqsmp21mmisote20_T2starw_qsm-analysis.csv
├── <span class=" -Color -Color-Bold -Color-Bold-Blue">sub-2</span>
│   └── <span class=" -Color -Color-Bold -Color-Bold-Blue">ses-20170705</span>
│       ├── <span class=" -Color -Color-Bold -Color-Bold-Blue">anat</span>
│       │   ├── sub-2_ses-20170705_acq-acqqsmp21mmisote20_T2starw_Chimap.json
│       │   ├── sub-2_ses-20170705_acq-acqqsmp21mmisote20_T2starw_Chimap.nii
│       │   ├── sub-2_ses-20170705_acq-acqqsmp21mmisote20_T2starw_space-orig_dseg.nii
│       │   └── sub-2_ses-20170705_acq-acqqsmp21mmisote20_T2starw_space-qsm_dseg.nii
│       └── <span class=" -Color -Color-Bold -Color-Bold-Blue">extra_data</span>
│           ├── sub-2_ses-20170705_acq-acqqsmp21mmisote20_T2starw_desc-t1w-to-qsm_transform.mat
│           └── sub-2_ses-20170705_acq-acqqsmp21mmisote20_T2starw_qsm-analysis.csv
├── command.txt
├── pypeline.log
├── qsmxt.log
├── references.txt
└── settings.json

9 directories, 17 files
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">references.txt</span></code> file contains a list of all the algorithms used and relevant citations:</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>cat<span class="w"> </span>bids/derivatives/qsmxt-*-*/references.txt
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>== References ==

 - QSMxT: Stewart AW, Robinson SD, O&#39;Brien K, et al. QSMxT: Robust masking and artifact reduction for quantitative susceptibility mapping. Magnetic Resonance in Medicine. 2022;87(3):1289-1300. doi:10.1002/mrm.29048

 - QSMxT: Stewart AW, Bollman S, et al. QSMxT/QSMxT. GitHub; 2022. https://github.com/QSMxT/QSMxT

 - Python package - Nipype: Gorgolewski K, Burns C, Madison C, et al. Nipype: A Flexible, Lightweight and Extensible Neuroimaging Data Processing Framework in Python. Frontiers in Neuroinformatics. 2011;5. Accessed April 20, 2022. doi:10.3389/fninf.2011.00013

 - Brain extraction: Smith SM. Fast robust automated brain extraction. Human Brain Mapping. 2002;17(3):143-155. doi:10.1002/hbm.10062

 - Brain extraction: Liangfu Chen. liangfu/bet2 - Standalone Brain Extraction Tool. GitHub; 2015. https://github.com/liangfu/bet2

 - Unwrapping algorithm - ROMEO: Dymerska B, Eckstein K, Bachrata B, et al. Phase unwrapping with a rapid opensource minimum spanning tree algorithm (ROMEO). Magnetic Resonance in Medicine. 2021;85(4):2294-2308. doi:10.1002/mrm.28563

 - Background field removal - V-SHARP: Wu B, Li W, Guidon A et al. Whole brain susceptibility mapping using compressed sensing. Magnetic resonance in medicine. 2012 Jan;67(1):137-47. doi:10.1002/mrm.23000

 - QSM algorithm - RTS: Kames C, Wiggermann V, Rauscher A. Rapid two-step dipole inversion for susceptibility mapping with sparsity priors. Neuroimage. 2018 Feb 15;167:276-83. doi:10.1016/j.neuroimage.2017.11.018

 - Julia package - QSM.jl: kamesy. GitHub; 2022. https://github.com/kamesy/QSM.jl

 - Julia package - MriResearchTools: Eckstein K. korbinian90/MriResearchTools.jl. GitHub; 2022. https://github.com/korbinian90/MriResearchTools.jl

 - Python package - nibabel: Brett M, Markiewicz CJ, Hanke M, et al. nipy/nibabel. GitHub; 2019. https://github.com/nipy/nibabel

 - Python package - scipy: Virtanen P, Gommers R, Oliphant TE, et al. SciPy 1.0: fundamental algorithms for scientific computing in Python. Nat Methods. 2020;17(3):261-272. doi:10.1038/s41592-019-0686-2

 - Python package - numpy: Harris CR, Millman KJ, van der Walt SJ, et al. Array programming with NumPy. Nature. 2020;585(7825):357-362. doi:10.1038/s41586-020-2649-2

 - FastSurfer: Henschel L, Conjeti S, Estrada S, Diers K, Fischl B, Reuter M. FastSurfer - A fast and accurate deep learning based neuroimaging pipeline. NeuroImage. 2020;219:117012. doi:10.1016/j.neuroimage.2020.117012

 - ANTs: Avants BB, Tustison NJ, Johnson HJ. Advanced Normalization Tools. GitHub; 2022. https://github.com/ANTsX/ANTs
</pre></div>
</div>
</div>
</div>
<section id="qsm-results">
<h2>QSM results<a class="headerlink" href="#qsm-results" title="Link to this heading">#</a></h2>
<p>Let’s view one of the QSM results:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show_nii</span><span class="p">(</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;bids/derivatives/qsmxt-*/sub-*/ses-*/anat/*Chimap.nii*&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Chimap&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/e8248e60a013463d41403d0bf5224e3cff8cb7147186407371516ea4c37b2cf4.png" src="../../_images/e8248e60a013463d41403d0bf5224e3cff8cb7147186407371516ea4c37b2cf4.png" />
</div>
</div>
</section>
<section id="segmentations">
<h2>Segmentations<a class="headerlink" href="#segmentations" title="Link to this heading">#</a></h2>
<p>Segmentations are generated in both the QSM space and the T1-weighted space. Transformations are also made available.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show_nii</span><span class="p">(</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;bids/derivatives/qsmxt-*/sub-*/ses-*/anat/*qsm_dseg.nii*&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Segmentation&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Set3&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">96</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/eaeeb6f91ae0d58ed87e39465a13eac8a10af9d634103fa6eb7cd9721da2a850.png" src="../../_images/eaeeb6f91ae0d58ed87e39465a13eac8a10af9d634103fa6eb7cd9721da2a850.png" />
</div>
</div>
</section>
<section id="analysis-csvs">
<h2>Analysis CSVs<a class="headerlink" href="#analysis-csvs" title="Link to this heading">#</a></h2>
<p>CSV files have been exported containing susceptibility values in regions of interest for each subject.</p>
<p>Here we will load the CSVs, inspect the data and generate figures:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import modules</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
</pre></div>
</div>
</div>
</div>
<p>The raw CSV files use names from FreeSurfer as exported by FastSurfer. The full list of regions is available <a class="reference external" href="https://github.com/QSMxT/QSMxT/blob/main/qsmxt/aseg_labels.csv">here</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;bids/derivatives/qsmxt-*-*/sub*/ses*/extra*/*.csv&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>roi</th>
      <th>num_voxels</th>
      <th>min</th>
      <th>max</th>
      <th>median</th>
      <th>mean</th>
      <th>std</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3rd-Ventricle</td>
      <td>588</td>
      <td>-0.236484</td>
      <td>0.125541</td>
      <td>-0.019423</td>
      <td>-0.022747</td>
      <td>0.034554</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4th-Ventricle</td>
      <td>1562</td>
      <td>-0.128288</td>
      <td>0.032236</td>
      <td>-0.047126</td>
      <td>-0.048463</td>
      <td>0.028498</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Brain-Stem</td>
      <td>18447</td>
      <td>-0.281358</td>
      <td>0.102415</td>
      <td>-0.044959</td>
      <td>-0.040980</td>
      <td>0.028647</td>
    </tr>
    <tr>
      <th>3</th>
      <td>CSF</td>
      <td>775</td>
      <td>-1.398799</td>
      <td>0.946090</td>
      <td>0.024541</td>
      <td>0.026303</td>
      <td>0.146650</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Left-Accumbens-area</td>
      <td>521</td>
      <td>-0.143215</td>
      <td>0.129016</td>
      <td>0.026715</td>
      <td>0.022720</td>
      <td>0.031515</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>91</th>
      <td>ctx-rh-superiorfrontal</td>
      <td>29492</td>
      <td>-0.103442</td>
      <td>0.160703</td>
      <td>-0.003969</td>
      <td>-0.009205</td>
      <td>0.023724</td>
    </tr>
    <tr>
      <th>92</th>
      <td>ctx-rh-superiorparietal</td>
      <td>12086</td>
      <td>-0.083912</td>
      <td>0.237601</td>
      <td>-0.015443</td>
      <td>-0.014624</td>
      <td>0.020986</td>
    </tr>
    <tr>
      <th>93</th>
      <td>ctx-rh-superiortemporal</td>
      <td>16477</td>
      <td>-0.091664</td>
      <td>0.249151</td>
      <td>0.004913</td>
      <td>0.012366</td>
      <td>0.023670</td>
    </tr>
    <tr>
      <th>94</th>
      <td>ctx-rh-supramarginal</td>
      <td>12130</td>
      <td>-0.056818</td>
      <td>0.240087</td>
      <td>0.018917</td>
      <td>0.020044</td>
      <td>0.022647</td>
    </tr>
    <tr>
      <th>95</th>
      <td>ctx-rh-transversetemporal</td>
      <td>1231</td>
      <td>-0.005336</td>
      <td>0.172116</td>
      <td>0.034706</td>
      <td>0.035601</td>
      <td>0.016122</td>
    </tr>
  </tbody>
</table>
<p>96 rows × 7 columns</p>
</div></div></div>
</div>
<p>We will select a subset of these ROIs and give them more readable names:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># define regions of interest</span>
<span class="c1"># see https://github.com/QSMxT/QSMxT/blob/main/qsmxt/aseg_labels.csv for a full list</span>
<span class="n">rois</span> <span class="o">=</span> <span class="p">{</span> 
    <span class="s2">&quot;Thalamus&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">49</span><span class="p">],</span>
    <span class="s2">&quot;Pallidum&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">53</span><span class="p">],</span>
    <span class="s2">&quot;Caudate&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
    <span class="s2">&quot;Putamen&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">51</span><span class="p">],</span>
    <span class="s2">&quot;Brain stem&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">16</span><span class="p">],</span>
    <span class="s2">&quot;CSF&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">24</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">257</span><span class="p">,</span> <span class="mi">701</span><span class="p">],</span>
    <span class="s2">&quot;White matter&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">177</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">roi_names</span> <span class="o">=</span> <span class="p">{</span> <span class="n">value</span><span class="p">:</span> <span class="n">key</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">rois</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">rois</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="p">}</span>
<span class="n">roi_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">value</span> <span class="k">for</span> <span class="n">roi</span> <span class="ow">in</span> <span class="n">rois</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">roi</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load a reconstruction</span>
<span class="n">qsm_img</span> <span class="o">=</span> <span class="n">nib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;bids/derivatives/qsmxt-*-*/sub*/ses*/anat*/*Chimap.nii*&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">seg_img</span> <span class="o">=</span> <span class="n">nib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;bids/derivatives/qsmxt-*-*/sub*/ses*/anat*/*space-qsm*dseg.nii*&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">nilearn.image</span><span class="w"> </span><span class="kn">import</span> <span class="n">resample_to_img</span>
<span class="c1"># Resample the segmentation image to match the QSM image space</span>
<span class="c1"># Use &#39;nearest&#39; interpolation to preserve the integer labels of the segmentation.</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Resampling segmentation to match QSM dimensions...&quot;</span><span class="p">)</span>
<span class="n">seg_resampled_img</span> <span class="o">=</span> <span class="n">resample_to_img</span><span class="p">(</span><span class="n">seg_img</span><span class="p">,</span> <span class="n">qsm_img</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Resampling complete.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resampling segmentation to match QSM dimensions...
Resampling complete.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get data arrays</span>
<span class="n">qsm</span> <span class="o">=</span> <span class="n">qsm_img</span><span class="o">.</span><span class="n">get_fdata</span><span class="p">()</span>
<span class="n">seg</span> <span class="o">=</span> <span class="n">seg_resampled_img</span><span class="o">.</span><span class="n">get_fdata</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check shapes to confirm they match</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shape of QSM data: </span><span class="si">{</span><span class="n">qsm</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shape of resampled segmentation data: </span><span class="si">{</span><span class="n">seg</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">qsm</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">seg</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;FATAL: Shapes not match after resampling. Check your input files.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Shape of QSM data: (224, 224, 160)
Shape of resampled segmentation data: (224, 224, 160)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># --- Flatten the arrays now that they have the same dimensions ---</span>
<span class="n">qsm</span> <span class="o">=</span> <span class="n">qsm</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">seg</span> <span class="o">=</span> <span class="n">seg</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># retain only the rois</span>
<span class="n">qsm</span> <span class="o">=</span> <span class="n">qsm</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">roi_ids</span><span class="p">)]</span>
<span class="n">seg</span> <span class="o">=</span> <span class="n">seg</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">roi_ids</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># convert to a dataframe for plotting purposes</span>
<span class="n">seg</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">seg</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">roi_names</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span> <span class="s1">&#39;qsm&#39;</span> <span class="p">:</span> <span class="n">qsm</span><span class="p">,</span> <span class="s1">&#39;seg&#39;</span> <span class="p">:</span> <span class="n">seg</span> <span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># summarise data by region including the average and standard deviation</span>
<span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;seg&#39;</span><span class="p">)[</span><span class="s1">&#39;qsm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">decimals</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>std</th>
    </tr>
    <tr>
      <th>seg</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Brain stem</th>
      <td>-0.041</td>
      <td>0.029</td>
    </tr>
    <tr>
      <th>White matter</th>
      <td>-0.002</td>
      <td>0.028</td>
    </tr>
    <tr>
      <th>CSF</th>
      <td>0.026</td>
      <td>0.147</td>
    </tr>
    <tr>
      <th>Thalamus</th>
      <td>0.030</td>
      <td>0.034</td>
    </tr>
    <tr>
      <th>Pallidum</th>
      <td>0.033</td>
      <td>0.060</td>
    </tr>
    <tr>
      <th>Putamen</th>
      <td>0.046</td>
      <td>0.033</td>
    </tr>
    <tr>
      <th>Caudate</th>
      <td>0.048</td>
      <td>0.024</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">medians</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;seg&#39;</span><span class="p">)[</span><span class="s1">&#39;qsm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
<span class="n">order</span> <span class="o">=</span> <span class="n">medians</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;qsm&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;seg&#39;</span><span class="p">,</span> <span class="n">fliersize</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightblue&#39;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xticks</span><span class="p">())))</span>  <span class="c1"># Set tick positions explicitly</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;pink&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Region of interest&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Susceptibility (ppm)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;QSM&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/4edea6bfefc03bab5538780509d207ed3f78202758266f08ef9f225d2066b154.png" src="../../_images/4edea6bfefc03bab5538780509d207ed3f78202758266f08ef9f225d2066b154.png" />
</div>
</div>
<section id="dependencies-in-jupyter-python">
<h3>Dependencies in Jupyter/Python<a class="headerlink" href="#dependencies-in-jupyter-python" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Using the package <a class="reference external" href="https://github.com/rasbt/watermark">watermark</a> to document system environment and software versions used in this notebook</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> watermark

<span class="o">%</span><span class="k">watermark</span>
<span class="o">%</span><span class="k">watermark</span> --iversions
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Last updated: 2026-02-22T03:38:59.314807+00:00

Python implementation: CPython
Python version       : 3.13.11
IPython version      : 9.9.0

Compiler    : GCC 14.3.0
OS          : Linux
Release     : 6.8.0-1044-azure
Machine     : x86_64
Processor   : x86_64
CPU cores   : 4
Architecture: 64bit

matplotlib: 3.10.8
nibabel   : 5.3.3
nilearn   : 0.13.1
numpy     : 2.4.2
pandas    : 2.3.3
seaborn   : 0.13.2
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./examples/quantitative_imaging"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="aslprep.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">ASLprep</p>
      </div>
    </a>
    <a class="right-next"
       href="../spectroscopy/intro.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Spectroscopy</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">QSMxT</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1"></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#citation-and-resources">Citation and Resources:</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tools-included-in-this-workflow">Tools included in this workflow</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset">Dataset</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#qsmxt-interactive-notebook">QSMxT Interactive Notebook</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-qsm">What is QSM?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-qsmxt">What is QSMxT?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-do-i-access-qsmxt">How do I access QSMxT?</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#download-example-dicoms">Download example DICOMs</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#load-qsmxt">Load QSMxT</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-standardisation">Data standardisation</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#convert-dicom-to-bids">Convert DICOM to BIDS</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-input-data">Inspect input data</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interactive-display-using-niivue">Interactive Display using Niivue</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#run-qsmxt">Run QSMxT</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#view-results">View results</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#qsm-results">QSM results</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#segmentations">Segmentations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-csvs">Analysis CSVs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dependencies-in-jupyter-python">Dependencies in Jupyter/Python</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Neurodesk Team
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>